---
title: "Statistics for Bioengineering - Week 1"
author: "Bill Cresko"
format: 
  revealjs:
    footer: BioE_Stats_2026 - Knight Campus 
    transition: fade
    transition-speed: slow
    theme: default
    chalkboard: true
    slide-number: true
    code-fold: false
    code-overflow: wrap
    highlight-style: github
execute:
  echo: true
  warning: false
  message: false
editor: visual
---

```{r}
#| label: setup
#| include: false

# Core data manipulation and visualization
library(tidyverse)
library(knitr)
library(readxl)

# Statistical analysis packages
library(MASS)        # LDA, robust regression
library(pwr)         # Power analysis
library(boot)        # Bootstrap methods
library(car)         # Companion to Applied Regression
library(survival)    # Survival analysis
library(nlme)        # Mixed effects models
library(broom)       # Tidy model output
library(emmeans)     # Estimated marginal means

# Set consistent theme for all plots
theme_set(theme_minimal(base_size = 14))

# Set seed for reproducibility
set.seed(2026)
```

# Week 1: Foundational Data Science Tools {background-color="#2c3e50"}

## Week 1 Topics

::: incremental
-   Unix & shell commands
-   R scripts & reproducible analysis
-   Use of GenAI
-   Tidy data and data wrangling
-   Markdown
:::

::: callout-note
**Readings:** Chapters 1-8, Appendix A1
:::

## Packages for This Week {.smaller}

```{r}
#| label: week1-packages-install
#| eval: false
#| echo: true

# Install packages (run once)
install.packages(c("tidyverse", "knitr", "readxl"))

# Load packages
library(tidyverse)    # Data manipulation & visualization (includes ggplot2, dplyr, tidyr)
library(knitr)        # Document generation
library(readxl)       # Read Excel files
```

::: callout-tip
The **tidyverse** is a collection of packages including: ggplot2, dplyr, tidyr, readr, purrr, tibble, stringr, and forcats.
:::

## Statistics for Bioengineers and Bioscientists

![](images/week01_01_cover_1.gif){width="400"}

Welcome to the course! This term we will build your skills in statistical thinking, programming in R and Unix, reproducible research practices, and data visualization.

## Goals of the Course

::: callout-tip
## This is a practical course and we will learn by doing

-   Teach fundamental skills for your scientific careers
-   Provide broad coverage of modern statistics
-   Provide computational tools necessary for your work
-   Prepare you for more advanced statistics and programming
:::

## What Will You Learn? {.smaller}

::: incremental
-   Read and write code in Unix and R
-   Implement reproducible research practices
-   Exploratory data analysis and visualization
-   Probability, distributions, and sampling
-   Experimental design and hypothesis testing
-   Statistical analyses (t-tests, contingency tests)
-   Linear and non-linear modeling
-   Classical machine learning
-   Ordination (PCA, tSNE, UMAP)
:::

## 

![](images/week01_02_nakashima_chair_craftsmanship.jpeg){fig-align="center" width="80%"}

## 

![](images/week01_03_woodworking_tool_cabinet.jpeg){fig-align="center" width="100%"}

## 

![](images/week01_04_learning_craftsmanship.jpeg){fig-align="center" width="100%"}

## 

![](images/week01_05_historical_craftsmanship.jpeg){fig-align="center" width="100%"}

## Class Logistics {.smaller}

**Schedule:** Tuesdays and Thursdays, 4:00pm - 5:50pm in KC107

Most of class time will be hands-on coding practice.

**Assignments:**

-   Weeks 2-9: Coding and statistics homework
-   Week 11: Final coding project designing scripts for your research

## Required Materials {.smaller}

-   Access to a laptop running Windows, MacOS, or Linux
-   Announcements and assignments posted on Canvas
-   Course material: <https://wcresko.github.io/BioE_Stats_Wi2026/>
-   Reading material: <https://wcresko.github.io/BioE_Stats_Book/>

::: callout-note
## No textbooks or purchases required!
:::

## Class Introductions

::: callout-tip
## Who are you?

-   Your name and year in grad school
-   Home lab or rotation lab
-   What is your good news this week?
-   What has your experience with programming/statistics been like?
:::

# Why Statistics & Coding? {background-color="#2c3e50"}

## Why Do We Need Statistics? {.smaller}

**The Problem:** We almost never know the world perfectly, but still need to draw conclusions or make decisions. We estimate parameters from samples and test hypotheses using data.

**The Solution:** Well-known mathematical rules help us do this. Computers let us apply them quickly and visualize large amounts of data.

**What statistics enables:**

-   Point estimates and confidence intervals
-   Experimental design and hypothesis testing
-   Data reduction of highly dimensional data

::: callout-important
## Foundation Required

We need a firm understanding of probability, sampling, and distributions.
:::

## Why Do We Need Coding? {.smaller}

::: incremental
-   Incredibly fast and powerful for repeated actions
-   Handles large datasets that Excel and GUIs can't manage
-   Access to thousands of free programs made for and by scientists
-   Commands work identically across platforms and on clusters like Talapas
:::

:::: fragment
::: callout-tip
## The Most Important Reason

**REPRODUCIBILITY** — You can keep your scripts to see exactly what was done
:::
::::

## Coding vs. Scripting {.smaller}

| Type | Description | Examples | Speed | Flexibility |
|:---|:---|:---|:---|:---|
| **Coding** | Uses compilers to translate code | C++, Fortran | Faster | Less flexible |
| **Scripting** | Interpreted on the fly | Python, R, Julia | Slower | More flexible |

::: callout-note
The distinction has become fuzzy—most modern pipelines combine both approaches.
:::

## Programming Languages {.smaller}

Programming languages are called *languages* for a reason:

-   Learning to program is like learning a new spoken language
-   Learning one helps you learn another
-   **Use it or lose it!** Practice is the best way to maintain skills

::: callout-tip
## Remember

Computers are literal! You must use explicit, pre-defined phrases to tell your computer exactly what you want.
:::

# Installing Programs {background-color="#2c3e50"}

## Platform Considerations

::: callout-note
-   Mac and Linux use the same shell language
-   Windows requires additional setup (WSL2)
-   R and RStudio work on any platform
:::

## Installing R and RStudio {.smaller}

**R Installation:**

-   Download from: <https://www.r-project.org>
-   Can run from command line or on clusters

**RStudio Installation:**

-   Download from: <http://www.rstudio.com>
-   Use the Desktop Open Source (Free) version
-   Provides helpful features like code completion and debugging

## RStudio

![RStudio interface screenshot](images/week01_37_rstudio_screenshot.jpg){fig-align="center" width="75%"}

## Accessing the Shell {.smaller}

-   **Mac users**: Open the "Terminal" app or use 'iTerm2'
-   **Linux users**: Open one of several "Terminal" apps

::: callout-caution
## Windows users have additional setup

See the next slides for WSL2 installation
:::

## Accessing the Shell — Windows {.smaller}

**Installation Steps:**

1.  Guide: <https://ubuntu.com/tutorials/install-ubuntu-on-wsl2-on-windows-10>
2.  Run Windows PowerShell as administrator
3.  Install WSL2 by typing `wsl --install`
4.  Restart your computer
5.  Search for and install Ubuntu from Microsoft Store

**Alternative:** Type `wsl --install -d ubuntu` on PowerShell to do steps 3-5 at once

## Accessing the Shell — Windows {.smaller}

-   Open `Ubuntu` and set up a username and password (doesn't need to match Windows login)
-   Note that this is the `Ubuntu` Linux operating system that you installed, not the Windows Powershell
-   Now you can use the `Terminal` application in Ubuntu
-   Run `sudo apt update` then `sudo apt upgrade` to ensure everything is current
-   Create folders and files within your Ubuntu folder
-   In addition, you can access your Windows files and folders using `cd /mnt/c`

# The Unix Shell {background-color="#2c3e50"}

![](images/week01_15_w1_code.jpeg){fig-align="center" width="90%"}

## What is Unix? {.smaller}

-   A scripting language developed in 1969, released in 1973
-   Serves as the base language for many programs and computers
-   Linux is an open-source version of the same language
-   Runs Apple OSX Macs, Linux Workstations, Google Android, Virtual Machines....

## What is a Shell? {.smaller background-image="images/week01_16_w1_shell.jpeg" background-opacity="0.3"}

-   The 'shell' is a program that takes commands and gives them to the operating system
-   The most common is `Bash`, but also `Tsh` and `Zsh`
-   `Bash` acts as the shell in Macs and Linux
-   You access the `bash` shell via a terminal window

## The Mac Terminal {.smaller}

::: {layout-ncol="2"}
![](images/week01_32_macterminal_1.jpg){width="90%"}

![](images/week01_33_macterminal_2.jpg){width="90%"}
:::

## Terminal Within RStudio {.smaller}

![](images/week01_34_terminal_window_showing_direct.jpg){fig-align="center" width="80%"}

## Shell Command Structure {.smaller}

![](images/week01_18_w1_shell_command.jpeg){fig-align="center" width="60%"}

| Component    | Description                                     |
|:-------------|:------------------------------------------------|
| **Prompt**   | Indicates computer is ready to accept a command |
| **Command**  | Tells computer to do a specific task            |
| **Options**  | Change the behavior of a command                |
| **Argument** | What the command should operate on              |

# Navigation Commands {background-color="#2c3e50"}

## The way you normally navigate

![](images/week01_21_w1_finder.jpeg){fig-align="center" width="90%"}

## 

![](images/week01_22_w1_navigate.jpeg){fig-align="center" width="90%"}

## How is a Computer Organized? {.smaller}

-   System of directories (folders) and files
-   `/` = the root directory, which holds all other directories
-   `~` is shorthand for your home folder
-   The "path" refers to file location (e.g., `/Users/wcresko/Documents`)

![](images/week01_23_w1_file_structure.jpeg){fig-align="center" width="100%"}

## 

![](images/week01_24_unix_file_hierarchy.jpeg){fig-align="center" width="90%"}

## 

![](images/week01_25_unix_paths_highlighted.jpeg){fig-align="center" width="90%"}

## 

![](images/week01_26_unix_dot_files.jpeg){fig-align="center" width="90%"}

## 

![](images/week01_27_unix_dot_current_dir.jpeg){fig-align="center" width="90%"}

## 

![](images/week01_28_unix_dotdot_parent.jpeg){fig-align="center" width="90%"}

## 

![](images/week01_29_unix_dotdot_navigation.jpeg){fig-align="center" width="90%"}

## Relative and Absolute Paths {.smaller}

![](images/week01_12_statistical_concepts_preview.jpeg){fig-align="center" width="90%"}

## Relative and Absolute Paths {.smaller}

![](images/week01_13_data_analysis_workflow.jpeg){fig-align="center" width="90%"}

## Relative and Absolute Paths {.smaller}

![](images/week01_14_course_roadmap.jpeg){fig-align="center" width="90%"}

# Navigating the file system and working with files using Shell Commands

## Navigating the File System {.smaller}

![](images/week01_36_finding_your_way_around.jpeg){fig-align="center" width="70%"}

## Common Navigation Commands {.smaller}

| Command | Description | Common Options |
|:---|:---|:---|
| `pwd` | Print working directory | (In Windows, `cd` prints working directory) |
| `ls` | List directories and files | `-F`, `-l`, `-r`, `-S`, `-t` |
| `cd` | Change directory | `..` (up one level), `-` (previous) |

## Common File Commands {.smaller}

| Command         | Function                       |
|:----------------|:-------------------------------|
| `mkdir`         | Make new folders               |
| `nano`, `touch` | Make new files                 |
| `mv`            | Rename or move files           |
| `cp`            | Copy files                     |
| `rm`            | Delete files                   |
| `wc`            | Word count / file length       |
| `cat`           | Reading/concatenating files    |
| `head`, `tail`  | View beginning or end of files |

## Naming Conventions {.smaller}

-   Avoid spaces in file names
-   Don't start with a `–`
-   Stick to letters, numbers, `.`, `-`, and `_`
-   Use appropriate file extensions (.fasta, .txt, etc.)

::: callout-warning
## The shell trusts you

It will delete files you say to delete and override files with duplicate names!
:::

## Getting Help {.smaller}

**Manual pages:**

-   Type `man [command_name]` to access the manual
-   Type `q` to exit

**Also...the internet!**

-   Stack Overflow, GitHub discussions, official documentation

## Exercise {.smaller}

::: callout-tip
## Exercise

1.  Make a new directory and add a file named `practice.txt` with some text
2.  Read the contents and get its length
3.  Rename the file to `super_practice.txt`
4.  Move it to a new folder named `sandbox`
5.  Make a copy named `super_practice_copy.txt`
6.  Verify the contents match, then delete the original
:::

# R and RStudio {background-color="#2c3e50"}

## Why use R? {.smaller}

![](images/week01_40_week2_rpirate.jpeg){fig-align="center" width="60%"}

-   Powerful, flexible, and free
-   Runs on all platforms
-   Superb data management & graphics capabilities
-   Thousands of community-contributed packages
-   Embed analyses in dynamic documents using Quarto
-   Lots of online help available

## R Resources {.smaller}

| Resource           | URL                                            |
|:-------------------|:-----------------------------------------------|
| The R Project      | <http://www.r-project.org>                     |
| RStudio            | <http://www.rstudio.com>                       |
| R for Data Science | <https://r4ds.had.co.nz>                       |
| Quick R            | <http://www.statmethods.net>                   |
| Bioconductor       | <http://www.bioconductor.org>                  |
| Stack Overflow     | <https://stackoverflow.com/questions/tagged/r> |

::: callout-tip
When you get an error, paste it into Google—someone else has had the same problem!
:::

## RStudio Interface

![](images/week01_37_rstudio_screenshot.jpg){fig-align="center" width="90%"}

::: callout-tip
`R` is the programming language, `RStudio` is the Integrated Developer Environment (IDE) to let you write scripts in `R` (and other languages like `Python` and `C++`)
:::

##  {.smaller}

![](images/week01_38_rstudio.png){fig-align="center" width="80%"}

| Pane                 | Location     | Purpose                              |
|:---------------------|:-------------|:-------------------------------------|
| **Code Editor**      | Top-left     | Write/edit scripts, view data        |
| **Console**          | Bottom-left  | Interactive R session                |
| **Environment**      | Top-right    | View objects, command history        |
| **Files/Plots/Help** | Bottom-right | Navigate files, view plots, get help |

::: callout-tip
Customize layout in Tools → Global Options → Pane Layout
:::

## Installing and Loading Packages {.smaller}

R's power comes from community-contributed packages:

-   **Install once** (downloads package)
-   **Load each session** (makes functions available)

```{r}
#| label: week1-tidyverse-install
#| eval: false
#| echo: true

install.packages("tidyverse")
library(tidyverse)
```

::: callout-note
Also install via RStudio: Tools → Install Packages
:::

## The Tidyverse Ecosystem {.smaller}

| Package   | Purpose                                               |
|:----------|:------------------------------------------------------|
| `dplyr`   | Data manipulation (filter, select, mutate, summarize) |
| `ggplot2` | Data visualization                                    |
| `tidyr`   | Reshaping data (pivot, separate, unite)               |
| `readr`   | Fast reading of CSV, TSV files                        |
| `stringr` | String manipulation                                   |
| `purrr`   | Functional programming tools                          |

Loading `tidyverse` loads all of these at once!

# R Basics {background-color="#2c3e50"}

## R Script Basics

-   A series of R commands that will be executed
-   Add comments using hashtags `#`
-   Use pipes to connect steps

::: callout-tip
## Best Practice

Always comment your code! Future you will thank present you.
:::

## Basic Math in R {.smaller}

-   Commands submitted through terminal, console, or scripts
-   Anything following `#` is a comment
-   R follows standard mathematical order of operations

```{r}
#| label: basic-math
#| echo: true

4*4
(4+3*2^2)
```

## Assigning Variables {.smaller}

-   Use the `<-` operator
-   Names must begin with a letter
-   R is case sensitive

```{r}
#| label: assigning-variables
#| echo: true

x <- 2
x*3
y <- x * 3
y-2
```

These do **not** work: `3y <- 3` or `3*y <- 3`

## Arithmetic and Functions {.smaller}

```{r}
#| label: week1-arithmetic-basic
#| eval: false
#| echo: true

x+2
x^2
log(x)
```

-   `log` is a built-in function—the object goes in parentheses
-   Results can be assigned to new variables

```{r}
#| label: week1-arithmetic-functions
#| echo: true

y <- 67
x <- 124
z <- (x*y)^2
print(z)
```

## Common Data Types {.smaller}

| Statistical Term       | Description                       | R Type            |
|:-----------------------|:----------------------------------|:------------------|
| Numerical (continuous) | Measurements (height, weight)     | `numeric`         |
| Numerical (discrete)   | Whole number counts               | `integer`         |
| Categorical (nominal)  | Unordered categories (species)    | `factor`          |
| Categorical (ordinal)  | Ordered categories (low/med/high) | `ordered factor`  |
| Logical / Boolean      | TRUE or FALSE values              | `logical`         |
| Text / String          | Free-form text                    | `character`       |
| Date / Time            | Temporal data                     | `Date`, `POSIXct` |

::: callout-tip
Use `class()` or `str()` to check data types
:::

## Strings {.smaller}

-   Characters need quotation marks
-   `c()` stands for `concatenate`

```{r}
#| label: week1-strings-example
#| echo: true

x <- "I Love"
y <- "Biostatistics"
z <- c(x,y)
print(z)
```

## Factors {.smaller}

-   Sometimes we want to treat characters as units for calculations
-   These are called `factors`—important for statistical analyses comparing groups

```{r}
#| label: week1-factors-example
#| eval: true
#| echo: true

z <- "low, medium, high"
z_factor <- as.factor(z)
print(z_factor)
```

## Data Type Coercion {.smaller}

Convert between data types using `as.*` functions:

| Function              | Input     | Output              |
|:----------------------|:----------|:--------------------|
| `as.numeric("42")`    | `"42"`    | `42`                |
| `as.numeric("hello")` | `"hello"` | `NA` (with warning) |
| `as.character(42)`    | `42`      | `"42"`              |
| `as.logical(1)`       | `1`       | `TRUE`              |
| `as.logical(0)`       | `0`       | `FALSE`             |

::: callout-warning
`as.numeric()` on a factor returns integer codes! Use `as.numeric(as.character(x))` instead.
:::

## Vectors

R thinks in terms of vectors (lists of values):

```{r}
#| label: example-vectors
#| echo: true

x <- c(2,3,4,2,1,2,4,5,10,8,9)
print(x)
```

## Creating Vectors {.smaller}

Use functions like `seq` and `sample`:

```{r}
#| label: week1-seq-example
#| echo: true

seq_1 <- seq(0.0, 10.0, by = 0.1)
print(seq_1)
```

```{r}
#| label: week1-seq-squared
#| echo: true

seq_2 <- seq(10.0, 0.0, by = -0.1)
seq_square <- (seq_2)^2
print(seq_square)
```

## Basic Statistics Functions on Vectors {.smaller}

| Function               | Description                      |
|:-----------------------|:---------------------------------|
| `mean(x)`              | Calculate the mean               |
| `median(x)`            | Calculate the median             |
| `var(x)`               | Calculate the variance           |
| `sd(x)`                | Calculate the standard deviation |
| `sum(x)`               | Sum of all values                |
| `length(x)`            | Number of elements               |
| `sample(x, replace=T)` | Random sample with replacement   |

::: callout-note
All of these can function on vectors which are assigned to a variable (e.g. x above)
:::

## Logical Operators {.smaller}

| Operator | Meaning           | Example             |
|:---------|:------------------|:--------------------|
| `==`     | equals            | `x == 5`            |
| `!=`     | not equals        | `x != 5`            |
| `<`, `>` | less/greater than | `x < 10`            |
| `&`      | and               | `x > 0 & x < 10`    |
| `|`      | or                | `x < 0 | x > 10`    |
| `%in%`   | is element of     | `x %in% c(1, 2, 3)` |

```{r}
#| label: week1-logical-operators
#| eval: false
#| echo: true

x <- c(1, 5, 10, 15, 20)
x > 10
x[x > 10]
```

## Handling Missing Data (NA) {.smaller}

| Task               | Code                  | Result            |
|:-------------------|:----------------------|:------------------|
| Check for NA       | `is.na(x)`            | Logical vector    |
| Find non-missing   | `!is.na(x)`           | Inverted logical  |
| **Don't do this!** | `x == NA`             | Always returns NA |
| Mean ignoring NA   | `mean(x, na.rm=TRUE)` | Computes mean     |

::: callout-important
Always use `is.na()` to check for missing values, never `== NA`
:::

## Special Numeric Values {.smaller}

| Value  | Meaning                       | Example       |
|:-------|:------------------------------|:--------------|
| `NA`   | Not Available (missing data)  | `c(1, NA, 3)` |
| `NaN`  | Not a Number (undefined math) | `0/0`         |
| `Inf`  | Positive infinity             | `1/0`         |
| `-Inf` | Negative infinity             | `-1/0`        |

Test with: `is.na()`, `is.nan()`, `is.infinite()`, `is.finite()`

## Getting Help in R {.smaller}

| Command                 | Description             |
|:------------------------|:------------------------|
| `help(mean)` or `?mean` | Open help page          |
| `example(mean)`         | Run examples from help  |
| `help.search("mean")`   | Search all help pages   |
| `args(mean)`            | Show function arguments |

## Working Directory {.smaller}

| Task                    | Code                       |
|:------------------------|:---------------------------|
| Check current directory | `getwd()`                  |
| Set new directory       | `setwd("/path/to/folder")` |
| List files              | `list.files()`             |

::: callout-tip
RStudio Projects (File → New Project) automatically set your working directory
:::

## Common R Errors {.smaller}

| Error Message | Meaning | Fix |
|:---|:---|:---|
| `object 'x' not found` | Variable doesn't exist | Check spelling; run line that creates it |
| `could not find function` | Package not loaded | Use `library()` or check spelling |
| `unexpected ')'` | Mismatched brackets | Count opening/closing brackets |
| `non-numeric argument` | Wrong data type | Check with `class()` |

::: callout-tip
Read error messages from the bottom up—the last line tells you what went wrong
:::

# A few examples of basic R code

## Drawing Samples from Distributions {.smaller}

```{r}
#| label: fig-samples
#| fig-cap: "Random samples from distributions"
#| out-width: "70%"
#| echo: true

x <- rnorm(10000, 0, 10)
y <- sample(1:10000, 10000, replace = T)
plot(x, y, pch = 20, col = rgb(0, 0, 1, 0.3))
```

## Histograms {.smaller}

```{r}
#| label: fig-histogram
#| fig-cap: "Histogram of normally distributed data"
#| out-width: "70%"
#| echo: true

x <- rnorm(10000, 0, 10)
hist(x, col = "steelblue", border = "white", main = "Normal Distribution")
```

## Density Curves {.smaller}

```{r}
#| label: fig-normal-curve
#| fig-cap: "Histogram with density curve overlay"
#| out-width: "70%"
#| echo: true

x <- rnorm(1000, 0, 100)
hist(x, xlim = c(-500,500), col = "lightblue", border = "white", freq = FALSE)
curve(dnorm(x, 0, 100), xlim = c(-500,500), add=TRUE, col='Red', lwd=2)
```

## Binomial Distribution {.smaller}

```{r}
#| label: fig-binomial
#| fig-cap: "Binomial distribution: 10 successes (out of 20 trials) is most frequent"
#| out-width: "60%"
#| echo: true

heads <- rbinom(n=1000, size=20, prob=0.5)
hist(heads, col = "coral", border = "white")
```

## Multiple Plots {.smaller}

Use `par(mfrow=c(rows, cols))` to create composite figures:

```{r}
#| label: fig-composite
#| fig-cap: "Multiple plots in a single figure"
#| out-width: "80%"
#| echo: true

seq_1 <- seq(0.0, 10.0, by = 0.1)
seq_2 <- seq(10.0, 0.0, by = -0.1)

par(mfrow=c(2,2))
plot(seq_1, xlab="time", ylab="p in pop 1", type = "p", col = 'red', pch = 19)
plot(seq_2, xlab="time", ylab="p in pop 2", type = "p", col = 'green', pch = 19)
plot((seq_2)^2, xlab="time", ylab="p2 in pop 2", type = "p", col = 'blue', pch = 19)
plot((seq_1)^2, xlab="time", ylab ="p in pop 1", type = "l", col = 'orange', lwd = 2)
```

# Tidy Data & File Types {background-color="#2c3e50"}

## An Example to Get Started

## 

![](images/week01_44_stickleback_experiment.jpeg){fig-align="center" width="100%"}

## What is Tidy Data? {.smaller}

![](images/week01_45_statistical_terms_table.jpeg){fig-align="center" width="70%"}

## What is Tidy Data? {.smaller}

Different formats may be appropriate for different applications, but one is particularly convenient for data science: **tidy data**.

::: callout-tip
## The Three Principles of Tidy Data

1.  **One observation per row** — All measurements for a single unit
2.  **One variable per column** — Something measured across all units
3.  **One type of observation per data set**
:::

New observations can easily be added as rows, and new variables as columns.

## Tidy Data Set Rules of Thumb {.smaller}

-   Store data in nonproprietary formats (plain ASCII text / flat files)
-   Keep an uncorrected file when doing analyses
-   Use descriptive names for files and variables
-   Include a header line with descriptive variable names
-   A column should contain only one data type
-   Every data set should be accompanied by a `data dictionary` that
    -   describes each variable
    -   describes the overall data set
    -   includes information like researchers, dates, platforms, versions, etc..
-   Data sets are read into R, but the original file isn't altered
-   Any modifications to the file can be read out to a new file with a different name

## Creating an Example Data Frame {.smaller}

```{r}
#| label: week1-dataframe-example
#| echo: true

hydrogel_concentration <- factor(c("low", "high", "high", "high",
                                    "medium", "medium", "medium","low"))
compression <- c(3.4, 3.4, 8.4, 3, 5.6, 8.1, 8.3, 4.5)
conductivity <- c(0, 9.2, 3.8, 5, 5.6, 4.1, 7.1, 5.3)
mydata <- data.frame(hydrogel_concentration, compression, conductivity)
row.names(mydata) <- paste0("Sample_", 1:8)

mydata |>
  rownames_to_column(var = "Sample") |>
  kable()
```

# Importing data

## Common File Formats {.smaller}

| Format          | Extension      | Separator | Notes                         |
|:----------------|:---------------|:----------|:------------------------------|
| Comma-separated | `.csv`         | `,`       | Most common, works with Excel |
| Tab-separated   | `.tsv`, `.txt` | tab       | Good for data with commas     |
| Plain text      | `.txt`         | varies    | Check file for delimiter      |
| Excel           | `.xlsx`        | n/a       | Use `readxl` package          |

::: callout-warning
Always check imported data with `head()`, `str()`, or `View()`
:::

## Genomic Data Formats {.smaller}

| Format  | Extension       | Description                       |
|:--------|:----------------|:----------------------------------|
| FASTA   | `.fasta`, `.fa` | Sequence data (DNA, RNA, protein) |
| FASTQ   | `.fastq`, `.fq` | Sequences with quality scores     |
| SAM/BAM | `.sam`, `.bam`  | Sequence alignments (text/binary) |
| VCF     | `.vcf`          | Variant call format               |
| BED     | `.bed`          | Genomic regions                   |

::: callout-note
Most bioinformatics programs work with FASTQ data
:::

## Reading and Writing Data {.smaller}

**Reading:**

| File Type | Function | Example |
|:---|:---|:---|
| CSV | `read.csv()` | `read.csv('file.csv')` |
| Tab-separated | `read.table()` | `read.table('file.txt', header=TRUE, sep='\t')` |
| Excel | `read_excel()` | `read_excel('file.xlsx')` (requires `readxl`) |

**Writing:**

| Task | Function |
|:---|:---|
| Export as CSV | `write.csv(data, "output.csv", row.names=FALSE)` |
| Export tab-separated | `write.table(data, "output.txt", sep="\t", row.names=FALSE)` |

## R Exercise: Transcriptomic Data

::: callout-tip
## Exercise

-   Examine the stickleback transcriptomic data file.
-   How many rows and columns are there?
-   What types of variables are there?
-   Read the data file into R and analyze it
:::

## Transcriptomic Data Analysis {.smaller}

```{r}
#| label: week1-rnaseq-analysis-code
#| eval: false
#| echo: true

RNAseq_Data <- read.csv('<name_of_file>', header=TRUE, sep=',')

head(RNAseq_Data)
tail(RNAseq_Data)

print(RNAseq_Data$ENSGACG00000000010)
print(RNAseq_Data$ENSGACG00000000010 > 45.0)

summary(RNAseq_Data$ENSGACG00000000003)
boxplot(RNAseq_Data$ENSGACG00000000003 ~ RNAseq_Data$Treatment,
        col = "red", ylab = "Expression Level", xlab = "Treatment")
```

# Reproducible Research with Quarto {background-color="#2c3e50"}

## Why Reproducible Research? {.smaller}

**For Science:**

-   Others can verify your results
-   Methods are completely documented
-   Enables cumulative knowledge building

**For You:**

-   Future you will understand past work
-   Easy to update with new data
-   Professional documentation for publications

::: callout-important
## The Replication Crisis

Many published findings cannot be reproduced. Quarto helps by embedding analysis code directly in documents.
:::

## 

![](images/week01_07_statistical_thinking_in_action.jpeg){fig-align="center" width="90%"}

## The Importance of Organization {.smaller}

![](images/week01_50_messy_lab.jpg){fig-align="center" width="80%"}

Keeping your data, code, and analyses organized is crucial for reproducibility.

## Lab Notebook Example {.smaller}

![](images/week01_51_electronic_lab_notebook_for_re.png){width="80%"}

# Quarto is a scientific organization and publishing system

## What is Quarto? {.smaller}

-   Open-source scientific and technical publishing system
-   Combines code + text + outputs in a single document
-   Successor to R Markdown with expanded capabilities
-   Supports R, Python, Julia, and more
-   Documentation: <https://quarto.org/docs/authoring/markdown-basics.html>

::: callout-tip
## Key Benefits

Reproducibility, documentation, multiple output formats
:::

## Quarto Document Structure {.smaller}

**1. YAML Header - which has global options for rendering**

``` yaml
---
title: "My Analysis"
author: "Your Name"
format: html
---
```

**2. Markdown Text** — Regular text with formatting

**3. Code Chunks** — R (or Python or ...) code that runs

::: callout-note
This will render to your choice of document (e.g. html, pdf, word, etc) and you have many different options for formatting the output, including the code evaluation
:::

## Markdown Basics {.smaller}

**Text Formatting**

| Syntax       | Result   |
|:-------------|:---------|
| `*italic*`   | *italic* |
| `**bold**`   | **bold** |
| `` `code` `` | `code`   |

**Lists:** Use

`-` for bullets,

`1.` for numbered

## Code Chunk {.smaller}

-   You embed code into chunks that look like this:

``` text
\```{r}
#| label: bio-example-setup-one
#| echo: true
#| output: false

set.seed(42)
gene_expression <- tibble(
  sample_id = paste0("S", 1:50),
  treatment = rep(c("Control", "Drug_A", "Drug_B", "Drug_C", "Drug_D"), each = 10),
  gene_BRCA1 = c(rnorm(10, 100, 15), rnorm(10, 150, 20), rnorm(10, 80, 12),
                  rnorm(10, 120, 18), rnorm(10, 95, 14)),
  gene_TP53 = c(rnorm(10, 200, 25), rnorm(10, 180, 22), rnorm(10, 250, 30),
                 rnorm(10, 190, 28), rnorm(10, 210, 24))
)
\```
```

## Code Chunk Options {.smaller}

Quarto uses `#|` (hash pipe) for chunk options:

| Option              | Description           |
|:--------------------|:----------------------|
| `#| echo: true`     | Show code in output   |
| `#| eval: false`    | Don't run the code    |
| `#| output: false`  | Hide results          |
| `#| warning: false` | Hide warnings         |
| `#| fig-cap: "..."` | Figure caption        |
| `#| fig-width: 8`   | Figure width (inches) |

Note that these go into the beginning of each code chunk

## Including Images {.smaller}

**Basic image:**

``` markdown
![Alt text](images/your_image.png)
```

**With options:**

``` markdown
![Caption](images/your_image.png){fig-align="center" width="70%"}
```

## Equations {.smaller}

**Inline math:**

`$e=mc^2$` → $e=mc^2$

**Display math:**

``` latex
$$\iint\limits_{a}^{b} f(x,y) \, dx \, dy$$
```

\
\

$$\iint\limits_{a}^{b} f(x,y) \, dx \, dy$$

## Example: Biological Data Analysis {.smaller}

```{r}
#| label: bio-example-setup
#| echo: true
#| output: false

set.seed(42)
gene_expression <- tibble(
  sample_id = paste0("S", 1:50),
  treatment = rep(c("Control", "Drug_A", "Drug_B", "Drug_C", "Drug_D"), each = 10),
  gene_BRCA1 = c(rnorm(10, 100, 15), rnorm(10, 150, 20), rnorm(10, 80, 12),
                  rnorm(10, 120, 18), rnorm(10, 95, 14)),
  gene_TP53 = c(rnorm(10, 200, 25), rnorm(10, 180, 22), rnorm(10, 250, 30),
                 rnorm(10, 190, 28), rnorm(10, 210, 24))
)
```

## View the Data {.smaller}

```{r}
#| label: tbl-gene-data
#| echo: true

gene_expression |>
  head(8) |>
  kable(digits = 1)
```

## Summary Statistics {.smaller}

```{r}
#| label: tbl-summary-stats
#| echo: true

gene_expression |>
  group_by(treatment) |>
  summarise(
    n = n(),
    BRCA1_mean = mean(gene_BRCA1),
    BRCA1_sd = sd(gene_BRCA1),
    TP53_mean = mean(gene_TP53),
    TP53_sd = sd(gene_TP53)
  ) |>
  kable(digits = 1)
```

## The Pipe Operator {.smaller}

![The pipe operator Mario meme](images/week02_15_w1_mario.jpeg){#fig-week2-pipe-mario fig-align="center" width="70%"}

Pipes connect operations together, passing output from one function to the next.

## This is Not a Pipe {.smaller}

![This is not a pipe - Magritte](images/week02_16_w1_magritte.jpeg){#fig-week2-magritte fig-align="center" width="60%"}

The R pipe (`|>` or `%>%`) is a way to chain operations - but remember, the map is not the territory!

## Pipe Workflow - Step 1 {.smaller}

![Pipe workflow step 1](images/week02_17_w1_pipes_1.jpeg){#fig-week2-pipes-1 fig-align="center" width="90%"}

## Pipe Workflow - Step 2 {.smaller}

![Pipe workflow step 2](images/week02_18_w1_pipes_2.jpeg){#fig-week2-pipes-2 fig-align="center" width="90%"}

## Pipe Workflow - Step 3 {.smaller}

![Pipe workflow step 3](images/week02_19_w1_pipes_3.jpeg){#fig-week2-pipes-3 fig-align="center" width="90%"}

## Pipe Workflow - Step 4 {.smaller}

![Pipe workflow step 4](images/week02_20_w1_pipes_4.jpeg){#fig-week2-pipes-4 fig-align="center" width="90%"}

## Pipe Workflow - Step 5 {.smaller}

![Pipe workflow step 5](images/week02_21_w1_pipes_5.jpeg){#fig-week2-pipes-5 fig-align="center" width="90%"} \## Visualization {.smaller}

```{r}
#| label: fig-gene-boxplot-output
#| fig-cap: "BRCA1 expression across treatment groups"
#| fig-width: 8
#| fig-height: 5
#| echo: false
#| eval: true

ggplot(gene_expression, aes(x = treatment, y = gene_BRCA1, fill = treatment)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  labs(x = "Treatment", y = "BRCA1 Expression (normalized counts)") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_brewer(palette = "Set2")
```

## Visualization Code {.smaller}

```{r}
#| label: fig-gene-boxplot-code
#| echo: true
#| eval: false

ggplot(gene_expression, aes(x = treatment, y = gene_BRCA1, fill = treatment)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5) +
  labs(x = "Treatment", y = "BRCA1 Expression (normalized counts)") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_brewer(palette = "Set2")
```

## Statistical Test {.smaller}

```{r}
#| label: stat-test-output
#| echo: false
#| eval: true

anova_result <- aov(gene_BRCA1 ~ treatment, data = gene_expression)
tidy(anova_result) |>
  kable(digits = 4, caption = "ANOVA Results: BRCA1 Expression by Treatment")
```

## Statistical Test Code {.smaller}

```{r}
#| label: stat-test-code
#| echo: true
#| eval: false

anova_result <- aov(gene_BRCA1 ~ treatment, data = gene_expression)

# Using broom for tidy output
tidy(anova_result) |>
  kable(digits = 4, caption = "ANOVA Results")
```

::: callout-note
The p-value indicates whether there are significant differences between groups.
:::

## Cross-Referencing {.smaller}

This allows all elements within a Quarto document to be referenced from within the text, and then whenever you render the references are all updated automatically.

| Type      | Label Prefix     | Reference Syntax |
|:----------|:-----------------|:-----------------|
| Figures   | `#| label: fig-` | `@fig-name`      |
| Tables    | `#| label: tbl-` | `@tbl-name`      |
| Equations | `{#eq-name}`     | `@eq-name`       |
| Sections  | `{#sec-name}`    | `@sec-name`      |

## Rendering output Formats {.smaller}

Quarto can `render` to many formats:

**Documents:** HTML, PDF, Word (.docx), Markdown

**Presentations:** RevealJS (this presentation!), PowerPoint, Beamer

**Website:** HTML (all of our class material!)

``` yaml
---
format:
  html: default
  pdf: default
  docx: default
---
```
