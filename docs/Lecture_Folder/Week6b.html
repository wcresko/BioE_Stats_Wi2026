<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 6b - Statistics for Bioengineering – BioEngineering Statistics Winter 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f7fe251563e67c05764dc4775ff48cfc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Winter 2026</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Homework.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#this-week" id="toc-this-week" class="nav-link active" data-scroll-target="#this-week">This week</a></li>
  <li><a href="#multiple-linear-regression" id="toc-multiple-linear-regression" class="nav-link" data-scroll-target="#multiple-linear-regression">Multiple Linear regression</a>
  <ul class="collapse">
  <li><a href="#multiple-linear-regression-additive-and-multiplicative-models-of-2-or-more-predictors" id="toc-multiple-linear-regression-additive-and-multiplicative-models-of-2-or-more-predictors" class="nav-link" data-scroll-target="#multiple-linear-regression-additive-and-multiplicative-models-of-2-or-more-predictors">Multiple Linear Regression | Additive and multiplicative models of 2 or more predictors</a></li>
  <li><a href="#multiple-linear-regression-additive-and-multiplicative-models" id="toc-multiple-linear-regression-additive-and-multiplicative-models" class="nav-link" data-scroll-target="#multiple-linear-regression-additive-and-multiplicative-models">Multiple Linear Regression | Additive and multiplicative models</a></li>
  </ul></li>
  <li><a href="#model-selection-when-you-have-many-predictor-variables" id="toc-model-selection-when-you-have-many-predictor-variables" class="nav-link" data-scroll-target="#model-selection-when-you-have-many-predictor-variables">Model selection when you have many predictor variables</a>
  <ul class="collapse">
  <li><a href="#model-selection" id="toc-model-selection" class="nav-link" data-scroll-target="#model-selection">Model selection</a></li>
  <li><a href="#model-selection-the-problems" id="toc-model-selection-the-problems" class="nav-link" data-scroll-target="#model-selection-the-problems">Model selection | the problems</a></li>
  <li><a href="#model-selection-a-beetle-example" id="toc-model-selection-a-beetle-example" class="nav-link" data-scroll-target="#model-selection-a-beetle-example">Model selection | a beetle example</a></li>
  <li><a href="#start-with-linear-regression" id="toc-start-with-linear-regression" class="nav-link" data-scroll-target="#start-with-linear-regression">Start with linear regression</a></li>
  <li><a href="#quadratic-2nd-degree-polynomial" id="toc-quadratic-2nd-degree-polynomial" class="nav-link" data-scroll-target="#quadratic-2nd-degree-polynomial">Quadratic (2nd degree) polynomial?</a></li>
  <li><a href="#a-polynomial-of-degree-10" id="toc-a-polynomial-of-degree-10" class="nav-link" data-scroll-target="#a-polynomial-of-degree-10">A polynomial of degree 10?</a></li>
  <li><a href="#the-problem-with-this-approach" id="toc-the-problem-with-this-approach" class="nav-link" data-scroll-target="#the-problem-with-this-approach">The problem with this approach</a></li>
  <li><a href="#the-problem-with-this-approach-1" id="toc-the-problem-with-this-approach-1" class="nav-link" data-scroll-target="#the-problem-with-this-approach-1">The problem with this approach</a></li>
  <li><a href="#lets-consider-our-goals" id="toc-lets-consider-our-goals" class="nav-link" data-scroll-target="#lets-consider-our-goals">Let’s consider our goals</a></li>
  <li><a href="#how-do-we-accomplish-these-goals" id="toc-how-do-we-accomplish-these-goals" class="nav-link" data-scroll-target="#how-do-we-accomplish-these-goals">How do we accomplish these goals?</a></li>
  <li><a href="#how-do-we-accomplish-these-goals-1" id="toc-how-do-we-accomplish-these-goals-1" class="nav-link" data-scroll-target="#how-do-we-accomplish-these-goals-1">How do we accomplish these goals?</a></li>
  <li><a href="#how-do-we-accomplish-these-goals-2" id="toc-how-do-we-accomplish-these-goals-2" class="nav-link" data-scroll-target="#how-do-we-accomplish-these-goals-2">How do we accomplish these goals?</a></li>
  <li><a href="#r-interlude---model-fitting" id="toc-r-interlude---model-fitting" class="nav-link" data-scroll-target="#r-interlude---model-fitting">R INTERLUDE - model fitting</a></li>
  <li><a href="#aic-based-stepwise-selection" id="toc-aic-based-stepwise-selection" class="nav-link" data-scroll-target="#aic-based-stepwise-selection">AIC-based stepwise selection</a></li>
  <li><a href="#bic-based-stepwise-selection" id="toc-bic-based-stepwise-selection" class="nav-link" data-scroll-target="#bic-based-stepwise-selection">BIC-based stepwise selection</a></li>
  <li><a href="#mallows-cp-using-all-subsets-regression" id="toc-mallows-cp-using-all-subsets-regression" class="nav-link" data-scroll-target="#mallows-cp-using-all-subsets-regression">Mallow’s Cp using all subsets regression</a></li>
  <li><a href="#comparing-the-models" id="toc-comparing-the-models" class="nav-link" data-scroll-target="#comparing-the-models">Comparing the models</a></li>
  </ul></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance">Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  </ul></li>
  <li><a href="#an-example---irises" id="toc-an-example---irises" class="nav-link" data-scroll-target="#an-example---irises">An Example - Irises</a>
  <ul class="collapse">
  <li><a href="#an-example---irises-1" id="toc-an-example---irises-1" class="nav-link" data-scroll-target="#an-example---irises-1">An Example - Irises</a></li>
  <li><a href="#an-example---irises-2" id="toc-an-example---irises-2" class="nav-link" data-scroll-target="#an-example---irises-2">An Example - Irises</a></li>
  <li><a href="#anovas-and-hypotheses" id="toc-anovas-and-hypotheses" class="nav-link" data-scroll-target="#anovas-and-hypotheses">ANOVAs and Hypotheses</a></li>
  <li><a href="#anova-similar-to-regression" id="toc-anova-similar-to-regression" class="nav-link" data-scroll-target="#anova-similar-to-regression">ANOVA | similar to regression</a></li>
  <li><a href="#anova-1" id="toc-anova-1" class="nav-link" data-scroll-target="#anova-1">ANOVA</a></li>
  <li><a href="#anova-statistical-results-table" id="toc-anova-statistical-results-table" class="nav-link" data-scroll-target="#anova-statistical-results-table">ANOVA | Statistical results table</a></li>
  <li><a href="#anova-f-ratio-calculation" id="toc-anova-f-ratio-calculation" class="nav-link" data-scroll-target="#anova-f-ratio-calculation">ANOVA | F-ratio calculation</a></li>
  <li><a href="#anova-f-ratio-calculation-1" id="toc-anova-f-ratio-calculation-1" class="nav-link" data-scroll-target="#anova-f-ratio-calculation-1">ANOVA | F-ratio calculation</a></li>
  <li><a href="#assumptions-of-anova" id="toc-assumptions-of-anova" class="nav-link" data-scroll-target="#assumptions-of-anova">Assumptions of ANOVA</a></li>
  <li><a href="#lets-practice-with-irises" id="toc-lets-practice-with-irises" class="nav-link" data-scroll-target="#lets-practice-with-irises">Let’s practice with irises</a></li>
  <li><a href="#lets-practice-with-irises-1" id="toc-lets-practice-with-irises-1" class="nav-link" data-scroll-target="#lets-practice-with-irises-1">Let’s practice with irises</a></li>
  <li><a href="#lets-practice-with-irises-2" id="toc-lets-practice-with-irises-2" class="nav-link" data-scroll-target="#lets-practice-with-irises-2">Let’s practice with irises</a></li>
  <li><a href="#anova-results" id="toc-anova-results" class="nav-link" data-scroll-target="#anova-results">ANOVA results</a></li>
  <li><a href="#nonparametric-tests-similar-to-anova" id="toc-nonparametric-tests-similar-to-anova" class="nav-link" data-scroll-target="#nonparametric-tests-similar-to-anova">Nonparametric tests similar to ANOVA</a></li>
  <li><a href="#nonparametric-tests-similar-to-anova-1" id="toc-nonparametric-tests-similar-to-anova-1" class="nav-link" data-scroll-target="#nonparametric-tests-similar-to-anova-1">Nonparametric tests similar to ANOVA</a></li>
  </ul></li>
  <li><a href="#anova-and-linear-models" id="toc-anova-and-linear-models" class="nav-link" data-scroll-target="#anova-and-linear-models">ANOVA and linear models</a>
  <ul class="collapse">
  <li><a href="#anova-and-linear-models-1" id="toc-anova-and-linear-models-1" class="nav-link" data-scroll-target="#anova-and-linear-models-1">ANOVA and linear models</a></li>
  <li><a href="#on-your-own" id="toc-on-your-own" class="nav-link" data-scroll-target="#on-your-own">On your own</a></li>
  </ul></li>
  <li><a href="#testing-what-levels-of-factor-variable-differ-from-one-another" id="toc-testing-what-levels-of-factor-variable-differ-from-one-another" class="nav-link" data-scroll-target="#testing-what-levels-of-factor-variable-differ-from-one-another">Testing what levels of factor variable differ from one another</a>
  <ul class="collapse">
  <li><a href="#post-hoc-comparisons" id="toc-post-hoc-comparisons" class="nav-link" data-scroll-target="#post-hoc-comparisons">Post Hoc Comparisons</a></li>
  <li><a href="#lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set" id="toc-lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set" class="nav-link" data-scroll-target="#lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set">Let’s practice - using the categorical predictor variables in the stickleback data set</a></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a></li>
  <li><a href="#tukeys-posthoc" id="toc-tukeys-posthoc" class="nav-link" data-scroll-target="#tukeys-posthoc">Tukey’s posthoc</a></li>
  <li><a href="#plot-of-the-different-levels" id="toc-plot-of-the-different-levels" class="nav-link" data-scroll-target="#plot-of-the-different-levels">Plot of the different levels</a></li>
  <li><a href="#on-your-own---irises-and-biomarker-data" id="toc-on-your-own---irises-and-biomarker-data" class="nav-link" data-scroll-target="#on-your-own---irises-and-biomarker-data">On your own - Irises and Biomarker Data</a></li>
  <li><a href="#lets-practice---irises-and-biomarker-data" id="toc-lets-practice---irises-and-biomarker-data" class="nav-link" data-scroll-target="#lets-practice---irises-and-biomarker-data">Let’s practice - Irises and Biomarker Data</a></li>
  </ul></li>
  <li><a href="#general-linear-mixed-models" id="toc-general-linear-mixed-models" class="nav-link" data-scroll-target="#general-linear-mixed-models">General Linear Mixed Models</a>
  <ul class="collapse">
  <li><a href="#what-is-a-glmm" id="toc-what-is-a-glmm" class="nav-link" data-scroll-target="#what-is-a-glmm">What is a GLMM?</a></li>
  <li><a href="#how-do-we-factor-in-categorical-variables" id="toc-how-do-we-factor-in-categorical-variables" class="nav-link" data-scroll-target="#how-do-we-factor-in-categorical-variables">How do we factor in categorical variables?</a></li>
  <li><a href="#a-generalized-linear-model" id="toc-a-generalized-linear-model" class="nav-link" data-scroll-target="#a-generalized-linear-model">A Generalized Linear Model</a></li>
  <li><a href="#first-steps-use-a-glm-to-test-wolbachia-infection" id="toc-first-steps-use-a-glm-to-test-wolbachia-infection" class="nav-link" data-scroll-target="#first-steps-use-a-glm-to-test-wolbachia-infection">First steps: use a glm to test Wolbachia infection</a></li>
  <li><a href="#first-steps-use-a-glm-to-test-wolbachia-infection-1" id="toc-first-steps-use-a-glm-to-test-wolbachia-infection-1" class="nav-link" data-scroll-target="#first-steps-use-a-glm-to-test-wolbachia-infection-1">First steps: use a glm to test Wolbachia infection</a></li>
  <li><a href="#interpreting-the-glm" id="toc-interpreting-the-glm" class="nav-link" data-scroll-target="#interpreting-the-glm">Interpreting the GLM</a></li>
  <li><a href="#second-steps---adding-more-variables" id="toc-second-steps---adding-more-variables" class="nav-link" data-scroll-target="#second-steps---adding-more-variables">Second steps - adding more variables</a></li>
  <li><a href="#second-steps---adding-more-variables-1" id="toc-second-steps---adding-more-variables-1" class="nav-link" data-scroll-target="#second-steps---adding-more-variables-1">Second steps - adding more variables</a></li>
  <li><a href="#interpreting-the-glm-1" id="toc-interpreting-the-glm-1" class="nav-link" data-scroll-target="#interpreting-the-glm-1">Interpreting the GLM</a></li>
  <li><a href="#interaction-effects-in-glms" id="toc-interaction-effects-in-glms" class="nav-link" data-scroll-target="#interaction-effects-in-glms">Interaction effects in GLMs</a></li>
  <li><a href="#third-steps---adding-interaction-effects" id="toc-third-steps---adding-interaction-effects" class="nav-link" data-scroll-target="#third-steps---adding-interaction-effects">Third steps - adding interaction effects</a></li>
  <li><a href="#third-steps---adding-interaction-effects-1" id="toc-third-steps---adding-interaction-effects-1" class="nav-link" data-scroll-target="#third-steps---adding-interaction-effects-1">Third steps - adding interaction effects</a></li>
  <li><a href="#how-do-we-know-which-model-to-use" id="toc-how-do-we-know-which-model-to-use" class="nav-link" data-scroll-target="#how-do-we-know-which-model-to-use">How do we know which model to use?</a></li>
  <li><a href="#multiple-linear-regression---goals" id="toc-multiple-linear-regression---goals" class="nav-link" data-scroll-target="#multiple-linear-regression---goals">Multiple Linear Regression - Goals</a></li>
  <li><a href="#r-interlude-one-way-anova" id="toc-r-interlude-one-way-anova" class="nav-link" data-scroll-target="#r-interlude-one-way-anova">R INTERLUDE | One way ANOVA</a></li>
  <li><a href="#r-interlude-one-way-anova-1" id="toc-r-interlude-one-way-anova-1" class="nav-link" data-scroll-target="#r-interlude-one-way-anova-1">R INTERLUDE | One way ANOVA</a></li>
  <li><a href="#anova-one-or-more-predictor-variables" id="toc-anova-one-or-more-predictor-variables" class="nav-link" data-scroll-target="#anova-one-or-more-predictor-variables">ANOVA | One or more predictor variables</a></li>
  <li><a href="#anova-assumptions" id="toc-anova-assumptions" class="nav-link" data-scroll-target="#anova-assumptions">ANOVA | Assumptions</a></li>
  </ul></li>
  <li><a href="#different-ways-to-include-factors-in-models" id="toc-different-ways-to-include-factors-in-models" class="nav-link" data-scroll-target="#different-ways-to-include-factors-in-models">Different ways to include factors in models</a>
  <ul class="collapse">
  <li><a href="#anova-fixed-effects-of-factors" id="toc-anova-fixed-effects-of-factors" class="nav-link" data-scroll-target="#anova-fixed-effects-of-factors">ANOVA | Fixed effects of factors</a></li>
  <li><a href="#anova-random-effects-of-factors" id="toc-anova-random-effects-of-factors" class="nav-link" data-scroll-target="#anova-random-effects-of-factors">ANOVA | Random effects of factors</a></li>
  <li><a href="#anova-random-effects-of-factors-1" id="toc-anova-random-effects-of-factors-1" class="nav-link" data-scroll-target="#anova-random-effects-of-factors-1">ANOVA | Random effects of factors</a></li>
  <li><a href="#anova-random-effects-of-factors-2" id="toc-anova-random-effects-of-factors-2" class="nav-link" data-scroll-target="#anova-random-effects-of-factors-2">ANOVA | Random effects of factors</a></li>
  <li><a href="#anova-random-effects---test-your-understanding" id="toc-anova-random-effects---test-your-understanding" class="nav-link" data-scroll-target="#anova-random-effects---test-your-understanding">ANOVA | Random effects - test your understanding</a></li>
  <li><a href="#anova-caution-about-fixed-vs.-random-effects" id="toc-anova-caution-about-fixed-vs.-random-effects" class="nav-link" data-scroll-target="#anova-caution-about-fixed-vs.-random-effects">ANOVA | Caution about fixed vs.&nbsp;random effects</a></li>
  </ul></li>
  <li><a href="#means-test-to-compare-levels-of-a-factor" id="toc-means-test-to-compare-levels-of-a-factor" class="nav-link" data-scroll-target="#means-test-to-compare-levels-of-a-factor">Means test to compare levels of a factor</a>
  <ul class="collapse">
  <li><a href="#means-for-greater-than-two-factor-levels" id="toc-means-for-greater-than-two-factor-levels" class="nav-link" data-scroll-target="#means-for-greater-than-two-factor-levels">Means for greater than two factor levels?</a></li>
  <li><a href="#planned-a-priori-contrasts" id="toc-planned-a-priori-contrasts" class="nav-link" data-scroll-target="#planned-a-priori-contrasts">Planned (a priori) contrasts</a></li>
  <li><a href="#planned-a-priori-contrasts-1" id="toc-planned-a-priori-contrasts-1" class="nav-link" data-scroll-target="#planned-a-priori-contrasts-1">Planned (a priori) contrasts</a></li>
  <li><a href="#understand-the-coefficients-table" id="toc-understand-the-coefficients-table" class="nav-link" data-scroll-target="#understand-the-coefficients-table">Understand the coefficients table</a></li>
  <li><a href="#r-interlude-planned-contrasts" id="toc-r-interlude-planned-contrasts" class="nav-link" data-scroll-target="#r-interlude-planned-contrasts">R INTERLUDE | Planned contrasts</a></li>
  <li><a href="#r-interlude-planned-contrasts-1" id="toc-r-interlude-planned-contrasts-1" class="nav-link" data-scroll-target="#r-interlude-planned-contrasts-1">R INTERLUDE | Planned contrasts</a></li>
  <li><a href="#r-interlude-unplanned-contrasts" id="toc-r-interlude-unplanned-contrasts" class="nav-link" data-scroll-target="#r-interlude-unplanned-contrasts">R INTERLUDE | Unplanned contrasts</a></li>
  </ul></li>
  <li><a href="#multifactor-anova" id="toc-multifactor-anova" class="nav-link" data-scroll-target="#multifactor-anova">Multifactor ANOVA</a>
  <ul class="collapse">
  <li><a href="#multifactor-anova-1" id="toc-multifactor-anova-1" class="nav-link" data-scroll-target="#multifactor-anova-1">Multifactor ANOVA</a></li>
  <li><a href="#multifactor-anova-key-difference-between-nested-and-factorial-designs" id="toc-multifactor-anova-key-difference-between-nested-and-factorial-designs" class="nav-link" data-scroll-target="#multifactor-anova-key-difference-between-nested-and-factorial-designs">Multifactor ANOVA | Key difference between nested and factorial designs</a></li>
  </ul></li>
  <li><a href="#nested-anova" id="toc-nested-anova" class="nav-link" data-scroll-target="#nested-anova">Nested ANOVA</a>
  <ul class="collapse">
  <li><a href="#nested-anova-walking-stick-example" id="toc-nested-anova-walking-stick-example" class="nav-link" data-scroll-target="#nested-anova-walking-stick-example">Nested ANOVA | Walking stick example</a></li>
  <li><a href="#nested-anova-walking-stick-example-1" id="toc-nested-anova-walking-stick-example-1" class="nav-link" data-scroll-target="#nested-anova-walking-stick-example-1">Nested ANOVA | Walking stick example</a></li>
  <li><a href="#nested-anova-walking-stick-example-2" id="toc-nested-anova-walking-stick-example-2" class="nav-link" data-scroll-target="#nested-anova-walking-stick-example-2">Nested ANOVA | Walking stick example</a></li>
  <li><a href="#nested-anova-anova-table-of-results" id="toc-nested-anova-anova-table-of-results" class="nav-link" data-scroll-target="#nested-anova-anova-table-of-results">Nested ANOVA | ANOVA Table of Results</a></li>
  <li><a href="#nesting-logic" id="toc-nesting-logic" class="nav-link" data-scroll-target="#nesting-logic">Nesting Logic</a></li>
  <li><a href="#nesting-equations" id="toc-nesting-equations" class="nav-link" data-scroll-target="#nesting-equations">Nesting equations</a></li>
  <li><a href="#nesting-hypothesis-tests" id="toc-nesting-hypothesis-tests" class="nav-link" data-scroll-target="#nesting-hypothesis-tests">Nesting hypothesis tests</a></li>
  <li><a href="#nesting-ms-calculations" id="toc-nesting-ms-calculations" class="nav-link" data-scroll-target="#nesting-ms-calculations">Nesting MS calculations</a></li>
  <li><a href="#nested-anova-table-of-results" id="toc-nested-anova-table-of-results" class="nav-link" data-scroll-target="#nested-anova-table-of-results">Nested ANOVA table of results</a></li>
  <li><a href="#r-interlude-nested-anova" id="toc-r-interlude-nested-anova" class="nav-link" data-scroll-target="#r-interlude-nested-anova">R INTERLUDE | Nested ANOVA</a></li>
  <li><a href="#r-interlude-nested-anova-1" id="toc-r-interlude-nested-anova-1" class="nav-link" data-scroll-target="#r-interlude-nested-anova-1">R INTERLUDE | Nested ANOVA</a></li>
  <li><a href="#r-interlude-nested-anova-2" id="toc-r-interlude-nested-anova-2" class="nav-link" data-scroll-target="#r-interlude-nested-anova-2">R INTERLUDE | Nested ANOVA</a></li>
  <li><a href="#r-interlude-nested-anova-3" id="toc-r-interlude-nested-anova-3" class="nav-link" data-scroll-target="#r-interlude-nested-anova-3">R INTERLUDE | Nested ANOVA</a></li>
  </ul></li>
  <li><a href="#factorial-designs" id="toc-factorial-designs" class="nav-link" data-scroll-target="#factorial-designs">Factorial Designs</a>
  <ul class="collapse">
  <li><a href="#multifactor-anova-2" id="toc-multifactor-anova-2" class="nav-link" data-scroll-target="#multifactor-anova-2">Multifactor ANOVA</a></li>
  <li><a href="#multifactor-anova-3" id="toc-multifactor-anova-3" class="nav-link" data-scroll-target="#multifactor-anova-3">Multifactor ANOVA</a></li>
  <li><a href="#two-factor-factorial-designs" id="toc-two-factor-factorial-designs" class="nav-link" data-scroll-target="#two-factor-factorial-designs">Two Factor Factorial Designs</a></li>
  <li><a href="#three-factor-factorial-designs" id="toc-three-factor-factorial-designs" class="nav-link" data-scroll-target="#three-factor-factorial-designs">Three Factor Factorial Designs</a></li>
  <li><a href="#factorial-designs-number-of-replicates" id="toc-factorial-designs-number-of-replicates" class="nav-link" data-scroll-target="#factorial-designs-number-of-replicates">Factorial Designs | Number of Replicates</a></li>
  <li><a href="#model-1-factorial-anova-both-main-effects-fixed" id="toc-model-1-factorial-anova-both-main-effects-fixed" class="nav-link" data-scroll-target="#model-1-factorial-anova-both-main-effects-fixed">Model 1 factorial ANOVA | both main effects fixed</a></li>
  <li><a href="#model-2-factorial-anova-both-main-effects-fixed" id="toc-model-2-factorial-anova-both-main-effects-fixed" class="nav-link" data-scroll-target="#model-2-factorial-anova-both-main-effects-fixed">Model 2 factorial ANOVA | both main effects fixed</a></li>
  <li><a href="#model-2-factorial-anova-both-main-effects-random" id="toc-model-2-factorial-anova-both-main-effects-random" class="nav-link" data-scroll-target="#model-2-factorial-anova-both-main-effects-random">Model 2 factorial ANOVA | both main effects random</a></li>
  <li><a href="#the-mean-squares-for-a-factorial-model" id="toc-the-mean-squares-for-a-factorial-model" class="nav-link" data-scroll-target="#the-mean-squares-for-a-factorial-model">The mean squares for a factorial model</a></li>
  <li><a href="#the-f-ratios-for-a-factorial-model" id="toc-the-f-ratios-for-a-factorial-model" class="nav-link" data-scroll-target="#the-f-ratios-for-a-factorial-model">The F-ratios for a factorial model</a></li>
  <li><a href="#interpretation-significant-main-and-interaction-effects" id="toc-interpretation-significant-main-and-interaction-effects" class="nav-link" data-scroll-target="#interpretation-significant-main-and-interaction-effects">Interpretation | significant main and interaction effects</a></li>
  <li><a href="#interaction-plots" id="toc-interaction-plots" class="nav-link" data-scroll-target="#interaction-plots">Interaction plots</a></li>
  <li><a href="#r-interlude-2-by-2-fixed-effect-factorial-anova" id="toc-r-interlude-2-by-2-fixed-effect-factorial-anova" class="nav-link" data-scroll-target="#r-interlude-2-by-2-fixed-effect-factorial-anova">R INTERLUDE | 2-by-2 fixed effect factorial ANOVA</a></li>
  <li><a href="#fit-the-factorial-linear-model-two-different-ways-to-do-the-same-thing" id="toc-fit-the-factorial-linear-model-two-different-ways-to-do-the-same-thing" class="nav-link" data-scroll-target="#fit-the-factorial-linear-model-two-different-ways-to-do-the-same-thing">Fit the factorial linear model | two different ways to do the same thing</a></li>
  <li><a href="#r-interlude-2-by-3-fixed-effect-factorial-anova" id="toc-r-interlude-2-by-3-fixed-effect-factorial-anova" class="nav-link" data-scroll-target="#r-interlude-2-by-3-fixed-effect-factorial-anova">R INTERLUDE | 2-by-3 fixed effect factorial ANOVA</a></li>
  </ul></li>
  <li><a href="#means-tests-for-multifactorial-anovas" id="toc-means-tests-for-multifactorial-anovas" class="nav-link" data-scroll-target="#means-tests-for-multifactorial-anovas">Means tests for multifactorial ANOVAs</a>
  <ul class="collapse">
  <li><a href="#means-tests-factor-level-combinations-in-multi-factor-anova" id="toc-means-tests-factor-level-combinations-in-multi-factor-anova" class="nav-link" data-scroll-target="#means-tests-factor-level-combinations-in-multi-factor-anova">Means tests | factor level combinations in multi-factor ANOVA</a></li>
  <li><a href="#planned-a-priori-contrasts-2" id="toc-planned-a-priori-contrasts-2" class="nav-link" data-scroll-target="#planned-a-priori-contrasts-2">Planned (a priori) contrasts</a></li>
  <li><a href="#r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction" id="toc-r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction" class="nav-link" data-scroll-target="#r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction">R INTERLUDE | 2x2 Fixed-Effects Factorial ANOVA contrasts &amp; interaction</a></li>
  <li><a href="#r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction-1" id="toc-r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction-1" class="nav-link" data-scroll-target="#r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction-1">R INTERLUDE | 2x2 Fixed-Effects Factorial ANOVA contrasts &amp; interaction</a></li>
  </ul></li>
  <li><a href="#mixed-effect-models-with-unequal-sample-sizes" id="toc-mixed-effect-models-with-unequal-sample-sizes" class="nav-link" data-scroll-target="#mixed-effect-models-with-unequal-sample-sizes">Mixed effect models with unequal sample sizes</a>
  <ul class="collapse">
  <li><a href="#attributes-of-mixed-effects-models" id="toc-attributes-of-mixed-effects-models" class="nav-link" data-scroll-target="#attributes-of-mixed-effects-models">Attributes of mixed effects models</a></li>
  <li><a href="#assumptions-of-mixed-effects-models" id="toc-assumptions-of-mixed-effects-models" class="nav-link" data-scroll-target="#assumptions-of-mixed-effects-models">Assumptions of mixed-effects models</a></li>
  <li><a href="#hypotheses-for-model-3-anova-factorial-design-with-mixed-effects" id="toc-hypotheses-for-model-3-anova-factorial-design-with-mixed-effects" class="nav-link" data-scroll-target="#hypotheses-for-model-3-anova-factorial-design-with-mixed-effects">Hypotheses for Model 3 ANOVA Factorial Design With Mixed Effects</a></li>
  <li><a href="#general-r-syntax-for-two-factor-factorial-designs" id="toc-general-r-syntax-for-two-factor-factorial-designs" class="nav-link" data-scroll-target="#general-r-syntax-for-two-factor-factorial-designs">General R syntax for two factor factorial designs</a></li>
  <li><a href="#r-interlude-variance-components-with-2-random-factors-using-lme4" id="toc-r-interlude-variance-components-with-2-random-factors-using-lme4" class="nav-link" data-scroll-target="#r-interlude-variance-components-with-2-random-factors-using-lme4">R INTERLUDE | Variance components with 2 random factors using LME4</a></li>
  </ul></li>
  <li><a href="#analysis-of-covariance-ancova" id="toc-analysis-of-covariance-ancova" class="nav-link" data-scroll-target="#analysis-of-covariance-ancova">Analysis of Covariance (ANCOVA)</a>
  <ul class="collapse">
  <li><a href="#brain-body-size-neaderthals-as-compared-to-humans" id="toc-brain-body-size-neaderthals-as-compared-to-humans" class="nav-link" data-scroll-target="#brain-body-size-neaderthals-as-compared-to-humans">Brain &amp; body size | neaderthals as compared to humans</a></li>
  <li><a href="#brain-body-size-neaderthals-as-compared-to-humans-1" id="toc-brain-body-size-neaderthals-as-compared-to-humans-1" class="nav-link" data-scroll-target="#brain-body-size-neaderthals-as-compared-to-humans-1">Brain &amp; body size | neaderthals as compared to humans</a></li>
  <li><a href="#brain-body-size-neaderthals-as-compared-to-humans-2" id="toc-brain-body-size-neaderthals-as-compared-to-humans-2" class="nav-link" data-scroll-target="#brain-body-size-neaderthals-as-compared-to-humans-2">Brain &amp; body size | neaderthals as compared to humans</a></li>
  <li><a href="#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova">ANCOVA</a></li>
  <li><a href="#ancova-adjusting-for-the-covariate" id="toc-ancova-adjusting-for-the-covariate" class="nav-link" data-scroll-target="#ancova-adjusting-for-the-covariate">ANCOVA | Adjusting for the covariate</a></li>
  <li><a href="#ancova-adjusting-for-the-covariate-1" id="toc-ancova-adjusting-for-the-covariate-1" class="nav-link" data-scroll-target="#ancova-adjusting-for-the-covariate-1">ANCOVA | Adjusting for the covariate</a></li>
  <li><a href="#ancova-linear-model-with-two-covariates" id="toc-ancova-linear-model-with-two-covariates" class="nav-link" data-scroll-target="#ancova-linear-model-with-two-covariates">ANCOVA | Linear model with two covariates</a></li>
  <li><a href="#ancova-factor-and-covariate-hypothesis-tests" id="toc-ancova-factor-and-covariate-hypothesis-tests" class="nav-link" data-scroll-target="#ancova-factor-and-covariate-hypothesis-tests">ANCOVA | Factor and covariate hypothesis tests</a></li>
  <li><a href="#ancova-f-ratio-tests" id="toc-ancova-f-ratio-tests" class="nav-link" data-scroll-target="#ancova-f-ratio-tests">ANCOVA | F ratio tests</a></li>
  <li><a href="#ancova-assumptions" id="toc-ancova-assumptions" class="nav-link" data-scroll-target="#ancova-assumptions">ANCOVA | Assumptions</a></li>
  <li><a href="#ancova-heterogeneous-slopes" id="toc-ancova-heterogeneous-slopes" class="nav-link" data-scroll-target="#ancova-heterogeneous-slopes">ANCOVA | Heterogeneous slopes</a></li>
  <li><a href="#ancova-heterogeneous-slopes-1" id="toc-ancova-heterogeneous-slopes-1" class="nav-link" data-scroll-target="#ancova-heterogeneous-slopes-1">ANCOVA | Heterogeneous slopes</a></li>
  <li><a href="#ancova-non-overlapping-range-of-the-covariate" id="toc-ancova-non-overlapping-range-of-the-covariate" class="nav-link" data-scroll-target="#ancova-non-overlapping-range-of-the-covariate">ANCOVA | Non-overlapping range of the covariate</a></li>
  <li><a href="#r-interlude-ancova" id="toc-r-interlude-ancova" class="nav-link" data-scroll-target="#r-interlude-ancova">R INTERLUDE | ANCOVA</a></li>
  <li><a href="#r-interlude-ancova-1" id="toc-r-interlude-ancova-1" class="nav-link" data-scroll-target="#r-interlude-ancova-1">R INTERLUDE | ANCOVA</a></li>
  <li><a href="#r-interlude-ancova-2" id="toc-r-interlude-ancova-2" class="nav-link" data-scroll-target="#r-interlude-ancova-2">R INTERLUDE | ANCOVA</a></li>
  <li><a href="#r-interlude-ancova-3" id="toc-r-interlude-ancova-3" class="nav-link" data-scroll-target="#r-interlude-ancova-3">R INTERLUDE | ANCOVA</a></li>
  </ul></li>
  <li><a href="#design-principles-for-planning-a-good-experiment" id="toc-design-principles-for-planning-a-good-experiment" class="nav-link" data-scroll-target="#design-principles-for-planning-a-good-experiment">Design principles for planning a good experiment</a>
  <ul class="collapse">
  <li><a href="#what-is-an-experimental-study" id="toc-what-is-an-experimental-study" class="nav-link" data-scroll-target="#what-is-an-experimental-study">What is an experimental study?</a></li>
  <li><a href="#key-components-of-a-good-experiment" id="toc-key-components-of-a-good-experiment" class="nav-link" data-scroll-target="#key-components-of-a-good-experiment">Key components of a good experiment</a></li>
  <li><a href="#mount-everest-example" id="toc-mount-everest-example" class="nav-link" data-scroll-target="#mount-everest-example">Mount Everest example</a></li>
  <li><a href="#mount-everest-example-1" id="toc-mount-everest-example-1" class="nav-link" data-scroll-target="#mount-everest-example-1">Mount Everest example</a></li>
  <li><a href="#clinical-trials" id="toc-clinical-trials" class="nav-link" data-scroll-target="#clinical-trials">Clinical Trials</a></li>
  <li><a href="#example-of-a-clinical-trial" id="toc-example-of-a-clinical-trial" class="nav-link" data-scroll-target="#example-of-a-clinical-trial">Example of a clinical trial</a></li>
  <li><a href="#example-of-a-clinical-trial-1" id="toc-example-of-a-clinical-trial-1" class="nav-link" data-scroll-target="#example-of-a-clinical-trial-1">Example of a clinical trial</a></li>
  <li><a href="#design-components-of-a-clinical-trial" id="toc-design-components-of-a-clinical-trial" class="nav-link" data-scroll-target="#design-components-of-a-clinical-trial">Design components of a clinical trial</a></li>
  <li><a href="#design-components-of-a-clinical-trial-1" id="toc-design-components-of-a-clinical-trial-1" class="nav-link" data-scroll-target="#design-components-of-a-clinical-trial-1">Design components of a clinical trial</a></li>
  <li><a href="#simultaneous-control-group" id="toc-simultaneous-control-group" class="nav-link" data-scroll-target="#simultaneous-control-group">Simultaneous control group</a></li>
  <li><a href="#simultaneous-control-group-1" id="toc-simultaneous-control-group-1" class="nav-link" data-scroll-target="#simultaneous-control-group-1">Simultaneous control group</a></li>
  <li><a href="#randomization" id="toc-randomization" class="nav-link" data-scroll-target="#randomization">Randomization</a></li>
  <li><a href="#randomization-1" id="toc-randomization-1" class="nav-link" data-scroll-target="#randomization-1">Randomization</a></li>
  <li><a href="#randomization-2" id="toc-randomization-2" class="nav-link" data-scroll-target="#randomization-2">Randomization</a></li>
  <li><a href="#randomization-types" id="toc-randomization-types" class="nav-link" data-scroll-target="#randomization-types">Randomization Types</a></li>
  <li><a href="#sampling-approaches" id="toc-sampling-approaches" class="nav-link" data-scroll-target="#sampling-approaches">Sampling approaches</a></li>
  <li><a href="#bias-in-experiments" id="toc-bias-in-experiments" class="nav-link" data-scroll-target="#bias-in-experiments">Bias in experiments</a></li>
  <li><a href="#bias-in-surveys" id="toc-bias-in-surveys" class="nav-link" data-scroll-target="#bias-in-surveys">Bias in surveys</a></li>
  <li><a href="#statistical-sampling" id="toc-statistical-sampling" class="nav-link" data-scroll-target="#statistical-sampling">Statistical sampling</a></li>
  <li><a href="#blinding" id="toc-blinding" class="nav-link" data-scroll-target="#blinding">Blinding</a></li>
  <li><a href="#blinding-1" id="toc-blinding-1" class="nav-link" data-scroll-target="#blinding-1">Blinding</a></li>
  <li><a href="#blinding-2" id="toc-blinding-2" class="nav-link" data-scroll-target="#blinding-2">Blinding</a></li>
  <li><a href="#blinding-3" id="toc-blinding-3" class="nav-link" data-scroll-target="#blinding-3">Blinding</a></li>
  <li><a href="#blinding-4" id="toc-blinding-4" class="nav-link" data-scroll-target="#blinding-4">Blinding</a></li>
  <li><a href="#replication" id="toc-replication" class="nav-link" data-scroll-target="#replication">Replication</a></li>
  <li><a href="#replication-1" id="toc-replication-1" class="nav-link" data-scroll-target="#replication-1">Replication</a></li>
  <li><a href="#replication-2" id="toc-replication-2" class="nav-link" data-scroll-target="#replication-2">Replication</a></li>
  <li><a href="#pseudoreplication" id="toc-pseudoreplication" class="nav-link" data-scroll-target="#pseudoreplication">Pseudoreplication</a></li>
  <li><a href="#balance" id="toc-balance" class="nav-link" data-scroll-target="#balance">Balance</a></li>
  <li><a href="#balance-1" id="toc-balance-1" class="nav-link" data-scroll-target="#balance-1">Balance</a></li>
  <li><a href="#blocking" id="toc-blocking" class="nav-link" data-scroll-target="#blocking">Blocking</a></li>
  <li><a href="#blocking-paired-designs" id="toc-blocking-paired-designs" class="nav-link" data-scroll-target="#blocking-paired-designs">Blocking | Paired designs</a></li>
  <li><a href="#blocking-paired-designs-1" id="toc-blocking-paired-designs-1" class="nav-link" data-scroll-target="#blocking-paired-designs-1">Blocking | Paired designs</a></li>
  <li><a href="#blocking-paired-designs-2" id="toc-blocking-paired-designs-2" class="nav-link" data-scroll-target="#blocking-paired-designs-2">Blocking | Paired designs</a></li>
  <li><a href="#blocking-randomized-complete-block-design" id="toc-blocking-randomized-complete-block-design" class="nav-link" data-scroll-target="#blocking-randomized-complete-block-design">Blocking | Randomized complete block design</a></li>
  <li><a href="#what-if-you-cant-do-experiments" id="toc-what-if-you-cant-do-experiments" class="nav-link" data-scroll-target="#what-if-you-cant-do-experiments">What if you can’t do experiments?</a></li>
  </ul></li>
  <li><a href="#how-to-present-your-statistical-results" id="toc-how-to-present-your-statistical-results" class="nav-link" data-scroll-target="#how-to-present-your-statistical-results">How to present your statistical results</a>
  <ul class="collapse">
  <li><a href="#style-of-a-results-section" id="toc-style-of-a-results-section" class="nav-link" data-scroll-target="#style-of-a-results-section">Style of a results section</a></li>
  <li><a href="#function-of-a-results-section" id="toc-function-of-a-results-section" class="nav-link" data-scroll-target="#function-of-a-results-section">Function of a results section</a></li>
  <li><a href="#summaries-of-the-statistical-analyses" id="toc-summaries-of-the-statistical-analyses" class="nav-link" data-scroll-target="#summaries-of-the-statistical-analyses">Summaries of the statistical analyses</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#differences-directionality-and-magnitude" id="toc-differences-directionality-and-magnitude" class="nav-link" data-scroll-target="#differences-directionality-and-magnitude">Differences, directionality, and magnitude</a></li>
  <li><a href="#statistical-results-in-text" id="toc-statistical-results-in-text" class="nav-link" data-scroll-target="#statistical-results-in-text">Statistical results in text</a></li>
  <li><a href="#statistical-results-in-text-1" id="toc-statistical-results-in-text-1" class="nav-link" data-scroll-target="#statistical-results-in-text-1">Statistical results in text</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week6b.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 6b - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.2
✔ purrr     1.2.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gt' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="this-week" class="level2">
<h2 class="anchored" data-anchor-id="this-week">This week</h2>
<ul>
<li><p>Model 1 and 2 regression</p></li>
<li><p>Multiple linear regression</p></li>
<li><p>Analysis of Variance (ANOVA)</p></li>
<li><p>Key principles of experimental design</p></li>
<li><p>How to report statistics in papers</p></li>
</ul>
</section>
<section id="multiple-linear-regression" class="level1">
<h1>Multiple Linear regression</h1>
<section id="multiple-linear-regression-additive-and-multiplicative-models-of-2-or-more-predictors" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression-additive-and-multiplicative-models-of-2-or-more-predictors">Multiple Linear Regression | Additive and multiplicative models of 2 or more predictors</h2>
<p>Additive model <span class="math display">\[y_i = \beta_0 + \beta_1x_{1} + \beta_2x_{2} + ... + \beta_jx_{j} + \epsilon_i\]</span></p>
<p><br>
</p>
<p>Multiplicative model (with two predictors) <span class="math display">\[y_i = \beta_0 + \beta_1x_1 + \beta_2x_2 + \beta_3x_1x_2 + \epsilon_i\]</span></p>
</section>
<section id="multiple-linear-regression-additive-and-multiplicative-models" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression-additive-and-multiplicative-models">Multiple Linear Regression | Additive and multiplicative models</h2>
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5a.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-selection-when-you-have-many-predictor-variables" class="level1">
<h1>Model selection when you have many predictor variables</h1>
<section id="model-selection" class="level2">
<h2 class="anchored" data-anchor-id="model-selection">Model selection</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.004.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-selection-the-problems" class="level2">
<h2 class="anchored" data-anchor-id="model-selection-the-problems">Model selection | the problems</h2>
<ul>
<li><p>How to decide the complexity of polynomial: straight line regression, quadratic, cubic, ….</p></li>
<li><p>Which variables to keep/ discard when building a multiple regression model?</p></li>
<li><p>Selecting from candidate models representing different biological processes.</p></li>
</ul>
</section>
<section id="model-selection-a-beetle-example" class="level2">
<h2 class="anchored" data-anchor-id="model-selection-a-beetle-example">Model selection | a beetle example</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="start-with-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="start-with-linear-regression">Start with linear regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="quadratic-2nd-degree-polynomial" class="level2">
<h2 class="anchored" data-anchor-id="quadratic-2nd-degree-polynomial">Quadratic (2nd degree) polynomial?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="a-polynomial-of-degree-10" class="level2">
<h2 class="anchored" data-anchor-id="a-polynomial-of-degree-10">A polynomial of degree 10?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.010.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-problem-with-this-approach" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-with-this-approach">The problem with this approach</h2>
<ul>
<li>The log likelihood of the model increases with the number of parameters</li>
<li>So does <span class="math inline">\(r^2\)</span></li>
<li>Isn’t this good - the best fit to the data?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-problem-with-this-approach-1" class="level2">
<h2 class="anchored" data-anchor-id="the-problem-with-this-approach-1">The problem with this approach</h2>
<blockquote class="blockquote">
<p>“models should be pared down until they are minimal and adequate”</p>
</blockquote>
<p>Crawley 2007, p325</p>
<p><br>
<br>
</p>
<ul>
<li>Parsimony - fit no more parameters than is necessary.</li>
<li>If two or more models fit the data almost equally well, prefer the simpler model.</li>
</ul>
</section>
<section id="lets-consider-our-goals" class="level2">
<h2 class="anchored" data-anchor-id="lets-consider-our-goals">Let’s consider our goals</h2>
<ul>
<li><p>Model should predicts well</p></li>
<li><p>Approximates true relationship between the variables</p></li>
<li><p>Be able to evaluate a wider array of models.</p></li>
<li><p>An overfitted model may not predict well in the future!</p></li>
</ul>
</section>
<section id="how-do-we-accomplish-these-goals" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="how-do-we-accomplish-these-goals">How do we accomplish these goals?</h2>
<p>How to accomplish these goals To answer this, we need</p>
<ol type="1">
<li>A criterion to compare models:
<ul>
<li>Adjusted <span class="math inline">\(R^2\)</span></li>
<li>Mallow’s Cp</li>
<li>AIC (Akaike’s Information Criterion)</li>
<li>BIC (Bayesian Information Criterion)</li>
</ul></li>
<li>A strategy for searching the candidate models
<ul>
<li>Forwards</li>
<li>Backwards</li>
<li>All combinations</li>
</ul></li>
</ol>
</section>
<section id="how-do-we-accomplish-these-goals-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="how-do-we-accomplish-these-goals-1">How do we accomplish these goals?</h2>
<ul>
<li><strong>Adjusted</strong> <span class="math inline">\(R^2\)</span>
<ul>
<li>the proportion of mean amount of variation in response variable explained by the model</li>
<li>is adjusted for both sample size and the number of terms.</li>
<li>Larger values indicate better fit.</li>
</ul></li>
<li><strong>Mallow’s Cp</strong> -
<ul>
<li>is an index resulting from the comparison of the specific model to a model that contain all the possible terms.</li>
<li>Models with the lowest value and/or values closest to their respective p (the number of model terms, including the y-intercept) indicate best fit.</li>
<li>Frequently used in multiple regression</li>
<li>Strategy: Test all possible models and selection the one with the smallest Cp</li>
<li>Cp ~ P - the model is considered to be a good fit</li>
<li>Cp &gt; P - the model might be missing important factors</li>
<li>Cp &lt; P - the model might be overfitting too many parameters</li>
<li><code>leaps</code> package in R does a smart search among models</li>
</ul></li>
</ul>
</section>
<section id="how-do-we-accomplish-these-goals-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="how-do-we-accomplish-these-goals-2">How do we accomplish these goals?</h2>
<ul>
<li><strong>Akaike Information Criteria (AIC)</strong>
<ul>
<li>There are several different versions of AIC</li>
<li>Each version adds a different constant designed to penalize according to the number of parameters and sample size to a likelihood function to produce a relative measure of the information content of a model.</li>
<li><strong><em>Significantly</em></strong> smaller values indicate more parsimonious models.</li>
<li>As a rule of thumb, if the difference between two AIC values (delta AIC) is greater than 2, the lower AIC is a significant improvement in parsimony.</li>
</ul></li>
<li><strong>Bayesian or Schwarz Information Criteria (BIC or SIC)</strong>
<ul>
<li>BIC is outwardly similar to AIC.</li>
<li>Like AIC, the model with the lowest BIC is typically selected</li>
<li>The constant added to the likelihood function penalizes models with more predictor terms more heavily (and thus select more simple models) than AIC.</li>
<li>It is for this reason that BIC is favored by many researchers.</li>
</ul></li>
</ul>
</section>
<section id="r-interlude---model-fitting" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude---model-fitting">R INTERLUDE - model fitting</h2>
<ul>
<li>The <code>MASS</code> library is used for <code>stepAIC</code> and <code>stepBIC</code></li>
<li>The <code>leaps</code> library is used for <code>Mallow's Cp</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)       <span class="co"># for stepAIC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaps)      <span class="co"># for regsubsets (Mallow's Cp)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)        <span class="co"># for vif (optional: multicollinearity)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    some</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>biomarker_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"biomarkers.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(biomarker_data<span class="sc">$</span>marker1 <span class="sc">~</span> marker2 <span class="sc">+</span> marker3 <span class="sc">+</span> marker4 <span class="sc">+</span> marker5 <span class="sc">+</span> marker6, <span class="at">data =</span> biomarker_data)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(full_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = biomarker_data$marker1 ~ marker2 + marker3 + marker4 + 
    marker5 + marker6, data = biomarker_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-25.0998  -6.2578   0.9321   6.5981  24.5741 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 337.886384  38.716208   8.727 1.19e-15 ***
marker2       0.011402   0.014156   0.805   0.4215    
marker3       0.965065   0.028644  33.691  &lt; 2e-16 ***
marker4      -0.066742   0.034039  -1.961   0.0513 .  
marker5       0.008825   0.014098   0.626   0.5321    
marker6      -0.008459   0.061264  -0.138   0.8903    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.805 on 194 degrees of freedom
Multiple R-squared:  0.9737,    Adjusted R-squared:  0.973 
F-statistic:  1435 on 5 and 194 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="aic-based-stepwise-selection" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="aic-based-stepwise-selection">AIC-based stepwise selection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">### AIC-based stepwise selection </span><span class="al">###</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Stepwise selection using AIC (both directions)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>step_aic <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = biomarker_data$marker1 ~ marker3 + marker4, data = biomarker_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-24.2069  -5.9493   0.9458   6.4603  24.1383 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 344.29166   36.44220   9.448   &lt;2e-16 ***
marker3       0.97655    0.02055  47.521   &lt;2e-16 ***
marker4      -0.06788    0.03363  -2.019   0.0449 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.756 on 197 degrees of freedom
Multiple R-squared:  0.9735,    Adjusted R-squared:  0.9733 
F-statistic:  3623 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="bic-based-stepwise-selection" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="bic-based-stepwise-selection">BIC-based stepwise selection</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">### BIC-based stepwise selection </span><span class="al">###</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC is calculated as: -2*logLik + log(n)*k</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(biomarker_data)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#step_bic &lt;- stepAIC(full_model, direction = "both", trace = FALSE)</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>step_bic <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full_model, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k =</span> <span class="fu">log</span>(n), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = biomarker_data$marker1 ~ marker3, data = biomarker_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-25.681  -6.947   1.079   6.938  23.419 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 271.15909    3.95699   68.53   &lt;2e-16 ***
marker3       1.01041    0.01196   84.45   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.832 on 198 degrees of freedom
Multiple R-squared:  0.973, Adjusted R-squared:  0.9729 
F-statistic:  7132 on 1 and 198 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="mallows-cp-using-all-subsets-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="mallows-cp-using-all-subsets-regression">Mallow’s Cp using all subsets regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Mallow's Cp using all subsets regression </span><span class="al">###</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Use leaps to compute Mallow's Cp</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>leaps_result <span class="ot">&lt;-</span> <span class="fu">regsubsets</span>(biomarker_data<span class="sc">$</span>marker1 <span class="sc">~</span> ., <span class="at">data =</span> biomarker_data, <span class="at">nvmax =</span> <span class="fu">ncol</span>(biomarker_data) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>leaps_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(leaps_result)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract Mallow's Cp values</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>cp_values <span class="ot">&lt;-</span> leaps_summary<span class="sc">$</span>cp</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Find model with minimum Cp</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>min_cp_index <span class="ot">&lt;-</span> <span class="fu">which.min</span>(cp_values)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>best_model_vars <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">coef</span>(leaps_result, min_cp_index))[<span class="sc">-</span><span class="dv">1</span>]  <span class="co"># exclude intercept</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model using variables from best Cp</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>cp_formula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"biomarker_data$marker1 ~"</span>, <span class="fu">paste</span>(best_model_vars, <span class="at">collapse =</span> <span class="st">" + "</span>)))</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>cp_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(cp_formula, <span class="at">data =</span> biomarker_data)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cp_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cp_formula, data = biomarker_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-24.2069  -5.9493   0.9458   6.4603  24.1383 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 344.29166   36.44220   9.448   &lt;2e-16 ***
marker3       0.97655    0.02055  47.521   &lt;2e-16 ***
marker4      -0.06788    0.03363  -2.019   0.0449 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.756 on 197 degrees of freedom
Multiple R-squared:  0.9735,    Adjusted R-squared:  0.9733 
F-statistic:  3623 on 2 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="comparing-the-models" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="comparing-the-models">Comparing the models</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
--- AIC Model ---</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>biomarker_data$marker1 ~ marker3 + marker4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>AIC: 1483.712 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>--- BIC Model ---</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>biomarker_data$marker1 ~ marker3</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>BIC: 1495.701 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>--- Mallow's Cp Model ---</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>biomarker_data$marker1 ~ marker3 + marker4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Cp: -0.4337318 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="analysis-of-variance" class="level1">
<h1>Analysis of Variance</h1>
<section id="anova" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="anova">ANOVA</h2>
<ul>
<li>Stands for <strong>AN</strong>alysis <strong>o</strong>f <strong>VA</strong>riance</li>
<li>Core statistical procedure in biology</li>
<li>Developed by R.A. Fisher in the early 20th Century</li>
<li>The core idea is to ask how much variation exists within vs.&nbsp;among groups</li>
<li>ANOVAs are linear models that have <strong>categorical predictor</strong> and <strong>continuous response</strong> variables</li>
<li>The categorical predictors are often called <strong>factors</strong>, and can have two or more <strong>levels</strong> (important to specify in R)</li>
<li>Each factor will have a <strong>hypothesis test</strong></li>
<li>The levels of each factor may also need to be tested (means tests)</li>
</ul>
</section>
</section>
<section id="an-example---irises" class="level1">
<h1>An Example - Irises</h1>
<ul>
<li>Let’s use an example to think about how ANOVA works under the hood</li>
<li>Our system: Iris flowers have sepals and petals of differing lengths</li>
<li>The question: do different species have different sepal lengths?</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week9_irises.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<section id="an-example---irises-1" class="level2">
<h2 class="anchored" data-anchor-id="an-example---irises-1">An Example - Irises</h2>
<ul>
<li>We have data built into base R</li>
<li>3 Different species: <em>Iris versicolor</em>, <em>Iris setosa</em>, and <em>Iris virginica</em></li>
<li>Length of sepal as a continuous variable</li>
<li>Question - do the species differ in the length of sepals?</li>
</ul>
</section>
<section id="an-example---irises-2" class="level2">
<h2 class="anchored" data-anchor-id="an-example---irises-2">An Example - Irises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species, <span class="at">vertical=</span>T, <span class="at">method=</span><span class="st">"jitter"</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab=</span><span class="st">"sepal length"</span>, <span class="at">xlab=</span><span class="st">"species"</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week6b_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anovas-and-hypotheses" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anovas-and-hypotheses">ANOVAs and Hypotheses</h2>
<ul>
<li><p>As with any statistical test, we will be testing the probability of accepting or rejecting our null hypothesis, compared to an alternative hypothesis</p></li>
<li><p>What are the null and alternative hypotheses for our example?</p></li>
</ul>
<p><span class="math display">\[ H_0: \mu(\text{versicolor_length"}) = \mu(\text{setosa_length}) = \mu(\text{virginica_length})  \]</span><br>
</p>
<p><span class="math display">\[ H_a: \mu(\text{versicolor_length"}) \neq \mu(\text{setosa_length}) \neq \mu(\text{virginica_length}) \]</span></p>
<ul>
<li>NOTE: the alternative hypothesis is that at least one group is different</li>
</ul>
</section>
<section id="anova-similar-to-regression" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova-similar-to-regression">ANOVA | similar to regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-1" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova-1">ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-statistical-results-table" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova-statistical-results-table">ANOVA | Statistical results table</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-f-ratio-calculation" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova-f-ratio-calculation">ANOVA | F-ratio calculation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.018.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-f-ratio-calculation-1" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova-f-ratio-calculation-1">ANOVA | F-ratio calculation</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.019.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="assumptions-of-anova" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-of-anova">Assumptions of ANOVA</h2>
<ol type="1">
<li><p>The response variable (y) is approximately normal in all groups (factor levels)</p>
<ul>
<li>Deviation from normality O.K. if sample sizes and variances across groups are equal</li>
</ul></li>
<li><p>Variances equal across groups</p></li>
<li><p>Observations within a group are independent</p>
<ul>
<li><p>randomly sampled</p></li>
<li><p>no structuring</p></li>
</ul></li>
</ol>
</section>
<section id="lets-practice-with-irises" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="lets-practice-with-irises">Let’s practice with irises</h2>
<ul>
<li>First steps, what are the null and alternative hypotheses for our test? (Already done!)</li>
<li>Next, do our data meet or violate the assumptions of ANOVA tests?</li>
<li>Then, we can set up our ANOVA</li>
<li>What tests should you run (functions, graphing, etc.) in RStudio to evaluate if the data is O.K. to use in an ANOVA test?
<ul>
<li>Plot the data for each group as a histogram - is it normally distributed?</li>
<li>Run variance tests between the groups - do they have equal variance?</li>
<li>Is our data randomly sampled? Assume yes.</li>
</ul></li>
</ul>
</section>
<section id="lets-practice-with-irises-1" class="level2">
<h2 class="anchored" data-anchor-id="lets-practice-with-irises-1">Let’s practice with irises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>set <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species <span class="sc">==</span><span class="st">"setosa"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>vers <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species <span class="sc">==</span><span class="st">"versicolor"</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>vir <span class="ot">&lt;-</span> <span class="fu">subset</span>(iris, Species<span class="sc">==</span><span class="st">"virginica"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(set<span class="sc">$</span>Sepal.Length, <span class="at">main =</span> <span class="st">"I. setosa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week6b_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:33.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(vers<span class="sc">$</span>Sepal.Length, <span class="at">main =</span> <span class="st">"I. versicolor"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week6b_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid figure-img" style="width:33.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(vir<span class="sc">$</span>Sepal.Length, <span class="at">main=</span><span class="st">"I. virginica"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week6b_files/figure-html/unnamed-chunk-21-3.png" class="img-fluid figure-img" style="width:33.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="lets-practice-with-irises-2" class="level2">
<h2 class="anchored" data-anchor-id="lets-practice-with-irises-2">Let’s practice with irises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>iris_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Sepal.Length <span class="sc">~</span> Species, iris)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(iris_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Sepal.Length
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species     2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals 147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>How do we interpret these findings?</li>
</ul>
</section>
<section id="anova-results" class="level2">
<h2 class="anchored" data-anchor-id="anova-results">ANOVA results</h2>
<ul>
<li>Species is significantly associated with differences in sepal length!</li>
<li>The Mean Square (MS) of our factor (species) explains more of the variance in the response variable (sepal length) than the residuals (random or unmeasured variables)</li>
</ul>
</section>
<section id="nonparametric-tests-similar-to-anova" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-tests-similar-to-anova">Nonparametric tests similar to ANOVA</h2>
<ul>
<li>The Kruskal-Wallis test is robust to non-normality and group variance differences</li>
<li>Check out the help page for <code>kruskal.test()</code> and run a model on iris sepal length</li>
</ul>
</section>
<section id="nonparametric-tests-similar-to-anova-1" class="level2">
<h2 class="anchored" data-anchor-id="nonparametric-tests-similar-to-anova-1">Nonparametric tests similar to ANOVA</h2>
<ul>
<li>Also a significant difference between species</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(Sepal.Length <span class="sc">~</span> Species, iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Sepal.Length by Species
Kruskal-Wallis chi-squared = 96.937, df = 2, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="anova-and-linear-models" class="level1">
<h1>ANOVA and linear models</h1>
<ul>
<li>We can use the function <code>lm()</code> to also run an analysis of variance</li>
<li>Try it out! Set up a linear model to find the relationship between species and sepal length</li>
<li>Can you identify where in the results you can find information about ANOVA?</li>
</ul>
<section id="anova-and-linear-models-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anova-and-linear-models-1">ANOVA and linear models</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = iris$Sepal.Length ~ iris$Species)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              5.0060     0.0728  68.762  &lt; 2e-16 ***
iris$Speciesversicolor   0.9300     0.1030   9.033 8.77e-16 ***
iris$Speciesvirginica    1.5820     0.1030  15.366  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="on-your-own" class="level2">
<h2 class="anchored" data-anchor-id="on-your-own">On your own</h2>
<ul>
<li>set up an analysis using the biomarker data</li>
<li>Use the <code>diagnosis</code> categorical variable as the predictor for one of the markers</li>
<li>Note that you’ll likely need to coerce the varible to be <code>as.factor</code></li>
</ul>
</section>
</section>
<section id="testing-what-levels-of-factor-variable-differ-from-one-another" class="level1">
<h1>Testing what levels of factor variable differ from one another</h1>
<section id="post-hoc-comparisons" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="post-hoc-comparisons">Post Hoc Comparisons</h2>
<ul>
<li>So now you’ve got a significant result that says your groups are different from one another!</li>
<li>But <strong>how</strong> are they different? 2 groups could be the same and 1 is different, or all 3 could be different from each other!</li>
<li>There are several ways to compare groups after an ANOVA</li>
<li>One of the most common ways is by Tukey’s tests (Tukey’s range test, Tukey’s honestly significant difference (HSD) test)</li>
<li>The function <code>TukeyHSD()</code> in R</li>
</ul>
</section>
<section id="lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set" class="level2">
<h2 class="anchored" data-anchor-id="lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set">Let’s practice - using the categorical predictor variables in the stickleback data set</h2>
<ul>
<li>Read in the data as before</li>
<li>Pick one or two categorical predictor variables to include</li>
<li>Make sure that R sees them as type <code>factor</code></li>
<li>Set up the model and evaluate the overall fit</li>
<li>Do a post-hoc means test with Tukey’s HSD</li>
</ul>
</section>
<section id="fitting-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>stickle_micro <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"Stickle_RNAseq.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>stickle_micro_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(Gene42 <span class="sc">~</span> Geno.Micro, stickle_micro)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stickle_micro_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Gene42
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Geno.Micro  3 120764   40255  25.328 1.837e-11 ***
Residuals  76 120789    1589                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="tukeys-posthoc" class="level2">
<h2 class="anchored" data-anchor-id="tukeys-posthoc">Tukey’s posthoc</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(stickle_micro_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Gene42 ~ Geno.Micro, data = stickle_micro)

$Geno.Micro
              diff        lwr        upr     p adj
convB-convA   50.5   17.38429  83.615711 0.0008090
monoA-convA  -29.1  -62.21571   4.015711 0.1051497
monoB-convA  -53.9  -87.01571 -20.784289 0.0003145
monoA-convB  -79.6 -112.71571 -46.484289 0.0000001
monoB-convB -104.4 -137.51571 -71.284289 0.0000000
monoB-monoA  -24.8  -57.91571   8.315711 0.2095350</code></pre>
</div>
</div>
</section>
<section id="plot-of-the-different-levels" class="level2">
<h2 class="anchored" data-anchor-id="plot-of-the-different-levels">Plot of the different levels</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(stickle_micro, <span class="fu">aes</span>(<span class="at">x =</span> Geno.Micro, <span class="at">y =</span> Gene42)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Box Plot by Category"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Category"</span>,</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Value"</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week6b_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="on-your-own---irises-and-biomarker-data" class="level2">
<h2 class="anchored" data-anchor-id="on-your-own---irises-and-biomarker-data">On your own - Irises and Biomarker Data</h2>
<ul>
<li>The function <code>TukeyHSD()</code> in R</li>
<li>Run post-hoc analyses on your anova model using TukeyHSD function
<ul>
<li>Check out the help page to figure out how to run</li>
</ul></li>
<li>How do you interpret the results?</li>
</ul>
</section>
<section id="lets-practice---irises-and-biomarker-data" class="level2">
<h2 class="anchored" data-anchor-id="lets-practice---irises-and-biomarker-data">Let’s practice - Irises and Biomarker Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>iris_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Sepal.Length <span class="sc">~</span> Species, iris)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(iris_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Sepal.Length ~ Species, data = iris)

$Species
                      diff       lwr       upr p adj
versicolor-setosa    0.930 0.6862273 1.1737727     0
virginica-setosa     1.582 1.3382273 1.8257727     0
virginica-versicolor 0.652 0.4082273 0.8957727     0</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="general-linear-mixed-models" class="level1">
<h1>General Linear Mixed Models</h1>
<section id="what-is-a-glmm" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-glmm">What is a GLMM?</h2>
<ul>
<li>General Linear Mixed Model (<strong>GLMM</strong>) - a continuous response variable with a mix of continuous and categorical predictor variables, can be used to model random effects (for more on this, see Peter Ralph’s Advanced Bio Stats class)</li>
</ul>
</section>
<section id="how-do-we-factor-in-categorical-variables" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-factor-in-categorical-variables">How do we factor in categorical variables?</h2>
<ul>
<li>For a single categorical predictor, we can include effects of each factor level:</li>
</ul>
<p><span class="math display">\[ y = B_0 + B_1(x~level1) + B_2(x~level2) +~... ~+ e \]</span></p>
<ul>
<li>Each factor level (ex: for Wolbachia: Yes or No) becomes it’s own “effector” that will change the value of y</li>
<li>Instead of x being a continuous numerical value, for categorical data it will be either a 0 or 1</li>
</ul>
</section>
<section id="a-generalized-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="a-generalized-linear-model">A Generalized Linear Model</h2>
<ul>
<li>Check out the help page in RStudio for <code>glm()</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="at">formula =</span> y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="first-steps-use-a-glm-to-test-wolbachia-infection" class="level2">
<h2 class="anchored" data-anchor-id="first-steps-use-a-glm-to-test-wolbachia-infection">First steps: use a glm to test Wolbachia infection</h2>
<ul>
<li>Set up a <code>glm()</code> to test for the effect of Wolbachia infection on Recombinant Fraction</li>
</ul>
</section>
<section id="first-steps-use-a-glm-to-test-wolbachia-infection-1" class="level2">
<h2 class="anchored" data-anchor-id="first-steps-use-a-glm-to-test-wolbachia-infection-1">First steps: use a glm to test Wolbachia infection</h2>
<ul>
<li>What do these components mean?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(fly<span class="sc">$</span>RecombinantFraction <span class="sc">~</span> fly<span class="sc">$</span>Wolbachia, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link=</span><span class="st">"identity"</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-the-glm" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-glm">Interpreting the GLM</h2>
<ul>
<li>Why is our intercept significant?
<ul>
<li>Remember that the null hypothesis is a model with an intercept and slope of 0</li>
</ul></li>
<li>How would you interpret the “WolbachiaYes” coefficient, especially the estimate and the p value?</li>
</ul>
</section>
<section id="second-steps---adding-more-variables" class="level2">
<h2 class="anchored" data-anchor-id="second-steps---adding-more-variables">Second steps - adding more variables</h2>
<ul>
<li>Now let’s add Food to our model - how does this change our model results?</li>
</ul>
</section>
<section id="second-steps---adding-more-variables-1" class="level2">
<h2 class="anchored" data-anchor-id="second-steps---adding-more-variables-1">Second steps - adding more variables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(fly<span class="sc">$</span>RecombinantFraction <span class="sc">~</span> fly<span class="sc">$</span>Wolbachia <span class="sc">+</span> fly<span class="sc">$</span>Food, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interpreting-the-glm-1" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-the-glm-1">Interpreting the GLM</h2>
<ul>
<li>How would you interpret the Intercept and Food coefficients, especially the estimate and the p value?</li>
</ul>
</section>
<section id="interaction-effects-in-glms" class="level2">
<h2 class="anchored" data-anchor-id="interaction-effects-in-glms">Interaction effects in GLMs</h2>
<ul>
<li>You can also model interactions between two categorical variables in glms
<ul>
<li>What if variable x and variable z interact in non-additive ways?</li>
</ul></li>
<li>Use the notation x*z in the formula</li>
</ul>
</section>
<section id="third-steps---adding-interaction-effects" class="level2">
<h2 class="anchored" data-anchor-id="third-steps---adding-interaction-effects">Third steps - adding interaction effects</h2>
<ul>
<li>Let’s finally add an interaction between Wolbachia infection and Food to represent Wolbachia titer in our model</li>
<li>Run the model - what are the results?</li>
</ul>
</section>
<section id="third-steps---adding-interaction-effects-1" class="level2">
<h2 class="anchored" data-anchor-id="third-steps---adding-interaction-effects-1">Third steps - adding interaction effects</h2>
<ul>
<li>How do we interpret these findings?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(fly<span class="sc">$</span>RecombinantFraction <span class="sc">~</span> fly<span class="sc">$</span>Wolbachia <span class="sc">+</span> fly<span class="sc">$</span>Food <span class="sc">+</span> fly<span class="sc">$</span>Wolbachia<span class="sc">*</span>fly<span class="sc">$</span>Food, <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-do-we-know-which-model-to-use" class="level2">
<h2 class="anchored" data-anchor-id="how-do-we-know-which-model-to-use">How do we know which model to use?</h2>
<ul>
<li>Want to be careful not to <em>overfit</em> your linear model (give too many variables)</li>
<li>The Akaike information criterion (AIC) is a metric for comparing different models to find the best fit
<ul>
<li>Notice the AIC score in your output?</li>
<li>For more on this, take Advanced Bio Stats! Or do some reading on the internet.</li>
</ul></li>
</ul>
</section>
<section id="multiple-linear-regression---goals" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression---goals">Multiple Linear Regression - Goals</h2>
<ul>
<li>To develop a better predictive model than is possible from models based on single independent variables.</li>
<li>To investigate the relative individual effects of each of the multiple independent variables above and beyond the effects of the other variables.</li>
<li>The individual effects of each of the predictor variables on the response variable can be depicted by single partial regression lines.</li>
<li>The slope of any single partial regression line (partial regression slope) thereby represents the rate of change or effect of that specific predictor variable (holding all the other predictor variables constant to their respective mean values) on the response variable.</li>
</ul>
</section>
<section id="r-interlude-one-way-anova" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-one-way-anova">R INTERLUDE | One way ANOVA</h2>
<ul>
<li>Again, use the RNAseq_lip.tsv data again.</li>
<li>Let’s test for an effect of Population on Gene01 expression levels</li>
<li>First, let’s look at how the data are distributed</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>RNAseq_Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'RNAseq_lip.tsv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> RNAseq_Data<span class="sc">$</span>Gene01</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>Pop <span class="ot">&lt;-</span> RNAseq_Data<span class="sc">$</span>Population</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(g1<span class="sc">~</span>Pop, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"green"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or, to plot all points:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(g1<span class="sc">~</span>Pop, <span class="at">vertical=</span>T, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"green"</span>), </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">at=</span><span class="fu">c</span>(<span class="fl">1.25</span>,<span class="fl">1.75</span>), <span class="at">method=</span><span class="st">"jitter"</span>, <span class="at">jitter=</span><span class="fl">0.05</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>Pop_Anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(g1 <span class="sc">~</span> Pop)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Pop_Anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-one-way-anova-1" class="level2 smaller vcenter flexbox">
<h2 class="smaller vcenter flexbox anchored" data-anchor-id="r-interlude-one-way-anova-1">R INTERLUDE | One way ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.001.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-one-or-more-predictor-variables" class="level2">
<h2 class="anchored" data-anchor-id="anova-one-or-more-predictor-variables">ANOVA | One or more predictor variables</h2>
<ul>
<li>One-way ANOVAs just have a single factor</li>
<li>Multi-factor ANOVAs
<ul>
<li>Factorial - two or more factors and their interactions</li>
<li>Nested - the levels of one factor are contained within another level</li>
<li>The models can be quite complex</li>
</ul></li>
<li>ANOVAs use an F-statistic to test factors in a model
<ul>
<li>Ratio of two variances (numerator and denominator)</li>
<li>The numerator and denominator d.f. need to be included (e.g.&nbsp;<span class="math inline">\(F_{1, 34} = 29.43\)</span>)</li>
</ul></li>
<li>Determining the appropriate test ratios for complex ANOVAs takes some work</li>
</ul>
</section>
<section id="anova-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="anova-assumptions">ANOVA | Assumptions</h2>
<ul>
<li>Normally distributed groups
<ul>
<li>robust to non-normality if equal variances and sample sizes</li>
</ul></li>
<li>Equal variances across groups
<ul>
<li>okay if largest-to-smallest variance ratio &lt; 3:1</li>
<li>problematic if there is a mean-variance relationship among groups</li>
</ul></li>
<li>Observations in a group are independent
<ul>
<li>randomly selected</li>
<li>don’t confound group with another factor</li>
</ul></li>
</ul>
</section>
</section>
<section id="different-ways-to-include-factors-in-models" class="level1">
<h1>Different ways to include factors in models</h1>
<section id="anova-fixed-effects-of-factors" class="level2">
<h2 class="anchored" data-anchor-id="anova-fixed-effects-of-factors">ANOVA | Fixed effects of factors</h2>
<ul>
<li>Groups are predetermined, of direct interest, repeatable.</li>
<li>For example:
<ul>
<li>medical treatments in a clinical trial</li>
<li>predetermined doses of a toxin</li>
<li>age groups in a population</li>
<li>habitat, season, etc.</li>
</ul></li>
<li>Any conclusions reached in the study about differences among groups can be applied only to the groups included in the study.</li>
<li>The results cannot be generalized to other treatments, habitats, etc. not included in the study.</li>
</ul>
</section>
<section id="anova-random-effects-of-factors" class="level2">
<h2 class="anchored" data-anchor-id="anova-random-effects-of-factors">ANOVA | Random effects of factors</h2>
<ul>
<li>Measurements that come in groups. A group can be:
<ul>
<li>a family made up of siblings</li>
<li>a subject measured repeatedly</li>
<li>a transect of quadrats in a sampling survey</li>
<li>a block of an experiment done at a given time</li>
</ul></li>
<li>Groups are assumed to be randomly sampled from a population of groups.</li>
<li>Therefore, conclusions reached about groups can be generalized to the population of groups.</li>
<li>With random effects, the variance among groups is the main quantity of interest, not the specific group attributes.</li>
</ul>
</section>
<section id="anova-random-effects-of-factors-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anova-random-effects-of-factors-1">ANOVA | Random effects of factors</h2>
<ul>
<li>Below are cases where you are likely to treat factors as random effects</li>
<li>Whenever your sampling design is nested
<ul>
<li>quadrats within transects</li>
<li>transects within woodlots</li>
<li>woodlots within districts</li>
</ul></li>
<li>Whenever you divide up plots and apply separate treatments to subplots</li>
<li>Whenever your replicates are grouped spatially or temporally
<ul>
<li>in blocks</li>
<li>in batches</li>
</ul></li>
<li>Whenever you take measurements on related individuals</li>
<li>Whenever you measure subjects or other sampling units repeatedly</li>
</ul>
</section>
<section id="anova-random-effects-of-factors-2" class="level2 smaller vcenter flexbox">
<h2 class="smaller vcenter flexbox anchored" data-anchor-id="anova-random-effects-of-factors-2">ANOVA | Random effects of factors</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-random-effects---test-your-understanding" class="level2">
<h2 class="anchored" data-anchor-id="anova-random-effects---test-your-understanding">ANOVA | Random effects - test your understanding</h2>
<ul>
<li>Factor is sex (Male vs.&nbsp;Female)</li>
<li>Factor is fish tank (10 tanks in an experiment)</li>
<li>Factor is family (measure multiple sibs per family)</li>
<li>Factor is temperature (10 arbitrary temps over natural range)</li>
</ul>
</section>
<section id="anova-caution-about-fixed-vs.-random-effects" class="level2">
<h2 class="anchored" data-anchor-id="anova-caution-about-fixed-vs.-random-effects">ANOVA | Caution about fixed vs.&nbsp;random effects</h2>
<ul>
<li>Using fixed vs.&nbsp;random effects changes the way that statistical tests are performed in ANOVA</li>
<li>Most statistical packages assume that all factors are fixed unless you instruct it otherwise</li>
<li>Designating factors as random takes extra work and probably a read of the manual</li>
<li>In <code>R</code>, <code>lm</code> assumes that all effects are fixed</li>
<li>For random effects, use <code>lme</code> instead (part of the nlme package)</li>
</ul>
</section>
</section>
<section id="means-test-to-compare-levels-of-a-factor" class="level1">
<h1>Means test to compare levels of a factor</h1>
<section id="means-for-greater-than-two-factor-levels" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="means-for-greater-than-two-factor-levels">Means for greater than two factor levels?</h2>
<ul>
<li>The F-ratio test for a single-factor ANOVA tests for any difference among groups.</li>
<li>If we want to understand specific differences, we need further “contrasts”.</li>
<li>Unplanned comparisons (post hoc):
<ul>
<li>Multiple comparisons carried out after the results are obtained.</li>
<li>Used to find where the differences lie (which means differ from which other means)</li>
<li>Comparisons require protection for inflated Type 1 error rates:
<ul>
<li>Tukey tests: compare all pairs of means and control for multiple comparisons</li>
<li>Scheffé contrasts: compare all combinations of means</li>
</ul></li>
</ul></li>
<li>Planned comparisons (a priori):
<ul>
<li>Comparisons between group means that were decided when the experiment was designed (not after the data were in)</li>
<li>Must be few in number to avoid inflating Type 1 error rates</li>
</ul></li>
</ul>
</section>
<section id="planned-a-priori-contrasts" class="level2">
<h2 class="anchored" data-anchor-id="planned-a-priori-contrasts">Planned (a priori) contrasts</h2>
<ul>
<li>A well planned experiment often dictates which comparison of means are of most interest, whereas other comparisons are of no interest.</li>
<li>By restricting the comparisons to just the ones of interest, researchers can mitigate the multiple testing problem associated with post-hoc tests.</li>
<li>Some statisticians argue that, in fact, planned comparisons allow researchers to avoid adjusting p-values all together because each test is therefore unique.</li>
<li>Contrasts can also allow more complicated tests of the relationships among means.</li>
<li>Coding a priori contrasts in R is quite easy and just depends upon writing the right series of coefficient contrasts.</li>
</ul>
</section>
<section id="planned-a-priori-contrasts-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="planned-a-priori-contrasts-1">Planned (a priori) contrasts</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="understand-the-coefficients-table" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="understand-the-coefficients-table">Understand the coefficients table</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.004.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-planned-contrasts" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-planned-contrasts">R INTERLUDE | Planned contrasts</h2>
<ul>
<li>Take the RNAseq data you’ve examined before and create a new four level genotype by combining genotype and microbiota treatment into a single variable</li>
<li>Think about how to do this using <code>dplyr</code> functions.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>RNAseq_Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"RNAseq.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> RNAseq_Data<span class="sc">$</span>categorical_var</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> RNAseq_Data<span class="sc">$</span>continuous_var1</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> RNAseq_Data<span class="sc">$</span>continuous_var2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Set up the a priori contrasts specifically testing one group mean against another</li>
<li>These are just examples - you should figure out the logic of the contrasts</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(x) <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Confirm that the contrasts are orthogonal</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">crossprod</span>(<span class="fu">contrasts</span>(x)), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-planned-contrasts-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-planned-contrasts-1">R INTERLUDE | Planned contrasts</h2>
<ul>
<li>Define the contrast labels</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>rnaseq_data_list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(‘xxx vs. xxx’ <span class="ot">=</span> <span class="dv">1</span>, ‘xxx vs. xxx’ <span class="ot">=</span> <span class="dv">2</span>, ‘xxx vs. xxx’ <span class="ot">=</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Then fit the fixed effect model</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>RNAseq_aov_fixed <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> x)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(RNAseq_aov_fixed)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y <span class="sc">~</span> x)</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(RNAseq_aov_fixed, <span class="at">split =</span> rnaseq_data_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-unplanned-contrasts" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-unplanned-contrasts">R INTERLUDE | Unplanned contrasts</h2>
<ul>
<li>Remember that this is when you had no hypotheses of differences in means in advance</li>
<li>Read in the perchlorate data from Week 3</li>
<li>Let’s assess the effects of the 4 perchlorate levels on T4</li>
<li>Which perchlorate levels differ in their effect on T4?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>perc <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'perchlorate_data.tsv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> perc<span class="sc">$</span>Perchlorate_Level</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">log10</span>(perc<span class="sc">$</span>T4_Hormone_Level)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>MyANOVA <span class="ot">&lt;-</span> <span class="fu">aov</span>(y <span class="sc">~</span> x)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (MyANOVA)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(y <span class="sc">~</span> x)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"multcomp"</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">glht</span>(MyANOVA, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">x =</span> <span class="st">"Tukey"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="multifactor-anova" class="level1">
<h1>Multifactor ANOVA</h1>
<section id="multifactor-anova-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="multifactor-anova-1">Multifactor ANOVA</h2>
<ul>
<li><strong>Nested ANOVA</strong> or nested design
<ul>
<li>factors might be hierarchical - in other words nested - within one another</li>
<li>The sources of variance are therefore hierarchical too</li>
</ul></li>
<li>The <strong>factorial ANOVA</strong> design is the most common experimental design used to investigate more than one treatment variable
<ul>
<li>In a factorial design every combination of treatments from two (or more) treatment variables is investigated.</li>
<li>The main purpose of a factorial design is to evaluate possible interactions between variables.</li>
<li>An <strong>interaction</strong> between two explanatory variables means that the effect of one variable on the response depends on the state of a second variable.</li>
</ul></li>
</ul>
</section>
<section id="multifactor-anova-key-difference-between-nested-and-factorial-designs" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="multifactor-anova-key-difference-between-nested-and-factorial-designs">Multifactor ANOVA | Key difference between nested and factorial designs</h2>
<ul>
<li>Nested designs are hierarchical
<ul>
<li>often contain sub-replicates that are random, uncontrolled, nuisance effects</li>
<li>but the nested factors can be of interest too</li>
</ul></li>
<li>Factorial designs are
<ul>
<li>all pairwise combinations,</li>
<li>and often involve all combinations of factor levels</li>
<li>when each factor is fixed interactions can be assessed</li>
</ul></li>
<li>Completely nested designs therefore have no interaction terms, whereas factorial designs do</li>
<li><strong>Mixed models</strong> can have a combination of fixed and random factors that are more complicated</li>
</ul>
</section>
</section>
<section id="nested-anova" class="level1">
<h1>Nested ANOVA</h1>
<section id="nested-anova-walking-stick-example" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="nested-anova-walking-stick-example">Nested ANOVA | Walking stick example</h2>
<ul>
<li>Example 1: Study of “repeatability” (simple nested design)</li>
<li>The walking stick, <em>Timema cristinae</em>, is a wingless herbivorous insect on plants in chaparral habitats of California.</li>
<li>Nosil and Crespi (2006) measured individuals using digital photographs.</li>
<li>To evaluate measurement repeatability they took two separate photographs of each specimen.</li>
<li>After measuring traits on one set of photographs, they repeated the measurements on the second set.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.001.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nested-anova-walking-stick-example-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nested-anova-walking-stick-example-1">Nested ANOVA | Walking stick example</h2>
<p>Each pair of dots represents the two measurements</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nested-anova-walking-stick-example-2" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nested-anova-walking-stick-example-2">Nested ANOVA | Walking stick example</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nested-anova-anova-table-of-results" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nested-anova-anova-table-of-results">Nested ANOVA | ANOVA Table of Results</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.004.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nesting-logic" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nesting-logic">Nesting Logic</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nesting-equations" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nesting-equations">Nesting equations</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nesting-hypothesis-tests" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nesting-hypothesis-tests">Nesting hypothesis tests</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nesting-ms-calculations" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nesting-ms-calculations">Nesting MS calculations</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="nested-anova-table-of-results" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="nested-anova-table-of-results">Nested ANOVA table of results</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-nested-anova" class="level2">
<h2 class="anchored" data-anchor-id="r-interlude-nested-anova">R INTERLUDE | Nested ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.010.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-nested-anova-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-nested-anova-1">R INTERLUDE | Nested ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>andrew_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'andrew.tsv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span>‘\t<span class="st">')</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="st">head(andrew_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>There are four variables: ‘TREAT’, ‘PATCH’, ‘QUAD’ and ‘ALGAE’</li>
<li>The main effect factor is TREAT</li>
<li>Make a simplified factor called TREAT2, in which 0% and 33% are a level called “low” and 66% and 100% are “high”</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>andrew_data<span class="sc">$</span>TREAT2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(“low”,<span class="dv">40</span>),<span class="fu">rep</span>(“high”,<span class="dv">40</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>The nested factor is PATCH - also need to turn this into a factor</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>andrew_data<span class="sc">$</span>PATCH <span class="ot">&lt;-</span> <span class="fu">factor</span>(andrew_data<span class="sc">$</span>PATCH)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-nested-anova-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-nested-anova-2">R INTERLUDE | Nested ANOVA</h2>
<ul>
<li>In this case, our response variable is ALGAE</li>
<li>Look at the distribution of ALGAE for the two levels of TREAT2 using boxplots based on the patch means, which are the replicates in this case.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>andrew.agg <span class="ot">&lt;-</span> <span class="fu">with</span>(andrew_data, <span class="fu">aggregate</span>(<span class="fu">data.frame</span>(ALGAE), </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">by =</span> <span class="fu">list</span>(<span class="at">TREAT2=</span>TREAT2, <span class="at">PATCH=</span>PATCH), mean)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>andrew.agg <span class="ot">&lt;-</span> <span class="fu">gsummary</span>(andrew_data, <span class="at">groups=</span>andrew_data<span class="sc">$</span>PATCH)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ALGAE <span class="sc">~</span> TREAT2, andrew.agg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Evaluate assumptions based on the boxplots</li>
<li>Is the design balanced (equal numbers of sub-replicates per PATCH)?</li>
</ul>
</section>
<section id="r-interlude-nested-anova-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-nested-anova-3">R INTERLUDE | Nested ANOVA</h2>
<ul>
<li>Run the nested ANOVA:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>nested.aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(ALGAE <span class="sc">~</span> TREAT2 <span class="sc">+</span> <span class="fu">Error</span>(PATCH), <span class="at">data=</span>andrew_data)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nested.aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Do we detect an effect of TREAT2 (high vs low sea urchin density)?</li>
<li>Estimate variance components to assess relative contributions of the random factors</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(<span class="fu">lme</span>(ALGAE <span class="sc">~</span> <span class="dv">1</span>, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> TREAT2<span class="sc">/</span>PATCH, andrew_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Calculate the % of variation due to between-treatment differences vs.&nbsp;due to among patches within treatment differences.</li>
<li>See pg. 302 in Logan if you need help.</li>
<li>What do these variance component estimates tell us???</li>
</ul>
</section>
</section>
<section id="factorial-designs" class="level1">
<h1>Factorial Designs</h1>
<section id="multifactor-anova-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="multifactor-anova-2">Multifactor ANOVA</h2>
<ul>
<li>For example, Relyae (2003) looked at how a moderate dose (1.6mg/L) of a commonly used pesticide, carbaryl (Sevin), affected bullfrog tadpole survival.</li>
<li>In particular, the experiment asked how the effect of carbaryl depended on whether a native predator, the red-spotted newt, was also present.</li>
<li>The newt was caged and could cause no direct harm, but it emitted visual and chemical cues to other tadpoles</li>
<li>The experiment was carried out in 10-L tubs (experimental units), each containing 10 tadpoles.</li>
<li>The four combinations of pesticide treatment (carbaryl vs.&nbsp;water only) and predator treatment (present or absent) were randomly assigned to tubs.</li>
<li>The results showed that survival was high except when pesticide was applied together with the predator.</li>
<li>Thus, the two treatments, predation and pesticide, seem to have interacted.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="multifactor-anova-3" class="level2">
<h2 class="anchored" data-anchor-id="multifactor-anova-3">Multifactor ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.012.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="two-factor-factorial-designs" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="two-factor-factorial-designs">Two Factor Factorial Designs</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="three-factor-factorial-designs" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="three-factor-factorial-designs">Three Factor Factorial Designs</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.014.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="factorial-designs-number-of-replicates" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="factorial-designs-number-of-replicates">Factorial Designs | Number of Replicates</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-1-factorial-anova-both-main-effects-fixed" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="model-1-factorial-anova-both-main-effects-fixed">Model 1 factorial ANOVA | both main effects fixed</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-2-factorial-anova-both-main-effects-fixed" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="model-2-factorial-anova-both-main-effects-fixed">Model 2 factorial ANOVA | both main effects fixed</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-2-factorial-anova-both-main-effects-random" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="model-2-factorial-anova-both-main-effects-random">Model 2 factorial ANOVA | both main effects random</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.018.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-mean-squares-for-a-factorial-model" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="the-mean-squares-for-a-factorial-model">The mean squares for a factorial model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.019.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-f-ratios-for-a-factorial-model" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="the-f-ratios-for-a-factorial-model">The F-ratios for a factorial model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.020.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interpretation-significant-main-and-interaction-effects" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="interpretation-significant-main-and-interaction-effects">Interpretation | significant main and interaction effects</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.021.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="interaction-plots" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="interaction-plots">Interaction plots</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7a.022.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-2-by-2-fixed-effect-factorial-anova" class="level2">
<h2 class="anchored" data-anchor-id="r-interlude-2-by-2-fixed-effect-factorial-anova">R INTERLUDE | 2-by-2 fixed effect factorial ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>rnadata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'RNAseq.tsv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rnadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>continuous response variable and two main effect categorical variables</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>gene <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Gene80</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>microbiota <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Microbiota</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>genotype <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Genotype</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> microbiota)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> genotype)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> microbiota<span class="sc">*</span>genotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fit-the-factorial-linear-model-two-different-ways-to-do-the-same-thing" class="level2">
<h2 class="anchored" data-anchor-id="fit-the-factorial-linear-model-two-different-ways-to-do-the-same-thing">Fit the factorial linear model | two different ways to do the same thing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>rna_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(gene <span class="sc">~</span> microbiota <span class="sc">+</span> genotype <span class="sc">+</span> microbiota<span class="sc">:</span>genotype)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>rna_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(gene <span class="sc">~</span> microbiota<span class="sc">*</span>genotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Examine the fitted model diagnostics and the ANOVA results table</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rna_aov)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rna_aov)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(rna_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>What are the general results of our hypothesis tests?</li>
<li>If there is an interaction, can we understand it by looking at the boxplots?</li>
</ul>
</section>
<section id="r-interlude-2-by-3-fixed-effect-factorial-anova" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="r-interlude-2-by-3-fixed-effect-factorial-anova">R INTERLUDE | 2-by-3 fixed effect factorial ANOVA</h2>
<ul>
<li>Try the following code to produce an interaction plot for the response variable cell count.</li>
<li>In this case there are 2 genotypes and 3 treatment levels.</li>
<li>Download the <code>IntPlot_data</code> file and <code>IntPlot_Example.R</code></li>
<li>Go through the R script, get a feel for what it’s doing, and try to produce and interpret the interaction plot.</li>
</ul>
</section>
</section>
<section id="means-tests-for-multifactorial-anovas" class="level1">
<h1>Means tests for multifactorial ANOVAs</h1>
<section id="means-tests-factor-level-combinations-in-multi-factor-anova" class="level2">
<h2 class="anchored" data-anchor-id="means-tests-factor-level-combinations-in-multi-factor-anova">Means tests | factor level combinations in multi-factor ANOVA</h2>
<ul>
<li>The F-ratio test for a single-factor ANOVA tests for any difference among groups.</li>
<li>If we want to understand specific differences, we need further “contrasts”.</li>
<li>Unplanned comparisons (post hoc)</li>
<li>Planned comparisons (a priori)</li>
<li>Now we need to make ‘pseudo-factors’ that combine our levels of interest</li>
</ul>
</section>
<section id="planned-a-priori-contrasts-2" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="planned-a-priori-contrasts-2">Planned (a priori) contrasts</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction">R INTERLUDE | 2x2 Fixed-Effects Factorial ANOVA contrasts &amp; interaction</h2>
<p>continuous response and two main effect variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>rnadata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'RNAseq.tsv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>gene <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Gene80</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>microbiota <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Microbiota</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>genotype <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Genotype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>make new “pseudo factor,” combining genotype and microbiota</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>gxm <span class="ot">&lt;-</span> <span class="fu">interaction</span>(genotype,microbiota)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(gxm)</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> gxm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>specify the following 2 contrasts</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(gxm) <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-2x2-fixed-effects-factorial-anova-contrasts-interaction-1">R INTERLUDE | 2x2 Fixed-Effects Factorial ANOVA contrasts &amp; interaction</h2>
<p>Fit the factorial linear model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>rna_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(gene <span class="sc">~</span> gxm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Examine the ANOVA table, using supplied contrasts. Figure out the appropriate titles to give them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rna_aov, <span class="at">split =</span> <span class="fu">list</span>(<span class="at">gxm =</span> <span class="fu">list</span>(<span class="st">'xxx'</span><span class="ot">=</span><span class="dv">1</span>,<span class="st">'xxx'</span><span class="ot">=</span><span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What does the contrast summary tell you about the nature of the interaction?</p>
</section>
</section>
<section id="mixed-effect-models-with-unequal-sample-sizes" class="level1 flexbox vcenter">
<h1 class="flexbox vcenter">Mixed effect models with unequal sample sizes</h1>
<section id="attributes-of-mixed-effects-models" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="attributes-of-mixed-effects-models">Attributes of mixed effects models</h2>
<ul>
<li>Linear models that include both fixed and random effects.</li>
<li>The model is split into fixed and random parts:
<ul>
<li>Fixed effects influence mean of the response variable Y.</li>
<li>Random effects influence the variance of Y.</li>
</ul></li>
<li>There is a different error variance for each level of grouping.</li>
<li>Estimation and testing is based on restricted maximum likelihood, which can handle unequal sample size.</li>
<li>P-values for fixed effects are conservative when design unbalanced.</li>
<li>Implemented in the <code>nlme</code> &amp; <code>lme4</code> packages in <code>R</code>.</li>
</ul>
</section>
<section id="assumptions-of-mixed-effects-models" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="assumptions-of-mixed-effects-models">Assumptions of mixed-effects models</h2>
<ul>
<li>Variation within groups follows a normal distribution with equal variance among groups.</li>
<li>Groups are randomly sampled from “population” of groups.</li>
<li>Group means follow a normal distribution.</li>
<li>Measurements within groups are independent.</li>
</ul>
</section>
<section id="hypotheses-for-model-3-anova-factorial-design-with-mixed-effects" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="hypotheses-for-model-3-anova-factorial-design-with-mixed-effects">Hypotheses for Model 3 ANOVA Factorial Design With Mixed Effects</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.003.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="general-r-syntax-for-two-factor-factorial-designs" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="general-r-syntax-for-two-factor-factorial-designs">General R syntax for two factor factorial designs</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.004.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-variance-components-with-2-random-factors-using-lme4" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-variance-components-with-2-random-factors-using-lme4">R INTERLUDE | Variance components with 2 random factors using LME4</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rnadata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'RNAseq.tsv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rnadata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>variables excluding first 5 and last 5 observations</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>gene <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Gene80[<span class="dv">6</span><span class="sc">:</span><span class="dv">75</span>] </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>microbiota <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Microbiota[<span class="dv">6</span><span class="sc">:</span><span class="dv">75</span>]</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>genotype <span class="ot">&lt;-</span> rnadata<span class="sc">$</span>Genotype[<span class="dv">6</span><span class="sc">:</span><span class="dv">75</span>]</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> microbiota)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> genotype)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(gene <span class="sc">~</span> microbiota<span class="sc">*</span>genotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Estimate the variance components using Restricted Maximum Likelihood (REML)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(gene <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> microbiota) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> genotype) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> microbiota<span class="sc">:</span>genotype))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on the REML sd estimates, what are the relative contributions of the factors to total variance in gene expression?</p>
</section>
</section>
<section id="analysis-of-covariance-ancova" class="level1">
<h1>Analysis of Covariance (ANCOVA)</h1>
<section id="brain-body-size-neaderthals-as-compared-to-humans" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="brain-body-size-neaderthals-as-compared-to-humans">Brain &amp; body size | neaderthals as compared to humans</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="brain-body-size-neaderthals-as-compared-to-humans-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="brain-body-size-neaderthals-as-compared-to-humans-1">Brain &amp; body size | neaderthals as compared to humans</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="brain-body-size-neaderthals-as-compared-to-humans-2" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="brain-body-size-neaderthals-as-compared-to-humans-2">Brain &amp; body size | neaderthals as compared to humans</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova">ANCOVA</h2>
<ul>
<li>Analysis of covariance - mixture of regression and ANOVA</li>
<li>Response is still a normally distributed continuous variable</li>
<li>One or more continuous predictor variables (covariates)</li>
<li>Sometimes the covariates are of biological interest</li>
<li>Most often we want to remove unexplained variance</li>
<li>In this way they are similar to a blocking variable in ANOVA</li>
<li>Operationally, ANCOVA is regular ANOVA in which the group and overall means are replaced by group and overall relationships</li>
</ul>
</section>
<section id="ancova-adjusting-for-the-covariate" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-adjusting-for-the-covariate">ANCOVA | Adjusting for the covariate</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-adjusting-for-the-covariate-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-adjusting-for-the-covariate-1">ANCOVA | Adjusting for the covariate</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-linear-model-with-two-covariates" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-linear-model-with-two-covariates">ANCOVA | Linear model with two covariates</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.010.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-factor-and-covariate-hypothesis-tests" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-factor-and-covariate-hypothesis-tests">ANCOVA | Factor and covariate hypothesis tests</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-f-ratio-tests" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-f-ratio-tests">ANCOVA | F ratio tests</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.012.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-assumptions" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-assumptions">ANCOVA | Assumptions</h2>
<ul>
<li>The residuals are normally distributed</li>
<li>The residuals show homoscedasticity of variance</li>
<li>The residuals are independent of one another</li>
<li>The relationship between the response variable and each covariate is linear</li>
<li>Homogeneity of slopes among the groups</li>
<li>Similar covariate ranges among the groups</li>
</ul>
</section>
<section id="ancova-heterogeneous-slopes" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-heterogeneous-slopes">ANCOVA | Heterogeneous slopes</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ancova-heterogeneous-slopes-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-heterogeneous-slopes-1">ANCOVA | Heterogeneous slopes</h2>
<ul>
<li>Problem - adjusting to a mean is difficult or impossible if the slopes are different</li>
<li>In essence, the samples for the groups come from two different populations</li>
<li>A test for homogeneity of slopes can be performed</li>
<li>The assumption is tested by looking for a significant interaction term between the categorical response variables and the covariate(s)</li>
</ul>
</section>
<section id="ancova-non-overlapping-range-of-the-covariate" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="ancova-non-overlapping-range-of-the-covariate">ANCOVA | Non-overlapping range of the covariate</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_7b.014.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="r-interlude-ancova" class="level2">
<h2 class="anchored" data-anchor-id="r-interlude-ancova">R INTERLUDE | ANCOVA</h2>
<ul>
<li>Impacts of sexual activity on male fruitfly longevity</li>
<li>Data from Partridge and Faraquhar (1981)</li>
<li>Longevity of male measured in response to access to
<ul>
<li>no females</li>
<li>one virgin</li>
<li>eight virgins</li>
<li>one mated</li>
<li>eight mated</li>
</ul></li>
<li>The male fruit flies also varied in size</li>
<li>The males were assigned randomly to each of the treatment levels, and then measured thorax length as a covariate</li>
</ul>
</section>
<section id="r-interlude-ancova-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-ancova-1">R INTERLUDE | ANCOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>longevity_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'longevity.csv'</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">','</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(longevity_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>long <span class="ot">&lt;-</span> longevity_data<span class="sc">$</span>LONGEVITY</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>treat <span class="ot">&lt;-</span> longevity_data<span class="sc">$</span>TREATMENT</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>thorax <span class="ot">&lt;-</span> longevity_data<span class="sc">$</span>THORAX</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>check to see if the covariate should be included</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(long <span class="sc">~</span> treat)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(long <span class="sc">~</span> thorax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-ancova-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-ancova-2">R INTERLUDE | ANCOVA</h2>
<ul>
<li>assess assumptions of normality and homogeneity of variance</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">aov</span>(long <span class="sc">~</span> thorax <span class="sc">+</span> treat ), <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>†ry it again with a transformed response variable</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">aov</span>(<span class="fu">log10</span>(long) <span class="sc">~</span> thorax <span class="sc">+</span> treat ), <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>visually assess linearity, homogenetiy of slopes and covariate range equality</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">xyplot</span>(<span class="fu">log10</span>(long) <span class="sc">~</span> thorax <span class="sc">|</span> treat, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"r"</span>, <span class="st">"p"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-ancova-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-ancova-3">R INTERLUDE | ANCOVA</h2>
<ul>
<li>formally test homogenetiy of slopes by testing the interaction term</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(<span class="fu">log10</span>(long) <span class="sc">~</span> thorax<span class="sc">*</span>treat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>formally test covariate range disparity by modeling the effect of the treatments on the covariate</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">aov</span>(thorax <span class="sc">~</span> treat))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>FINALLY, set up contrasts, fit the additive model and visualize the results (pg. 459 and 460 of your Logan book)</li>
<li>Summarize the trends in a nice plot (pg. 461 of your Logan book)</li>
</ul>
</section>
</section>
<section id="design-principles-for-planning-a-good-experiment" class="level1">
<h1>Design principles for planning a good experiment</h1>
<section id="what-is-an-experimental-study" class="level2">
<h2 class="anchored" data-anchor-id="what-is-an-experimental-study">What is an experimental study?</h2>
<ul>
<li>In an experimental study the researcher assigns treatments to units</li>
<li>In an observational study nature does the assigning of treatments to units</li>
<li>The crucial advantage of experiments derives from the random assignment of treatments to units</li>
<li>Random assignment, or randomization, minimizes the influence of confounding variables</li>
<li>Can infer cause and effect more easily</li>
</ul>
</section>
<section id="key-components-of-a-good-experiment" class="level2">
<h2 class="anchored" data-anchor-id="key-components-of-a-good-experiment">Key components of a good experiment</h2>
<p>An experiment is when two or more treatment groups are assigned to research units - randomization - research units are assigne at random to tratment groups in one of several ways. In particular neither the researcher or the unit should decide who gets the treatment - control - different treatemnt groups are as identical as posible, ecept for the specfic treatment they receive. A lack of controls can lead to confounding variables. Note the placebo effect. - replication - repeated to be able to estimate sampling variation. Different types of random sampling depending upon the nature of the experiment - blinding - single or better yet double blind - neither the subject nor the</p>
</section>
<section id="mount-everest-example" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="mount-everest-example">Mount Everest example</h2>
<p>Survival of climbers of Mount Everest is higher for individuals taking supplemental oxygen than those who don’t.</p>
<p><strong>Why?</strong></p>
</section>
<section id="mount-everest-example-1" class="level2">
<h2 class="anchored" data-anchor-id="mount-everest-example-1">Mount Everest example</h2>
<ul>
<li>One possibility is that supplemental oxygen (explanatory variable) really does cause higher survival (response variable).</li>
<li>The other is that the two variables are associated because other variables affect both supplemental oxygen and survival.</li>
<li>Use of supplemental oxygen might be a benign indicator of a greater overall preparedness of the climbers that use it.</li>
<li>Variables (like preparedness) that distort the causal relationship between the measured variables of interest (oxygen use and survival) are called <strong>confounding variables</strong></li>
<li>They are correlated with the variable of interest, and therefore preventing a decision about cause and effect.</li>
<li>With random assignment, no confounding variables will be associated with treatment except by chance.</li>
</ul>
</section>
<section id="clinical-trials" class="level2">
<h2 class="anchored" data-anchor-id="clinical-trials">Clinical Trials</h2>
<ul>
<li>The gold standard of experimental designs is the <strong>clinical trial</strong></li>
<li>Experimental design in all areas of biology have been informed by procedures used in clinical trials</li>
<li>A clinical trial is an experimental study in which two or more treatments are assigned to human subjects</li>
<li>The design of clinical trials has been refined because the cost of making a mistake with human subjects is so high</li>
<li>Experiments on nonhuman subjects are simply called “laboratory experiments”or “field experiments”</li>
</ul>
</section>
<section id="example-of-a-clinical-trial" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="example-of-a-clinical-trial">Example of a clinical trial</h2>
<ul>
<li>Transmission of the HIV-1 virus via sex workers contributes to the rapid spread of AIDS in Africa</li>
<li>The spermicide nonoxynol-9 had shown <em>in vitro</em> activity against HIV-1, which motivated a clinical trial by van Damme et al.&nbsp;(2002).</li>
<li>They tested whether a vaginal gel containing the chemical would reduce the risk of acquiring the disease by female sex workers.</li>
<li>Data were gathered on a volunteer sample of 765 HIV-free sex-workers in six clinics in Asia and Africa.</li>
<li>Two gel treatments were assigned randomly to women at each clinic.</li>
<li>One gel contained nonoxynol-9 and the other a placebo.</li>
<li>Neither the subjects nor the researchers making observations at the clinics knew who received the treatment and who got the placebo.</li>
</ul>
</section>
<section id="example-of-a-clinical-trial-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="example-of-a-clinical-trial-1">Example of a clinical trial</h2>
<p><br></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="design-components-of-a-clinical-trial" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="design-components-of-a-clinical-trial">Design components of a clinical trial</h2>
<p>The goal of experimental design is to eliminate bias and to reduce sampling error when estimating and testing effects of one variable on another.</p>
<ul>
<li>To reduce bias, the experiment included:
<ul>
<li><strong>Simultaneous control group</strong>: study included both the treatment of interest and a control group (the women receiving the placebo).</li>
<li><strong>Randomization</strong>: treatments were randomly assigned to women at each clinic.</li>
<li><strong>Blinding</strong>: neither the subjects nor the clinicians knew which women were assigned which treatment.</li>
</ul></li>
</ul>
</section>
<section id="design-components-of-a-clinical-trial-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="design-components-of-a-clinical-trial-1">Design components of a clinical trial</h2>
<ul>
<li>To reduce the effects of sampling error, the experiment included:
<ul>
<li><strong>Replication</strong>: study was carried out on multiple independent subjects.</li>
<li><strong>Balance</strong>: number of women was nearly equal in the two groups at every clinic.</li>
<li><strong>Blocking</strong>: subjects were grouped according to the clinic they attended, yielding multiple repetitions of the same experiment in different settings (“blocks”).</li>
</ul></li>
</ul>
</section>
<section id="simultaneous-control-group" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="simultaneous-control-group">Simultaneous control group</h2>
<ul>
<li>In clinical trials either a placebo or the currently accepted treatment should be provided.</li>
<li>In experiments requiring intrusive methods to administer treatment, such as
<ul>
<li>injections</li>
<li>surgery</li>
<li>restraint</li>
<li>confinement</li>
</ul></li>
<li>the control subjects should be perturbed in the same way as the other subjects, except for the treatment itself, as far as ethical considerations permit.</li>
</ul>
</section>
<section id="simultaneous-control-group-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="simultaneous-control-group-1">Simultaneous control group</h2>
<ul>
<li>The “sham operation”, in which surgery is carried out without the experimental treatment itself, is an example.</li>
<li>In field experiments, applying a treatment of interest may physically disturb the plots receiving it and the surrounding areas, perhaps by trampling the ground by the researchers.</li>
<li>Ideally, the same disturbance should be applied to the control plots.</li>
</ul>
</section>
<section id="randomization" class="level2">
<h2 class="anchored" data-anchor-id="randomization">Randomization</h2>
<ul>
<li>The researcher should randomize assignment of treatments to units or subjects</li>
<li>Chance rather than conscious or unconscious decision determines which units end up receiving the treatment and which the control</li>
<li>A completely randomized design is one in which treatments are assigned to all units by randomization</li>
</ul>
</section>
<section id="randomization-1" class="level2">
<h2 class="anchored" data-anchor-id="randomization-1">Randomization</h2>
<ul>
<li>Randomization breaks the association between possible confounding variables and the explanatory variable</li>
<li>Randomization doesn’t eliminate the variation contributed by confounding variables, only their correlation with treatment</li>
<li>Randomization ensures that variation from confounding variables is similar between the different treatment groups.</li>
</ul>
</section>
<section id="randomization-2" class="level2">
<h2 class="anchored" data-anchor-id="randomization-2">Randomization</h2>
<ul>
<li>Randomization should be carried out using a random process:
<ul>
<li>List all n subjects, one per row, in a computer spreadsheet.</li>
<li>Use the computer to give each individual a random number.</li>
<li>Assign treatment A to those subjects receiving the lowest numbers and treatment B to those with the highest numbers.</li>
</ul></li>
<li>Other ways of assigning treatments to subjects are almost always inferior because they do not eliminate the effects of confounding variables.</li>
<li>“Haphazard” assignment, in which the researcher chooses a treatment while trying to make it random, has repeatedly been shown to be non-random and prone to bias.</li>
</ul>
</section>
<section id="randomization-types" class="level2">
<h2 class="anchored" data-anchor-id="randomization-types">Randomization Types</h2>
<ul>
<li><p>Completely randomized design - all subjects are placed to treatment or control with equal probability</p></li>
<li><p>Randomized block - first broken into gropus (e.g.&nbsp;age or gender) then assigend to tratment groups at random</p></li>
<li><p>Mathced pair design - sujects are paired by similarity before being randoly assigned to treatment groups</p></li>
</ul>
</section>
<section id="sampling-approaches" class="level2">
<h2 class="anchored" data-anchor-id="sampling-approaches">Sampling approaches</h2>
<ul>
<li>simple random sample - every sample has equal probability of being chosen</li>
<li>stratified sample - divvided into groups then a simple random sample are taken from each</li>
<li>cluster sample - divided into similar gropu, usually naturally occure, a simple random samples of clusters is then taken and very member of the cluster is included in the sample</li>
<li>multistage sampling - combines the above. First clusters are random sampled. Second random samples are take from each. Then process is repeated</li>
<li>systematic sample - members of a sample are chosen in a pre-determiend ways. e.g Choose everyth 20th person coming into a store</li>
</ul>
</section>
<section id="bias-in-experiments" class="level2">
<h2 class="anchored" data-anchor-id="bias-in-experiments">Bias in experiments</h2>
<ul>
<li>lack of control</li>
<li>lac of blinidng</li>
<li>lack of reandomiztaion</li>
</ul>
</section>
<section id="bias-in-surveys" class="level2">
<h2 class="anchored" data-anchor-id="bias-in-surveys">Bias in surveys</h2>
<ul>
<li>samplign bias - not all members of the ppulation or cluster are equally likely</li>
<li>non-response bias - xxx</li>
<li>asymmetric questions - xxx</li>
<li>social desirability bias - xxx</li>
</ul>
</section>
<section id="statistical-sampling" class="level2">
<h2 class="anchored" data-anchor-id="statistical-sampling">Statistical sampling</h2>
<ul>
<li>censuse - collect ifnormation from a completel population of interest</li>
<li>sampling bad ways
<ul>
<li>anecdotal evidence</li>
<li>conveience sample - easily acessible (say students in a class</li>
<li>Random sample - a random process is used, and the point is to avoid bias</li>
</ul></li>
</ul>
<p>)</p>
</section>
<section id="blinding" class="level2">
<h2 class="anchored" data-anchor-id="blinding">Blinding</h2>
<ul>
<li>Blinding is the process of concealing information from participants (sometimes including researchers) about which subjects receive which treatment.</li>
<li>Blinding prevents subjects and researchers from changing their behavior, consciously or unconsciously, as a result of knowing which treatment they were receiving or administering.</li>
<li>For example, studies showing that acupuncture has a significant effect on back pain are limited to those without blinding (Ernst and White 1998).</li>
</ul>
</section>
<section id="blinding-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="blinding-1">Blinding</h2>
<ul>
<li>In a single-blind experiment, the subjects are unaware of the treatment that they have been assigned.</li>
<li>Treatments must be indistinguishable to subjects, which prevents them from responding differently according to knowledge of treatment.</li>
<li>Blinding can also be a concern in non-human studies where animals respond to stimuli</li>
</ul>
</section>
<section id="blinding-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="blinding-2">Blinding</h2>
<ul>
<li>In a double-blind experiment the researchers administering the treatments and measuring the response are also unaware of which subjects are receiving which treatments
<ul>
<li>Researchers sometimes have pet hypotheses, and they might treat experimental subjects in different ways depending on their hopes for the outcome</li>
<li>Many response variables are difficult to measure and require some subjective interpretation, which makes the results prone to a bias</li>
<li>Researchers are naturally more interested in the treated subjects than the control subjects, and this increased attention can itself result in improved response</li>
</ul></li>
</ul>
</section>
<section id="blinding-3" class="level2">
<h2 class="anchored" data-anchor-id="blinding-3">Blinding</h2>
<ul>
<li>Reviews of medical studies have revealed that studies carried out without double- blinding exaggerated treatment effects by 16% on average compared with studies carried out with double-blinding (Jüni et al.&nbsp;2001).</li>
<li>Experiments on non–human subjects are also prone to bias from lack of blinding.</li>
</ul>
</section>
<section id="blinding-4" class="level2">
<h2 class="anchored" data-anchor-id="blinding-4">Blinding</h2>
<ul>
<li>Bebarta et al.(2003) reviewed 290 two-treatment experiments carried out on animals or on cell lines. The odds of detecting a positive effect of treatment were more than threefold higher in studies without blinding than in studies with blinding.</li>
<li>Blinding can be incorporated into experiments on nonhuman subjects using coded tags that identify the subject to a “blind” observer without revealing the treatment (and who measures units from different treatments in random order).</li>
</ul>
</section>
<section id="replication" class="level2">
<h2 class="anchored" data-anchor-id="replication">Replication</h2>
<ul>
<li>The goal of experiments is to estimate and test treatment effects against the background of variation between individuals (“noise”) caused by other variables</li>
<li>One way to reduce noise is to make the experimental conditions constant</li>
<li>In field experiments, however, highly constant experimental conditions might not be feasible nor desirable</li>
<li>By limiting the conditions of an experiment, we also limit the generality of the results</li>
<li>Another way to make treatment effects stand out is to include extreme treatments and to replicate the data.</li>
</ul>
</section>
<section id="replication-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="replication-1">Replication</h2>
<ul>
<li>Replication is the assignment of each treatment to multiple, independent experimental units.</li>
<li>Without replication, we would not know whether response differences were due to the treatments or just chance differences between the treatments caused by other factors.</li>
<li>Studies that use more units (i.e.&nbsp;that have larger sample sizes) will have smaller standard errors and a higher probability of getting the correct answer from a hypothesis test.</li>
<li>Larger samples mean more information, and more information means better estimates and more powerful tests.</li>
</ul>
</section>
<section id="replication-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="replication-2">Replication</h2>
<ul>
<li>Replication is not about the number of plants or animals used, but the number of independent units in the experiment. An “experimental unit” is the independent unit to which treatments are assigned.</li>
<li>The figure shows three experimental designs used to compare plant growth under two temperature treatments (indicated by the shading of the pots). The first two designs are un-replicated.</li>
</ul>
</section>
<section id="pseudoreplication" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="pseudoreplication">Pseudoreplication</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="balance" class="level2">
<h2 class="anchored" data-anchor-id="balance">Balance</h2>
<ul>
<li>A study design is balanced if all treatments have the same sample size.</li>
<li>Conversely, a design is unbalanced if there are unequal sample sizes between treatments.</li>
<li>Balance is a second way to reduce the influence of sampling error on estimation and hypothesis testing.</li>
<li>To appreciate this, look again at the equation for the standard error of the difference between two treatment means.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.007.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="balance-1" class="level2">
<h2 class="anchored" data-anchor-id="balance-1">Balance</h2>
<ul>
<li>For a fixed total number of experimental units, n1 + n2, the standard error is smallest when n1 and n2 are equal.</li>
<li>Balance has other benefits. For example, ANOVA is more robust to departures from the assumption of equal variances when designs are balanced or nearly so.</li>
</ul>
</section>
<section id="blocking" class="level2">
<h2 class="anchored" data-anchor-id="blocking">Blocking</h2>
<ul>
<li>Blocking is the grouping of experimental units that have similar properties. Within each block, treatments are randomly assigned to experimental units.</li>
<li>Blocking essentially repeats the same, completely randomized experiment multiple times, once for each block.</li>
<li>Differences between treatments are only evaluated within blocks, and in this way the component of variation arising from differences between blocks is discarded.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="blocking-paired-designs" class="level2">
<h2 class="anchored" data-anchor-id="blocking-paired-designs">Blocking | Paired designs</h2>
<ul>
<li>For example, consider the design choices for a two-treatment experiment to investigate the effect of clear cutting on salamander density.</li>
<li>In the completely randomized (“two-sample”) design we take a random sample of forest plots from the population and then randomly assign each plot to either the clear-cut treatment or the no clear-cut treatment.</li>
<li>In the paired design we take a random sample of forest plots and clear-cut a randomly chosen half of each plot, leaving the other half untouched.</li>
</ul>
</section>
<section id="blocking-paired-designs-1" class="level2">
<h2 class="anchored" data-anchor-id="blocking-paired-designs-1">Blocking | Paired designs</h2>
<ul>
<li>In the paired design, measurements on adjacent plot-halves are not independent. This is because they are likely to be similar in soil, water, sunlight, and other conditions that affect the number of salamanders.</li>
<li>As a result, we must analyze paired data differently than when every plot is independent of all the others, as in the case of the two-sample design.</li>
<li>Paired design is usually more powerful than completely randomized design because it controls for a lot of the extraneous variation between plots or sampling units that sometimes obscures the effects we are looking for.</li>
</ul>
</section>
<section id="blocking-paired-designs-2" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="blocking-paired-designs-2">Blocking | Paired designs</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_6a.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="blocking-randomized-complete-block-design" class="level2">
<h2 class="anchored" data-anchor-id="blocking-randomized-complete-block-design">Blocking | Randomized complete block design</h2>
<ul>
<li>RCB design is analogous to the paired design, but may have more than two treatments. Each treatment is applied once to every block.</li>
<li>As in the paired design, treatment effects in a randomized block design are measured by differences between treatments exclusively within blocks.</li>
<li>By accounting for some sources of sampling variation blocking can make differences between treatments stand out.</li>
<li>Blocking is worthwhile if units within blocks are relatively homogeneous, apart from treatment effects, and units belonging to different blocks vary because of environmental or other differences.</li>
</ul>
</section>
<section id="what-if-you-cant-do-experiments" class="level2">
<h2 class="anchored" data-anchor-id="what-if-you-cant-do-experiments">What if you can’t do experiments?</h2>
<ul>
<li>Experimental studies are not always feasible, in which case we must fall back upon observational studies.</li>
<li>The best observational studies incorporate as many of the features of good experimental design as possible to minimize bias (e.g., blinding) and the impact of sampling error (e.g., replication, balance, blocking, and even extreme treatments) except for one: randomization.</li>
<li>Randomization is out of the question, because in an observational study the researcher does not assign treatments to subjects.</li>
<li>Two strategies are used to limit the effects of confounding variables on a difference between treatments in a controlled observational study: matching; and adjusting for known confounding variables (covariates).</li>
</ul>
</section>
</section>
<section id="how-to-present-your-statistical-results" class="level1">
<h1>How to present your statistical results</h1>
<section id="style-of-a-results-section" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="style-of-a-results-section">Style of a results section</h2>
<ul>
<li>Write the text of the Results section concisely and objectively.</li>
<li>The passive voice will likely dominate here, but use the active voice as much as possible.</li>
<li>Use the past tense.</li>
<li>Avoid repetitive paragraph structures. Do not interpret the data here.</li>
</ul>
</section>
<section id="function-of-a-results-section" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="function-of-a-results-section">Function of a results section</h2>
<ul>
<li><p>The function is to objectively present your key results, without interpretation, in an orderly and logical sequence using both text and illustrative materials (Tables and Figures).</p></li>
<li><p>The results section always begins with text, reporting the key results and referring to figures and tables as you proceed.</p></li>
<li><p>The text of the Results section should be crafted to follow this sequence and highlight the evidence needed to answer the questions/hypotheses you investigated.</p></li>
<li><p>Important negative results should be reported, too. Authors usually write the text of the results section based upon the sequence of Tables and Figures.</p></li>
</ul>
</section>
<section id="summaries-of-the-statistical-analyses" class="level2 smaller flexbox vcenter">
<h2 class="smaller flexbox vcenter anchored" data-anchor-id="summaries-of-the-statistical-analyses">Summaries of the statistical analyses</h2>
<p>May appear either in the text (usually parenthetically) or in the relevant Tables or Figures (in the legend or as footnotes to the Table or Figure). Each Table and Figure must be referenced in the text portion of the results, and you must tell the reader what the key result(s) is that each Table or Figure conveys.</p>
<ul>
<li>Tables and Figures are assigned numbers separately and in the sequence that you will refer to them from the text.
<ul>
<li>The first Table you refer to is Table 1, the next Table 2 and so forth.</li>
<li>Similarly, the first Figure is Figure 1, the next Figure 2, etc.</li>
</ul></li>
<li>Each Table or Figure must include a brief description of the results being presented and other necessary information in a legend.
<ul>
<li>Table legends go above the Table; tables are read from top to bottom.</li>
<li>Figure legends go below the figure; figures are usually viewed from bottom to top.</li>
</ul></li>
<li>When referring to a Figure from the text, “Figure” is abbreviated as Fig.,e.g., (Fig. 1. Table is never abbreviated, e.g., Table 1.</li>
</ul>
</section>
<section id="example" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="example">Example</h2>
<p>For example, suppose you asked the question, “Is the average height of male students the same as female students in a pool of randomly selected Biology majors?” You would first collect height data from large random samples of male and female students. You would then calculate the descriptive statistics for those samples (mean, SD, n, range, etc) and plot these numbers. Suppose you found that male Biology majors are, on average, 12.5 cm taller than female majors; this is the answer to the question. Notice that the outcome of a statistical analysis is not a key result, but rather an analytical tool that helps us understand what is our key result.</p>
</section>
<section id="differences-directionality-and-magnitude" class="level2 smaller flexbox vcenter">
<h2 class="smaller flexbox vcenter anchored" data-anchor-id="differences-directionality-and-magnitude">Differences, directionality, and magnitude</h2>
<ul>
<li><p>Report your results so as to provide as much information as possible to the reader about the nature of differences or relationships.</p></li>
<li><p>For example, if you are testing for differences among groups, and you find a significant difference, it is not sufficient to simply report that “groups A and B were significantly different”. How are they different? How much are they different?</p></li>
<li><p>It is much more informative to say something like, “Group A individuals were 23% larger than those in Group B”, or, “Group B pups gained weight at twice the rate of Group A pups.”</p></li>
<li><p>Report the direction of differences (greater, larger, smaller, etc) and the magnitude of differences (% difference, how many times, etc.) whenever possible.</p></li>
</ul>
</section>
<section id="statistical-results-in-text" class="level2 smaller flexbox vcenter">
<h2 class="smaller flexbox vcenter anchored" data-anchor-id="statistical-results-in-text">Statistical results in text</h2>
<ul>
<li><p>Statistical test summaries (test name, p-value) are usually reported parenthetically in conjunction with the biological results they support. This parenthetical reference should include the statistical test used, the value, degrees of freedom and the level of significance.</p></li>
<li><p>For example, if you found that the mean height of male Biology majors was significantly larger than that of female Biology majors, you might report this result (in blue) and your statistical conclusion (shown in red) as follows:</p>
<ul>
<li>“Males (180.5 ± 5.1 cm; n=34) averaged 12.5 cm taller than females (168 ± 7.6 cm; n=34) in the pool of Biology majors (two-sample t-test, t = 5.78, 33 d.f., p &lt; 0.001).”</li>
</ul></li>
<li><p>If the summary statistics are shown in a figure, the sentence above need not report them specifically, but must include a reference to the figure where they may be seen:</p>
<ul>
<li>“Males averaged 12.5 cm taller than females in the pool of Biology majors (two-sample t-test, t = 5.78, 33 d.f., p &lt; 0.001; Fig. 1).”</li>
</ul></li>
</ul>
</section>
<section id="statistical-results-in-text-1" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="statistical-results-in-text-1">Statistical results in text</h2>
<ul>
<li>Always enter the appropriate units when reporting data or summary statistics.
<ul>
<li>for an individual value you would write, “the mean length was 10 cm”, or, “the maximum time was 140 min.”</li>
<li>When including a measure of variability, place the unit after the error value, e.g., “…was 10 ± 2.3 m”.</li>
<li>Likewise place the unit after the last in a series of numbers all having the same unit. For example: “lengths of 5, 10, 15, and 20 m”, or “no differences were observed after 2, 4, 6, or 8 min. of incubation”.</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>