<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 7a - Statistics for Bioengineering – BioEngineering Statistics Winter 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f7fe251563e67c05764dc4775ff48cfc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Winter 2026</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Homework.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#this-week" id="toc-this-week" class="nav-link active" data-scroll-target="#this-week">This week</a></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance">Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#an-example---irises" id="toc-an-example---irises" class="nav-link" data-scroll-target="#an-example---irises">An Example - Irises</a></li>
  <li><a href="#anovas-and-hypotheses" id="toc-anovas-and-hypotheses" class="nav-link" data-scroll-target="#anovas-and-hypotheses">ANOVAs and Hypotheses</a></li>
  <li><a href="#anova-similar-to-regression" id="toc-anova-similar-to-regression" class="nav-link" data-scroll-target="#anova-similar-to-regression">ANOVA | similar to regression</a></li>
  <li><a href="#anova" id="toc-anova" class="nav-link" data-scroll-target="#anova">ANOVA</a></li>
  <li><a href="#assumptions-of-anova" id="toc-assumptions-of-anova" class="nav-link" data-scroll-target="#assumptions-of-anova">Assumptions of ANOVA</a></li>
  <li><a href="#differences-in-iris-sepal-length" id="toc-differences-in-iris-sepal-length" class="nav-link" data-scroll-target="#differences-in-iris-sepal-length">Differences in Iris sepal length</a></li>
  <li><a href="#means-estimates-using-lm" id="toc-means-estimates-using-lm" class="nav-link" data-scroll-target="#means-estimates-using-lm">Means estimates using <code>lm</code></a></li>
  </ul></li>
  <li><a href="#testing-what-levels-of-a-factor-variable-differ-from-one-another" id="toc-testing-what-levels-of-a-factor-variable-differ-from-one-another" class="nav-link" data-scroll-target="#testing-what-levels-of-a-factor-variable-differ-from-one-another">Testing what levels of a factor variable differ from one another</a>
  <ul class="collapse">
  <li><a href="#means-for-greater-than-two-factor-levels" id="toc-means-for-greater-than-two-factor-levels" class="nav-link" data-scroll-target="#means-for-greater-than-two-factor-levels">Means for greater than two factor levels?</a></li>
  <li><a href="#post-hoc-comparisons" id="toc-post-hoc-comparisons" class="nav-link" data-scroll-target="#post-hoc-comparisons"><em>Post Hoc</em> Comparisons</a></li>
  <li><a href="#irises" id="toc-irises" class="nav-link" data-scroll-target="#irises">Irises</a></li>
  <li><a href="#irises-1" id="toc-irises-1" class="nav-link" data-scroll-target="#irises-1">Irises</a></li>
  <li><a href="#irises-2" id="toc-irises-2" class="nav-link" data-scroll-target="#irises-2">Irises</a></li>
  <li><a href="#biomarker-data" id="toc-biomarker-data" class="nav-link" data-scroll-target="#biomarker-data">Biomarker Data</a></li>
  <li><a href="#biomarker-data-1" id="toc-biomarker-data-1" class="nav-link" data-scroll-target="#biomarker-data-1">Biomarker Data</a></li>
  <li><a href="#biomarker-data-2" id="toc-biomarker-data-2" class="nav-link" data-scroll-target="#biomarker-data-2">Biomarker Data</a></li>
  <li><a href="#biomarker-data-3" id="toc-biomarker-data-3" class="nav-link" data-scroll-target="#biomarker-data-3">Biomarker Data</a></li>
  <li><a href="#lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set" id="toc-lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set" class="nav-link" data-scroll-target="#lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set">Let’s practice - using the categorical predictor variables in the stickleback data set</a></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a></li>
  <li><a href="#tukeys-posthoc" id="toc-tukeys-posthoc" class="nav-link" data-scroll-target="#tukeys-posthoc">Tukey’s posthoc</a></li>
  <li><a href="#plot-of-the-different-levels" id="toc-plot-of-the-different-levels" class="nav-link" data-scroll-target="#plot-of-the-different-levels">Plot of the different levels</a></li>
  </ul></li>
  <li><a href="#planned-a-priori-contrasts" id="toc-planned-a-priori-contrasts" class="nav-link" data-scroll-target="#planned-a-priori-contrasts">Planned (<em>a priori</em>) contrasts</a>
  <ul class="collapse">
  <li><a href="#planned-a-priori-contrasts-1" id="toc-planned-a-priori-contrasts-1" class="nav-link" data-scroll-target="#planned-a-priori-contrasts-1">Planned (<em>a priori</em>) contrasts</a></li>
  <li><a href="#planned-a-priori-contrasts-2" id="toc-planned-a-priori-contrasts-2" class="nav-link" data-scroll-target="#planned-a-priori-contrasts-2">Planned (a priori) contrasts</a></li>
  <li><a href="#r-interlude-planned-contrasts" id="toc-r-interlude-planned-contrasts" class="nav-link" data-scroll-target="#r-interlude-planned-contrasts">R INTERLUDE | Planned contrasts</a></li>
  <li><a href="#r-interlude-planned-contrasts-1" id="toc-r-interlude-planned-contrasts-1" class="nav-link" data-scroll-target="#r-interlude-planned-contrasts-1">R INTERLUDE | Planned contrasts</a></li>
  </ul></li>
  <li><a href="#fixed-vs.-random-effects-in-anova" id="toc-fixed-vs.-random-effects-in-anova" class="nav-link" data-scroll-target="#fixed-vs.-random-effects-in-anova">Fixed vs.&nbsp;Random Effects in ANOVA</a>
  <ul class="collapse">
  <li><a href="#anova-fixed-effects-of-factors" id="toc-anova-fixed-effects-of-factors" class="nav-link" data-scroll-target="#anova-fixed-effects-of-factors">ANOVA | Fixed effects of factors</a></li>
  <li><a href="#anova-random-effects-of-factors" id="toc-anova-random-effects-of-factors" class="nav-link" data-scroll-target="#anova-random-effects-of-factors">ANOVA | Random effects of factors</a></li>
  <li><a href="#anova-random-effects-of-factors-1" id="toc-anova-random-effects-of-factors-1" class="nav-link" data-scroll-target="#anova-random-effects-of-factors-1">ANOVA | Random effects of factors</a></li>
  <li><a href="#anova-random-effects-of-factors-2" id="toc-anova-random-effects-of-factors-2" class="nav-link" data-scroll-target="#anova-random-effects-of-factors-2">ANOVA | Random effects of factors</a></li>
  <li><a href="#anova-caution-about-fixed-vs.-random-effects" id="toc-anova-caution-about-fixed-vs.-random-effects" class="nav-link" data-scroll-target="#anova-caution-about-fixed-vs.-random-effects">ANOVA | Caution about fixed vs.&nbsp;random effects</a></li>
  <li><a href="#anova-r-interlude" id="toc-anova-r-interlude" class="nav-link" data-scroll-target="#anova-r-interlude">ANOVA | R interlude</a></li>
  <li><a href="#anova-r-interlude-1" id="toc-anova-r-interlude-1" class="nav-link" data-scroll-target="#anova-r-interlude-1">ANOVA | R interlude</a></li>
  </ul></li>
  <li><a href="#how-to-present-your-statistical-results" id="toc-how-to-present-your-statistical-results" class="nav-link" data-scroll-target="#how-to-present-your-statistical-results">How to present your statistical results</a>
  <ul class="collapse">
  <li><a href="#style-of-a-results-section" id="toc-style-of-a-results-section" class="nav-link" data-scroll-target="#style-of-a-results-section">Style of a results section</a></li>
  <li><a href="#function-of-a-results-section" id="toc-function-of-a-results-section" class="nav-link" data-scroll-target="#function-of-a-results-section">Function of a results section</a></li>
  <li><a href="#summaries-of-the-statistical-analyses" id="toc-summaries-of-the-statistical-analyses" class="nav-link" data-scroll-target="#summaries-of-the-statistical-analyses">Summaries of the statistical analyses</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  <li><a href="#differences-directionality-and-magnitude" id="toc-differences-directionality-and-magnitude" class="nav-link" data-scroll-target="#differences-directionality-and-magnitude">Differences, directionality, and magnitude</a></li>
  <li><a href="#statistical-results-in-text" id="toc-statistical-results-in-text" class="nav-link" data-scroll-target="#statistical-results-in-text">Statistical results in text</a></li>
  <li><a href="#statistical-results-in-text-1" id="toc-statistical-results-in-text-1" class="nav-link" data-scroll-target="#statistical-results-in-text-1">Statistical results in text</a></li>
  </ul></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week7a.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 7a - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.2
✔ purrr     1.2.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gt' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="this-week" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="this-week">This week</h2>
<ul>
<li><p>Finish One Factor Analysis of Variance (ANOVA)</p>
<ul>
<li><p>post-hoc means comparisons</p></li>
<li><p><em>a priori</em> means tests</p></li>
<li><p>fixed vs.&nbsp;random effects in ANOVA</p></li>
</ul></li>
<li><p>How to report statistics in papers</p></li>
<li><p>Multifactor ANOVA</p>
<ul>
<li>Factorial</li>
<li>Nested</li>
</ul></li>
<li><p>Key principles of experimental design</p></li>
<li><p>Generalized Linear Mixed Models (GLMMs)</p></li>
</ul>
</section>
<section id="analysis-of-variance" class="level1">
<h1>Analysis of Variance</h1>
<section id="an-example---irises" class="level2">
<h2 class="anchored" data-anchor-id="an-example---irises">An Example - Irises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species, <span class="at">vertical=</span>T, <span class="at">method=</span><span class="st">"jitter"</span>,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab=</span><span class="st">"sepal length"</span>, <span class="at">xlab=</span><span class="st">"species"</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">cex=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week7a_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anovas-and-hypotheses" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anovas-and-hypotheses">ANOVAs and Hypotheses</h2>
<p><span class="math display">\[ H_0: \mu(\text{versicolor_length"}) = \mu(\text{setosa_length}) = \mu(\text{virginica_length})  \]</span><br>
</p>
<p><span class="math display">\[ H_a: \mu(\text{versicolor_length"}) \neq \mu(\text{setosa_length}) \neq \mu(\text{virginica_length}) \]</span></p>
</section>
<section id="anova-similar-to-regression" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova-similar-to-regression">ANOVA | similar to regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova" class="level2 vcenter flexbox">
<h2 class="vcenter flexbox anchored" data-anchor-id="anova">ANOVA</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_5b.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="assumptions-of-anova" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-of-anova">Assumptions of ANOVA</h2>
<ol type="1">
<li><p>The response variable (y) is approximately normal in all groups (factor levels)</p>
<ul>
<li>Deviation from normality O.K. if sample sizes and variances across groups are approximately equal</li>
<li>Most statisticians think that this is within a factor of 2 or 3</li>
</ul></li>
<li><p>Variances equal across groups</p></li>
<li><p>Observations within a group are independent</p>
<ul>
<li><p>randomly sampled</p></li>
<li><p>no structuring of the sampling (but we’ll handle this later)</p></li>
</ul></li>
</ol>
</section>
<section id="differences-in-iris-sepal-length" class="level2">
<h2 class="anchored" data-anchor-id="differences-in-iris-sepal-length">Differences in Iris sepal length</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>iris_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Sepal.Length <span class="sc">~</span> Species, iris)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(iris_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Sepal.Length
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species     2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals 147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Would report this as</li>
</ul>
<p><span class="math display">\[F_{2, 147} = 119.26; p &lt;2.2*10^{-16}\]</span></p>
</section>
<section id="means-estimates-using-lm" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="means-estimates-using-lm">Means estimates using <code>lm</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = iris$Sepal.Length ~ iris$Species)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              5.0060     0.0728  68.762  &lt; 2e-16 ***
iris$Speciesversicolor   0.9300     0.1030   9.033 8.77e-16 ***
iris$Speciesvirginica    1.5820     0.1030  15.366  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="testing-what-levels-of-a-factor-variable-differ-from-one-another" class="level1">
<h1>Testing what levels of a factor variable differ from one another</h1>
<section id="means-for-greater-than-two-factor-levels" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="means-for-greater-than-two-factor-levels">Means for greater than two factor levels?</h2>
<ul>
<li>The F-ratio test for a single-factor ANOVA tests for any difference among groups.</li>
<li>If we want to understand specific differences, we need further “contrasts”.</li>
<li>Unplanned comparisons (post hoc):
<ul>
<li>Multiple comparisons carried out after the results are obtained.</li>
<li>Used to find which means differ from which other means</li>
<li>Comparisons require protection for inflated Type 1 error rates:</li>
</ul></li>
<li>Planned comparisons (<em>a priori</em>):
<ul>
<li>Comparisons between group means that were decided when the experiment was designed (not after the data were in)</li>
<li>Must be few in number to avoid inflating Type 1 error rates</li>
</ul></li>
</ul>
</section>
<section id="post-hoc-comparisons" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="post-hoc-comparisons"><em>Post Hoc</em> Comparisons</h2>
<ul>
<li>Say you start your experiment with no idea of how groups would differ.</li>
<li>So now you’ve got a significant result that says your groups are different from one another!</li>
<li>But <strong>how</strong> are they different?
<ul>
<li>2 groups could be the same and 1 is different,</li>
<li>or all 3 could be different from each other!</li>
</ul></li>
<li>There are several ways to compare groups after an ANOVA</li>
<li>One of the most common ways is by Tukey’s tests
<ul>
<li>Tukey’s honestly significant difference (HSD) test (all pairs)</li>
<li>Scheffé contrasts (all combinations of means)</li>
</ul></li>
<li>The function <code>TukeyHSD()</code> in R</li>
</ul>
</section>
<section id="irises" class="level2">
<h2 class="anchored" data-anchor-id="irises">Irises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>iris_aov <span class="ot">&lt;-</span> <span class="fu">aov</span>(Sepal.Length <span class="sc">~</span> Species, iris)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(iris_aov)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Sepal.Length ~ Species, data = iris)

$Species
                      diff       lwr       upr p adj
versicolor-setosa    0.930 0.6862273 1.1737727     0
virginica-setosa     1.582 1.3382273 1.8257727     0
virginica-versicolor 0.652 0.4082273 0.8957727     0</code></pre>
</div>
</div>
</section>
<section id="irises-1" class="level2">
<h2 class="anchored" data-anchor-id="irises-1">Irises</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week7a_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="irises-2" class="level2">
<h2 class="anchored" data-anchor-id="irises-2">Irises</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Species, <span class="at">y =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>, <span class="at">shape =</span> <span class="dv">20</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Box Plot by Category"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Species"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Sepal Length"</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="biomarker-data" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="biomarker-data">Biomarker Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>biomarker_data <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"biomarkers.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>biomarker_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(marker5 <span class="sc">~</span> diagnosis, biomarker_data)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(biomarker_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: marker5
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
diagnosis   2  34600 17299.8  7.4487 0.0007613 ***
Residuals 197 457536  2322.5                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="biomarker-data-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="biomarker-data-1">Biomarker Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>biomarker_data <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"biomarkers.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>biomarker_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(marker5 <span class="sc">~</span> diagnosis, biomarker_data)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(biomarker_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = marker5 ~ diagnosis, data = biomarker_data)

$diagnosis
                       diff        lwr      upr     p adj
sarcoma1-benign    7.063072 -12.783009 26.90915 0.6783433
sarcoma2-benign   31.775344  12.192171 51.35852 0.0005000
sarcoma2-sarcoma1 24.712272   1.945757 47.47879 0.0297665</code></pre>
</div>
</div>
</section>
<section id="biomarker-data-2" class="level2">
<h2 class="anchored" data-anchor-id="biomarker-data-2">Biomarker Data</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week7a_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="biomarker-data-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="biomarker-data-3">Biomarker Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>biomarker_data <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"biomarkers.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>biomarker_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(marker5 <span class="sc">~</span> diagnosis, biomarker_data)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(marker5 <span class="sc">~</span> diagnosis, biomarker_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = marker5 ~ diagnosis, data = biomarker_data)

Residuals:
     Min       1Q   Median       3Q      Max 
-130.946  -27.899   -0.907   31.973  141.049 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        417.618      4.819  86.656  &lt; 2e-16 ***
diagnosissarcoma1    7.063      8.404   0.840 0.401668    
diagnosissarcoma2   31.775      8.292   3.832 0.000171 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 48.19 on 197 degrees of freedom
Multiple R-squared:  0.0703,    Adjusted R-squared:  0.06087 
F-statistic: 7.449 on 2 and 197 DF,  p-value: 0.0007613</code></pre>
</div>
</div>
</section>
<section id="lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set" class="level2">
<h2 class="anchored" data-anchor-id="lets-practice---using-the-categorical-predictor-variables-in-the-stickleback-data-set">Let’s practice - using the categorical predictor variables in the stickleback data set</h2>
<ul>
<li>Read in the data as before</li>
<li>Pick one categorical predictor variable to include</li>
<li>Make sure that R sees them as type <code>factor</code></li>
<li>Set up the model and evaluate the overall fit</li>
<li>Do a post-hoc means test with Tukey’s HSD</li>
</ul>
</section>
<section id="fitting-the-model" class="level2">
<h2 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>stickle_micro <span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">"Stickle_RNAseq.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>stickle_micro_anova <span class="ot">&lt;-</span> <span class="fu">aov</span>(Gene42 <span class="sc">~</span> Geno.Micro, stickle_micro)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(stickle_micro_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Gene42
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Geno.Micro  3 120764   40255  25.328 1.837e-11 ***
Residuals  76 120789    1589                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="tukeys-posthoc" class="level2">
<h2 class="anchored" data-anchor-id="tukeys-posthoc">Tukey’s posthoc</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(stickle_micro_anova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Gene42 ~ Geno.Micro, data = stickle_micro)

$Geno.Micro
              diff        lwr        upr     p adj
convB-convA   50.5   17.38429  83.615711 0.0008090
monoA-convA  -29.1  -62.21571   4.015711 0.1051497
monoB-convA  -53.9  -87.01571 -20.784289 0.0003145
monoA-convB  -79.6 -112.71571 -46.484289 0.0000001
monoB-convB -104.4 -137.51571 -71.284289 0.0000000
monoB-monoA  -24.8  -57.91571   8.315711 0.2095350</code></pre>
</div>
</div>
</section>
<section id="plot-of-the-different-levels" class="level2">
<h2 class="anchored" data-anchor-id="plot-of-the-different-levels">Plot of the different levels</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week7a_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="planned-a-priori-contrasts" class="level1">
<h1>Planned (<em>a priori</em>) contrasts</h1>
<section id="planned-a-priori-contrasts-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="planned-a-priori-contrasts-1">Planned (<em>a priori</em>) contrasts</h2>
<ul>
<li>A well planned experiment often dictates which comparison of means are of most interest, whereas other comparisons are of no interest.</li>
<li>By restricting the comparisons to just those of interest, researchers can mitigate the multiple testing problem associated with <em>post-hoc</em> tests.</li>
<li>Some statisticians argue that, in fact, planned comparisons allow researchers to avoid adjusting p-values all together because each test is therefore unique.</li>
<li>Contrasts can also allow more complicated tests of the relationships among means.</li>
<li>Coding <em>a priori</em> contrasts in <code>R</code> is quite easy and just depends upon writing the right series of coefficient contrasts.</li>
</ul>
</section>
<section id="planned-a-priori-contrasts-2" class="level2 flexbox vcenter">
<h2 class="flexbox vcenter anchored" data-anchor-id="planned-a-priori-contrasts-2">Planned (a priori) contrasts</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Null Hypothesis</th>
<th style="text-align: center;">Group_1</th>
<th style="text-align: center;">Group_2</th>
<th style="text-align: center;">Group_3</th>
<th style="text-align: center;">Group_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\mu_1 =\mu_2\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\mu_1 =\mu_3\)</span></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(\mu_3 =\mu_4\)</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(\frac{(\mu_1+\mu_2)}{2} = \mu_3\)</span></td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">-1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
</section>
<section id="r-interlude-planned-contrasts" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-planned-contrasts">R INTERLUDE | Planned contrasts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>RNAseq_Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Stickle_RNAseq.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>RNAseq_Data<span class="sc">$</span>Geno.Micro <span class="ot">&lt;-</span> <span class="fu">factor</span>(RNAseq_Data<span class="sc">$</span>Geno.Micro)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>contrast_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(contrast_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"level1_vs_level2"</span>, <span class="st">"level1_vs_level3"</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(contrast_matrix) <span class="ot">&lt;-</span> <span class="fu">levels</span>(RNAseq_Data<span class="sc">$</span>Geno.Micro)</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(RNAseq_Data<span class="sc">$</span>Geno.Micro) <span class="ot">&lt;-</span> contrast_matrix</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>RNA_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Gene10 <span class="sc">~</span> Geno.Micro, <span class="at">data =</span> RNAseq_Data)</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.lm</span>(RNA_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-interlude-planned-contrasts-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-planned-contrasts-1">R INTERLUDE | Planned contrasts</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
aov(formula = Gene10 ~ Geno.Micro, data = RNAseq_Data)

Residuals:
   Min     1Q Median     3Q    Max 
-72.00 -17.62   1.15  16.44  58.00 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 121.037      2.682  45.128  &lt; 2e-16 ***
Geno.Microlevel1_vs_level2   19.317      4.380   4.410 3.35e-05 ***
Geno.Microlevel1_vs_level3    3.217      4.380   0.734    0.465    
Geno.Micro                   -8.126      5.364  -1.515    0.134    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 23.99 on 76 degrees of freedom
Multiple R-squared:  0.3045,    Adjusted R-squared:  0.277 
F-statistic: 11.09 on 3 and 76 DF,  p-value: 4.063e-06</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="fixed-vs.-random-effects-in-anova" class="level1">
<h1>Fixed vs.&nbsp;Random Effects in ANOVA</h1>
<section id="anova-fixed-effects-of-factors" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anova-fixed-effects-of-factors">ANOVA | Fixed effects of factors</h2>
<ul>
<li>Groups are predetermined, of direct interest, repeatable.</li>
<li>For example:
<ul>
<li>medical treatments in a clinical trial</li>
<li>predetermined doses of a toxin</li>
<li>age groups in a population</li>
<li>habitat, season, etc.</li>
</ul></li>
<li>Any conclusions reached in the study about differences among groups can be applied only to the groups included in the study.</li>
<li>The results cannot be generalized to other treatments, habitats, etc. not included in the study.</li>
</ul>
</section>
<section id="anova-random-effects-of-factors" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anova-random-effects-of-factors">ANOVA | Random effects of factors</h2>
<ul>
<li>Measurements that come in groups. A group can be:
<ul>
<li>a family made up of siblings</li>
<li>a subject measured repeatedly</li>
<li>a transect of quadrats in a sampling survey</li>
<li>a block of an experiment done at a given time</li>
</ul></li>
<li>Groups are assumed to be randomly sampled from a population of groups.</li>
<li>Therefore, conclusions reached about groups can be generalized to the population of groups.</li>
<li>With random effects, the variance among groups is the main quantity of interest, not the specific group attributes.</li>
</ul>
</section>
<section id="anova-random-effects-of-factors-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anova-random-effects-of-factors-1">ANOVA | Random effects of factors</h2>
<ul>
<li>Whenever your sampling design is nested</li>
<li>Whenever you divide up plots and apply separate treatments to subplots</li>
<li>Whenever your replicates are grouped spatially or temporally
<ul>
<li>in blocks</li>
<li>in batches</li>
</ul></li>
<li>Whenever you take measurements on related individuals</li>
<li>Whenever you measure subjects or other sampling units repeatedly</li>
</ul>
</section>
<section id="anova-random-effects-of-factors-2" class="level2">
<h2 class="anchored" data-anchor-id="anova-random-effects-of-factors-2">ANOVA | Random effects of factors</h2>
<p><span class="math display">\[ H_0: \sigma^2_\alpha=0\]</span> <span class="math display">\[ H_A: \sigma^2_\alpha \neq 0\]</span></p>
</section>
<section id="anova-caution-about-fixed-vs.-random-effects" class="level2">
<h2 class="anchored" data-anchor-id="anova-caution-about-fixed-vs.-random-effects">ANOVA | Caution about fixed vs.&nbsp;random effects</h2>
<ul>
<li>Using fixed vs.&nbsp;random effects changes the way that statistical tests are performed in ANOVA</li>
<li>Most statistical packages assume that all factors are fixed unless you instruct it otherwise</li>
<li>Designating factors as random takes extra work and probably a read of the manual</li>
<li>In <code>R</code>, <code>lm</code> assumes that all effects are fixed</li>
<li>For random effects, use <code>lme</code> instead (part of the nlme package)</li>
</ul>
</section>
<section id="anova-r-interlude" class="level2">
<h2 class="anchored" data-anchor-id="anova-r-interlude">ANOVA | R interlude</h2>
<ul>
<li>Set up an analysis of the stickleback data but with the factor as a random effect</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>RNAseq_Data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Stickle_RNAseq.tsv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">''</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>RNAseq_Data<span class="sc">$</span>Geno.Micro <span class="ot">&lt;-</span> <span class="fu">factor</span>(RNAseq_Data<span class="sc">$</span>Geno.Micro)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>micro_model_random_effect <span class="ot">&lt;-</span> <span class="fu">lme</span>(<span class="at">fixed =</span> Gene202 <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> Geno.Micro,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">data =</span> stickle_micro)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(micro_model_random_effect)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="anova-r-interlude-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="anova-r-interlude-1">ANOVA | R interlude</h2>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: stickle_micro 
       AIC      BIC    logLik
  1108.535 1115.644 -551.2677

Random effects:
 Formula: ~1 | Geno.Micro
        (Intercept) Residual
StdDev:    272.6901  237.105

Fixed effects:  Gene202 ~ 1 
               Value Std.Error DF  t-value p-value
(Intercept) 257.2125  138.8982 76 1.851806  0.0679

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.69680500 -0.24080838 -0.06883669  0.22398290  3.62528785 

Number of Observations: 80
Number of Groups: 4 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="how-to-present-your-statistical-results" class="level1">
<h1>How to present your statistical results</h1>
<section id="style-of-a-results-section" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="style-of-a-results-section">Style of a results section</h2>
<ul>
<li>Write the text of the <code>Result</code>s section concisely and objectively.</li>
<li>The passive voice will likely dominate here, but use the active voice as much as possible.</li>
<li>Use the past tense.</li>
<li>Avoid repetitive paragraph structures.</li>
<li>Do not interpret the data here.</li>
</ul>
</section>
<section id="function-of-a-results-section" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="function-of-a-results-section">Function of a results section</h2>
<ul>
<li><p>The function is to objectively present your key results, without interpretation, in an orderly and logical sequence using both text and illustrative materials (Tables and Figures).</p></li>
<li><p>The results section always begins with text, reporting the key results and referring to figures and tables as you proceed.</p></li>
<li><p>The text of the Results section should be crafted to follow this sequence and highlight the evidence needed to answer the questions/hypotheses you investigated.</p></li>
<li><p>Important negative results should be reported, too.</p></li>
<li><p>Authors usually write the text of the results section based upon the sequence of Tables and Figures.</p></li>
</ul>
</section>
<section id="summaries-of-the-statistical-analyses" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="summaries-of-the-statistical-analyses">Summaries of the statistical analyses</h2>
<ul>
<li><p>May appear either in the text (usually parenthetically) or in the relevant Tables or Figures (in the legend or as footnotes to the Table or Figure).</p></li>
<li><p>Each Table and Figure must be referenced in the text portion of the results, and you must tell the reader what the key result(s) is that each Table or Figure conveys.</p></li>
<li><p>Tables and Figures are assigned numbers separately and in the sequence that you will refer to them from the text.</p>
<ul>
<li>The first Table you refer to is Table 1, the next Table 2 and so forth.</li>
<li>Similarly, the first Figure is Figure 1, the next Figure 2, etc.</li>
</ul></li>
<li><p>Each Table or Figure must include a brief description of the results being presented and other necessary information in a legend.</p>
<ul>
<li>Table legends go above the Table; tables are read from top to bottom.</li>
<li>Figure legends go below the figure; figures are usually viewed from bottom to top.</li>
</ul></li>
<li><p>When referring to a Figure from the text, “Figure” is abbreviated as Fig.,e.g., (Fig. 1. Table is never abbreviated, e.g., Table 1.</p></li>
</ul>
</section>
<section id="example" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="example">Example</h2>
<ul>
<li>For example, suppose you asked the question, “Is the average height of male students the same as female students in a pool of randomly selected Biology majors?”</li>
<li>You would first collect height data from large random samples of male and female students.</li>
<li>You would then calculate the descriptive statistics for those samples (mean, SD, n, range, etc) and plot these numbers.</li>
<li>Suppose you found that male Biology majors are, on average, 12.5 cm taller than female majors; this is the answer to the question.</li>
<li>Notice that the outcome of a statistical analysis itself is not a key result, but rather an analytical tool that helps us understand what is our key result.</li>
</ul>
</section>
<section id="differences-directionality-and-magnitude" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="differences-directionality-and-magnitude">Differences, directionality, and magnitude</h2>
<ul>
<li><p>Report your results so as to provide as much information as possible to the reader about the nature of differences or relationships.</p></li>
<li><p>For example, if you are testing for differences among groups, and you find a significant difference, it is not sufficient to simply report that “groups A and B were significantly different”. How are they different? How much are they different?</p></li>
<li><p>It is much more informative to say something like, “Group A individuals were 23% larger than those in Group B”, or, “Group B pups gained weight at twice the rate of Group A pups.”</p></li>
<li><p>Report the direction of differences (greater, larger, smaller, etc) and the magnitude of differences (% difference, how many times, etc.) whenever possible.</p></li>
</ul>
</section>
<section id="statistical-results-in-text" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="statistical-results-in-text">Statistical results in text</h2>
<ul>
<li><p>Statistical test summaries (test name, p-value) are usually reported parenthetically in conjunction with the biological results they support. This parenthetical reference should include the statistical test used, the value, degrees of freedom and the level of significance.</p></li>
<li><p>For example, if you found that the mean height of male Biology majors was significantly larger than that of female Biology majors, you might report this result (in blue) and your statistical conclusion (shown in red) as follows:</p>
<ul>
<li>“Males (180.5 ± 5.1 cm; n=34) averaged 12.5 cm taller than females (168 ± 7.6 cm; n=34) in the pool of Biology majors (two-sample t-test, t = 5.78, 33 d.f., p &lt; 0.001).”</li>
</ul></li>
<li><p>If the summary statistics are shown in a figure, the sentence above need not report them specifically, but must include a reference to the figure where they may be seen:</p>
<ul>
<li>“Males averaged 12.5 cm taller than females in the pool of Biology majors (two-sample t-test, t = 5.78, 33 d.f., p &lt; 0.001; Fig. 1).”</li>
</ul></li>
</ul>
</section>
<section id="statistical-results-in-text-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="statistical-results-in-text-1">Statistical results in text</h2>
<ul>
<li>Always enter the appropriate units when reporting data or summary statistics.
<ul>
<li>for an individual value you would write, “the mean length was 10 cm”, or, “the maximum time was 140 min.”</li>
<li>When including a measure of variability, place the unit after the error value, e.g., “…was 10 ± 2.3 m”.</li>
<li>Likewise place the unit after the last in a series of numbers all having the same unit. For example: “lengths of 5, 10, 15, and 20 m”, or “no differences were observed after 2, 4, 6, or 8 min. of incubation”.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="section" class="level1">
<h1></h1>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>