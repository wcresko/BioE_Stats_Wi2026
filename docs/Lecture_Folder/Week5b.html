<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bill Cresko">

<title>Week 5b - Statistics for Bioengineering – BioEngineering Statistics Winter 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-f7fe251563e67c05764dc4775ff48cfc.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">BioEngineering Statistics Winter 2026</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Policies.html"> 
<span class="menu-text">Policies</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Lectures.html"> 
<span class="menu-text">Lectures</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Homework.html"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Software.html"> 
<span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../Resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#linear-models-and-regression" id="toc-linear-models-and-regression" class="nav-link active" data-scroll-target="#linear-models-and-regression">Linear Models and Regression</a>
  <ul class="collapse">
  <li><a href="#a-linear-model-to-relate-two-variables" id="toc-a-linear-model-to-relate-two-variables" class="nav-link" data-scroll-target="#a-linear-model-to-relate-two-variables">A linear model to relate two variables</a></li>
  <li><a href="#bivariate-normality" id="toc-bivariate-normality" class="nav-link" data-scroll-target="#bivariate-normality">Bivariate normality</a></li>
  <li><a href="#what-is-a-linear-model" id="toc-what-is-a-linear-model" class="nav-link" data-scroll-target="#what-is-a-linear-model">What is a linear model?</a></li>
  <li><a href="#many-approaches-are-linear-models" id="toc-many-approaches-are-linear-models" class="nav-link" data-scroll-target="#many-approaches-are-linear-models">Many approaches are linear models</a></li>
  <li><a href="#classes-of-linear-models" id="toc-classes-of-linear-models" class="nav-link" data-scroll-target="#classes-of-linear-models">Classes of linear models</a></li>
  <li><a href="#linear-model-parameters" id="toc-linear-model-parameters" class="nav-link" data-scroll-target="#linear-model-parameters">linear model parameters</a></li>
  <li><a href="#what-is-a-non-linear-model" id="toc-what-is-a-non-linear-model" class="nav-link" data-scroll-target="#what-is-a-non-linear-model">What is a non-linear model?</a></li>
  </ul></li>
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression-1" id="toc-simple-linear-regression-1" class="nav-link" data-scroll-target="#simple-linear-regression-1">Simple Linear Regression</a></li>
  <li><a href="#origin-of-the-term-regression" id="toc-origin-of-the-term-regression" class="nav-link" data-scroll-target="#origin-of-the-term-regression">Origin of the term <code>regression</code>?</a></li>
  </ul></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions?</a>
  <ul class="collapse">
  <li><a href="#residuals" id="toc-residuals" class="nav-link" data-scroll-target="#residuals">Residuals</a></li>
  <li><a href="#residuals-1" id="toc-residuals-1" class="nav-link" data-scroll-target="#residuals-1">Residuals</a></li>
  <li><a href="#hypothesis-tests-in-regression" id="toc-hypothesis-tests-in-regression" class="nav-link" data-scroll-target="#hypothesis-tests-in-regression">Hypothesis tests in regression</a></li>
  <li><a href="#hypothesis-tests-in-regression-1" id="toc-hypothesis-tests-in-regression-1" class="nav-link" data-scroll-target="#hypothesis-tests-in-regression-1">Hypothesis tests in regression</a></li>
  <li><a href="#estimation-with-squared-errors" id="toc-estimation-with-squared-errors" class="nav-link" data-scroll-target="#estimation-with-squared-errors">Estimation with squared errors</a></li>
  <li><a href="#r2-as-a-measure-of-model-fit" id="toc-r2-as-a-measure-of-model-fit" class="nav-link" data-scroll-target="#r2-as-a-measure-of-model-fit"><span class="math inline">\(R^2\)</span> as a measure of model fit</a></li>
  <li><a href="#hypothesis-tests-with-mean-squared-errors" id="toc-hypothesis-tests-with-mean-squared-errors" class="nav-link" data-scroll-target="#hypothesis-tests-with-mean-squared-errors">Hypothesis tests with mean squared errors</a></li>
  <li><a href="#hypothesis-tests-in-linear-regression" id="toc-hypothesis-tests-in-linear-regression" class="nav-link" data-scroll-target="#hypothesis-tests-in-linear-regression">Hypothesis tests in linear regression</a></li>
  <li><a href="#hypothesis-tests-in-linear-regression-1" id="toc-hypothesis-tests-in-linear-regression-1" class="nav-link" data-scroll-target="#hypothesis-tests-in-linear-regression-1">Hypothesis tests in linear regression</a></li>
  </ul></li>
  <li><a href="#r-interlude" id="toc-r-interlude" class="nav-link" data-scroll-target="#r-interlude">R INTERLUDE</a>
  <ul class="collapse">
  <li><a href="#linear-models-in-r" id="toc-linear-models-in-r" class="nav-link" data-scroll-target="#linear-models-in-r">linear models in R</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#making-a-plot-of-the-model-fit" id="toc-making-a-plot-of-the-model-fit" class="nav-link" data-scroll-target="#making-a-plot-of-the-model-fit">Making a plot of the model fit</a></li>
  <li><a href="#same-plot-in-ggplot2" id="toc-same-plot-in-ggplot2" class="nav-link" data-scroll-target="#same-plot-in-ggplot2">Same plot in GGPlot2</a></li>
  <li><a href="#looking-at-the-model-object" id="toc-looking-at-the-model-object" class="nav-link" data-scroll-target="#looking-at-the-model-object">Looking at the model object</a></li>
  <li><a href="#using-your-fitted-model-to-make-predictions" id="toc-using-your-fitted-model-to-make-predictions" class="nav-link" data-scroll-target="#using-your-fitted-model-to-make-predictions">Using your fitted model to make predictions</a></li>
  </ul></li>
  <li><a href="#residual-analysis" id="toc-residual-analysis" class="nav-link" data-scroll-target="#residual-analysis">Residual Analysis</a>
  <ul class="collapse">
  <li><a href="#did-we-meet-our-assumptions" id="toc-did-we-meet-our-assumptions" class="nav-link" data-scroll-target="#did-we-meet-our-assumptions">Did we meet our assumptions?</a></li>
  <li><a href="#handling-violations-of-the-assumptions-of-linear-models" id="toc-handling-violations-of-the-assumptions-of-linear-models" class="nav-link" data-scroll-target="#handling-violations-of-the-assumptions-of-linear-models">Handling violations of the assumptions of linear models</a></li>
  <li><a href="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these" id="toc-anscombes-quartet-again-what-would-residual-plots-look-like-for-these" class="nav-link" data-scroll-target="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these">Anscombe’s quartet again | what would residual plots look like for these?</a></li>
  <li><a href="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1" id="toc-anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1" class="nav-link" data-scroll-target="#anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1">Anscombe’s quartet again | what would residual plots look like for these?</a></li>
  <li><a href="#residual-plots-spotting-assumption-violations" id="toc-residual-plots-spotting-assumption-violations" class="nav-link" data-scroll-target="#residual-plots-spotting-assumption-violations">Residual Plots | Spotting assumption violations</a></li>
  <li><a href="#residuals-leverage-and-influence" id="toc-residuals-leverage-and-influence" class="nav-link" data-scroll-target="#residuals-leverage-and-influence">Residuals | leverage and influence</a></li>
  <li><a href="#residuals-leverage-and-influence-1" id="toc-residuals-leverage-and-influence-1" class="nav-link" data-scroll-target="#residuals-leverage-and-influence-1">Residuals | leverage and influence</a></li>
  <li><a href="#r-interlude-residual-analyses" id="toc-r-interlude-residual-analyses" class="nav-link" data-scroll-target="#r-interlude-residual-analyses">R INTERLUDE | residual analyses</a></li>
  <li><a href="#residuals-vs.-original-x-variable" id="toc-residuals-vs.-original-x-variable" class="nav-link" data-scroll-target="#residuals-vs.-original-x-variable">residuals vs.&nbsp;original x variable</a></li>
  <li><a href="#residuals-vs.-predicted-fitted-values" id="toc-residuals-vs.-predicted-fitted-values" class="nav-link" data-scroll-target="#residuals-vs.-predicted-fitted-values">residuals vs.&nbsp;predicted (fitted) values</a></li>
  <li><a href="#residual-analyses" id="toc-residual-analyses" class="nav-link" data-scroll-target="#residual-analyses">Residual analyses</a></li>
  <li><a href="#or-you-can-use-this-nifty-little-package" id="toc-or-you-can-use-this-nifty-little-package" class="nav-link" data-scroll-target="#or-you-can-use-this-nifty-little-package">Or you can use this nifty little package</a></li>
  <li><a href="#influence-measures" id="toc-influence-measures" class="nav-link" data-scroll-target="#influence-measures">Influence measures</a></li>
  </ul></li>
  <li><a href="#the-eugenics-history-of-statistics" id="toc-the-eugenics-history-of-statistics" class="nav-link" data-scroll-target="#the-eugenics-history-of-statistics">The Eugenics History of Statistics</a>
  <ul class="collapse">
  <li><a href="#galton-as-the-father-of-eugenics" id="toc-galton-as-the-father-of-eugenics" class="nav-link" data-scroll-target="#galton-as-the-father-of-eugenics">Galton as the Father of Eugenics</a></li>
  <li><a href="#galton-as-the-father-of-eugenics-1" id="toc-galton-as-the-father-of-eugenics-1" class="nav-link" data-scroll-target="#galton-as-the-father-of-eugenics-1">Galton as the Father of Eugenics</a></li>
  <li><a href="#a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" id="toc-a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" class="nav-link" data-scroll-target="#a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s">A common sight at state fairs around the U.S. in the 1930s</a></li>
  <li><a href="#galton-charles-davenport-g.-stanley-hall" id="toc-galton-charles-davenport-g.-stanley-hall" class="nav-link" data-scroll-target="#galton-charles-davenport-g.-stanley-hall">Galton, Charles Davenport &amp; G. Stanley Hall</a></li>
  <li><a href="#logo-of-the-us-eugenics-society" id="toc-logo-of-the-us-eugenics-society" class="nav-link" data-scroll-target="#logo-of-the-us-eugenics-society">Logo of the US eugenics society</a></li>
  <li><a href="#eugenics-societies-in-america" id="toc-eugenics-societies-in-america" class="nav-link" data-scroll-target="#eugenics-societies-in-america">Eugenics societies in America</a></li>
  <li><a href="#ra-fisher-and-eugenics-in-london" id="toc-ra-fisher-and-eugenics-in-london" class="nav-link" data-scroll-target="#ra-fisher-and-eugenics-in-london">RA Fisher and Eugenics in London</a></li>
  <li><a href="#ra-fisher-and-eugenics" id="toc-ra-fisher-and-eugenics" class="nav-link" data-scroll-target="#ra-fisher-and-eugenics">RA Fisher and Eugenics</a></li>
  <li><a href="#a-direct-line-to-hitler-and-nazism" id="toc-a-direct-line-to-hitler-and-nazism" class="nav-link" data-scroll-target="#a-direct-line-to-hitler-and-nazism">A direct line to Hitler and Nazism</a></li>
  <li><a href="#sterilizations-continue-in-america" id="toc-sterilizations-continue-in-america" class="nav-link" data-scroll-target="#sterilizations-continue-in-america">Sterilizations continue in America</a></li>
  <li><a href="#so-what-do-we-do-from-here" id="toc-so-what-do-we-do-from-here" class="nav-link" data-scroll-target="#so-what-do-we-do-from-here">So, what do we do from here?</a></li>
  <li><a href="#interested-in-learning-more" id="toc-interested-in-learning-more" class="nav-link" data-scroll-target="#interested-in-learning-more">Interested in learning more?</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="Week5b.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 5b - Statistics for Bioengineering</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bill Cresko </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.4.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.2
✔ purrr     1.2.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gt' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="linear-models-and-regression" class="level1">
<h1>Linear Models and Regression</h1>
<section id="a-linear-model-to-relate-two-variables" class="level2">
<h2 class="anchored" data-anchor-id="a-linear-model-to-relate-two-variables">A linear model to relate two variables</h2>
<p><span class="math display">\[ y_i = \beta_0 + \beta_1 x_1 + \epsilon_i \]</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.008.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bivariate-normality" class="level2">
<h2 class="anchored" data-anchor-id="bivariate-normality">Bivariate normality</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-is-a-linear-model" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-a-linear-model">What is a linear model?</h2>
<p>All an be written in the form</p>
<p><code>response_var = intercept + parameter*(explanatory_var) + error</code></p>
<p><br>
<br>
</p>
<p><span class="math display">\[ y_i = \beta_0 + \beta_1 x_1 + \epsilon_i \]</span></p>
<p><span class="math display">\[ y_i = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + ... + \beta_n x_n + \epsilon_i \]</span></p>
<p><span class="math display">\[ y_i = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_1x_2 + \epsilon_i \]</span></p>
<ul>
<li>Functions in
<ul>
<li><code>lm()</code></li>
<li><code>aov()</code></li>
<li><code>glm()</code></li>
</ul></li>
</ul>
</section>
<section id="many-approaches-are-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="many-approaches-are-linear-models">Many approaches are linear models</h2>
<ul>
<li>Linear regression</li>
<li>Single factor ANOVA</li>
<li>Analysis of covariance</li>
<li>Multiple regression</li>
<li>Multi-factor ANOVA</li>
<li>Repeated-measures ANOVA</li>
</ul>
</section>
<section id="classes-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="classes-of-linear-models">Classes of linear models</h2>
<ul>
<li><p>General Linear Model (<strong>GLM</strong>) - two or more continuous variables</p></li>
<li><p>General Linear Mixed Model (<strong>GLMM</strong>) - a continuous response variable with a mix of continuous and categorical predictor variables</p></li>
<li><p><em>Generalized Linear Model</em> - a GLMM that doesn’t assume normality of the response (we’ll get to this later)</p></li>
</ul>
</section>
<section id="linear-model-parameters" class="level2">
<h2 class="anchored" data-anchor-id="linear-model-parameters">linear model parameters</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.009.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="what-is-a-non-linear-model" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="what-is-a-non-linear-model">What is a non-linear model?</h2>
<ul>
<li><p><strong><em>parametric non-linear model</em></strong>: assumes that the relationship between the dependent and independent variables can be modeled using a specfic mathematical function</p>
<ul>
<li><strong>Logistic regression</strong> <span class="math inline">\(log(\frac{\pi_i}{1-\pi_1})=\beta_0 + \beta_1 x_1 + \beta_2 x_2 +...+ \beta_n x_n +\epsilon\)</span></li>
<li><strong>Polynomial regression</strong> <span class="math inline">\(y = \beta_0 + \beta_1 x + \beta_2 x^2 +...+ \beta_n x^n +\epsilon\)</span></li>
<li><strong>Exponential regression</strong> <span class="math inline">\(y = \alpha^{\beta x} + \epsilon\)</span></li>
<li><strong>Poisson regression</strong> <span class="math inline">\(log(y) = \beta_0 + \beta_1 x + \epsilon\)</span></li>
<li><strong>Power regression</strong> <span class="math inline">\(y = \alpha x^\beta + \epsilon\)</span></li>
</ul></li>
<li><p><strong><em>non-parameteric non-linear regression</em></strong>: doesn’t make this assumption, but instead uses machine learning algorhithms to larn the relationship</p>
<ul>
<li>Kernel smoothing</li>
<li>Local polynomial regression</li>
<li>Nearest neighbor regression</li>
</ul></li>
</ul>
</section>
</section>
<section id="simple-linear-regression" class="level1">
<h1>Simple Linear Regression</h1>
<section id="simple-linear-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression-1">Simple Linear Regression</h2>
<p><span class="math display">\[ y_i = B_0 + B_1 x_1 + e_i \]</span></p>
<ul>
<li><p>Relate two continuous variables to one another</p></li>
<li><p>Often use ordinary least squares (OLS) to fit a model</p></li>
<li><p>The estimates (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>) are measured with normally distributed error</p></li>
<li><p>Parametric regression involves assumptions about the data</p>
<ul>
<li><p>need to do a ‘residual analysis’ to check assumptions</p></li>
<li><p>there are ways to perform robust non-parametric linear regression</p></li>
</ul></li>
</ul>
</section>
<section id="origin-of-the-term-regression" class="level2">
<h2 class="anchored" data-anchor-id="origin-of-the-term-regression">Origin of the term <code>regression</code>?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.002.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:150.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="assumptions" class="level1">
<h1>Assumptions?</h1>
<ul>
<li>Independent errors (residuals)</li>
<li>Equal variance of residuals in all groups</li>
<li>Normally-distributed residuals</li>
<li>Robustness to departures from these assumptions is improved when sample size is large and design is balanced</li>
</ul>
<section id="residuals" class="level2">
<h2 class="anchored" data-anchor-id="residuals">Residuals</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-1" class="level2">
<h2 class="anchored" data-anchor-id="residuals-1">Residuals</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hypothesis-tests-in-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypothesis-tests-in-regression">Hypothesis tests in regression</h2>
<p><span class="math display">\[H_0 : \beta_0 = 0\]</span> <span class="math display">\[H_A : \beta_1 \neq 0\]</span></p>
<p>reduced model (<span class="math inline">\(H_0\)</span>) -</p>
<p><span class="math display">\[y_i = \beta_0 + 0x_i + \epsilon_i\]</span></p>
<p>full model (<span class="math inline">\(H_A\)</span>) -</p>
<p><span class="math display">\[y_i = \beta_0 + \beta_1x_i + \epsilon_i\]</span><br>
<br>
</p>
<ol type="1">
<li>fits a “reduced” model without slope term (H0)</li>
<li>fits the “full” model with slope term added back</li>
<li>compares fit of full and reduced models using an <strong><em>F test statistic</em></strong></li>
<li>compares the residual variance of the full vs.&nbsp;reduced models</li>
</ol>
</section>
<section id="hypothesis-tests-in-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-tests-in-regression-1">Hypothesis tests in regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimation-with-squared-errors" class="level2">
<h2 class="anchored" data-anchor-id="estimation-with-squared-errors">Estimation with squared errors</h2>
<ul>
<li><p>Sum of Squares (<span class="math inline">\(SS\)</span>) is the sum of the squared difference</p></li>
<li><p>Sum of Squares Total (<span class="math inline">\(SS_{total}\)</span> or <span class="math inline">\(SST\)</span>) is</p>
<ul>
<li>the total variability in the data</li>
<li>variance in Y in simple linear regression</li>
</ul></li>
<li><p>Sum of Squares Model (<span class="math inline">\(SS_{model}\)</span> or <span class="math inline">\(SSM\)</span>) is the variability explained by the model</p></li>
<li><p>Sum of Squares Error (<span class="math inline">\(SS_{error}\)</span> or <span class="math inline">\(SSE\)</span>) is the unexplained variability once the model is fit</p></li>
</ul>
<p><span class="math display">\[SST = SSR + SSE\]</span></p>
</section>
<section id="r2-as-a-measure-of-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="r2-as-a-measure-of-model-fit"><span class="math inline">\(R^2\)</span> as a measure of model fit</h2>
<p><span class="math display">\[R^2 = 1 - \frac{SSE}{SST}\]</span> or</p>
<p><span class="math display">\[R^2 = \frac{SSR}{SST}\]</span></p>
<p><span class="math inline">\(R^2\)</span> is the proportion of the variance in Y that is explained by X</p>
</section>
<section id="hypothesis-tests-with-mean-squared-errors" class="level2">
<h2 class="anchored" data-anchor-id="hypothesis-tests-with-mean-squared-errors">Hypothesis tests with mean squared errors</h2>
<ul>
<li><p>Mean square (<span class="math inline">\(MS\)</span>) = divide the sum of squares by the degrees of freedom</p></li>
<li><p><span class="math inline">\(MS\)</span> standardizes by the number of data points</p></li>
<li><p><span class="math inline">\(MST\)</span>, <span class="math inline">\(MSM\)</span> and <span class="math inline">\(MSE\)</span> are the mean squares total, model and error respectively</p></li>
<li><p>What are the degrees of freedom for simple linear regression</p>
<ul>
<li>numerator degrees of freedom: 1 (#variables - 1)</li>
<li>denominator degrees of freedom: n-2 (#observations - 2)</li>
</ul></li>
</ul>
</section>
<section id="hypothesis-tests-in-linear-regression" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypothesis-tests-in-linear-regression">Hypothesis tests in linear regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="hypothesis-tests-in-linear-regression-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="hypothesis-tests-in-linear-regression-1">Hypothesis tests in linear regression</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.012.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="r-interlude" class="level1 smaller">
<h1 class="smaller">R INTERLUDE</h1>
<section id="linear-models-in-r" class="level2">
<h2 class="anchored" data-anchor-id="linear-models-in-r">linear models in R</h2>
<ul>
<li>In general we need to fit the model and then ‘read’ the output</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>my_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dataset<span class="sc">$</span>variable1 <span class="sc">~</span> dataset<span class="sc">$</span>variable2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Now write a script to read in the zebrafish data set.</li>
<li>Now, add the code to perform a linear model of two continuous variables (length and weight).</li>
<li>Notice how the output of the linear model is specified to a new variable.</li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>Zebrafish_data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"Drerio_development_complete.csv"</span>, <span class="at">header=</span>T, <span class="at">sep=</span><span class="st">","</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Zebrafish_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X.1 X Sample Condition    Sex Age_Days Pigmentation Group Weight_mg Length_cm
1   1 1      1   Control Female        1           33     A  4.318525 0.9211093
2   2 2      2   Control   Male        2           77     A  8.331734 1.8337986
3   3 3      3   Control Female        3           15     A 15.795725 4.1445988
4   4 4      4   Control   Male        4           39     A 16.351995 4.9857301
5   5 5      5   Control Female        5           13     A 23.402953 6.5326226
6   6 6      6   Control   Male        1           52     A  5.412950 0.9363841</code></pre>
</div>
</div>
</section>
<section id="section-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="section-1"></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> Zebrafish_data<span class="sc">$</span>Length_cm</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> Zebrafish_data<span class="sc">$</span>Weight_mg</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>zfish_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span> (zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.1164 -1.1004  0.0976  0.9950  4.5447 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.42136    0.12820   18.89   &lt;2e-16 ***
x            3.06303    0.03775   81.13   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.48 on 598 degrees of freedom
Multiple R-squared:  0.9167,    Adjusted R-squared:  0.9166 
F-statistic:  6582 on 1 and 598 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="making-a-plot-of-the-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="making-a-plot-of-the-model-fit">Making a plot of the model fit</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y <span class="sc">~</span> x, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(zfish_lm, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="same-plot-in-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="same-plot-in-ggplot2">Same plot in GGPlot2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(zfish_lm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span>                  </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Linear regression of zebrafish weight on standard length"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"zebrafish length in cm"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"zebrafish weight in gm"</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `fortify(&lt;lm&gt;)` was deprecated in ggplot2 4.0.0.
ℹ Please use `broom::augment(&lt;lm&gt;)` instead.
ℹ The deprecated feature was likely used in the ggplot2 package.
  Please report the issue at &lt;https://github.com/tidyverse/ggplot2/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="looking-at-the-model-object" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="looking-at-the-model-object">Looking at the model object</h2>
<section id="names-of-variables-in-the-model-object" class="level4">
<h4 class="anchored" data-anchor-id="names-of-variables-in-the-model-object">Names of variables in the model object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
</div>
<p><br>
</p>
</section>
<section id="pulling-out-estimates-and-confidence-intervals" class="level4">
<h4 class="anchored" data-anchor-id="pulling-out-estimates-and-confidence-intervals">Pulling out estimates and confidence intervals</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
   2.421359    3.063034 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               2.5 %   97.5 %
(Intercept) 2.169579 2.673139
x           2.988886 3.137182</code></pre>
</div>
</div>
<p><br>
</p>
</section>
<section id="formatting-the-output-in-a-nice-table" class="level4">
<h4 class="anchored" data-anchor-id="formatting-the-output-in-a-nice-table">Formatting the output in a nice table</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gtsummary' was built under R version 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="wwtfpixixg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wwtfpixixg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wwtfpixixg thead, #wwtfpixixg tbody, #wwtfpixixg tfoot, #wwtfpixixg tr, #wwtfpixixg td, #wwtfpixixg th {
  border-style: none;
}

#wwtfpixixg p {
  margin: 0;
  padding: 0;
}

#wwtfpixixg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wwtfpixixg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wwtfpixixg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wwtfpixixg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wwtfpixixg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wwtfpixixg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwtfpixixg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wwtfpixixg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wwtfpixixg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wwtfpixixg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wwtfpixixg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wwtfpixixg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wwtfpixixg .gt_spanner_row {
  border-bottom-style: hidden;
}

#wwtfpixixg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wwtfpixixg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wwtfpixixg .gt_from_md > :first-child {
  margin-top: 0;
}

#wwtfpixixg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wwtfpixixg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wwtfpixixg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtfpixixg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wwtfpixixg .gt_row_group_first td {
  border-top-width: 2px;
}

#wwtfpixixg .gt_row_group_first th {
  border-top-width: 2px;
}

#wwtfpixixg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtfpixixg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wwtfpixixg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wwtfpixixg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwtfpixixg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtfpixixg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wwtfpixixg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wwtfpixixg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wwtfpixixg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wwtfpixixg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wwtfpixixg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtfpixixg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wwtfpixixg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wwtfpixixg .gt_left {
  text-align: left;
}

#wwtfpixixg .gt_center {
  text-align: center;
}

#wwtfpixixg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wwtfpixixg .gt_font_normal {
  font-weight: normal;
}

#wwtfpixixg .gt_font_bold {
  font-weight: bold;
}

#wwtfpixixg .gt_font_italic {
  font-style: italic;
}

#wwtfpixixg .gt_super {
  font-size: 65%;
}

#wwtfpixixg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wwtfpixixg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wwtfpixixg .gt_indent_1 {
  text-indent: 5px;
}

#wwtfpixixg .gt_indent_2 {
  text-indent: 10px;
}

#wwtfpixixg .gt_indent_3 {
  text-indent: 15px;
}

#wwtfpixixg .gt_indent_4 {
  text-indent: 20px;
}

#wwtfpixixg .gt_indent_5 {
  text-indent: 25px;
}

#wwtfpixixg .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wwtfpixixg div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">x</td>
<td class="gt_row gt_center" headers="estimate">3.1</td>
<td class="gt_row gt_center" headers="conf.low">3.0, 3.1</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot>
<tr class="gt_sourcenotes odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
</section>
<section id="using-your-fitted-model-to-make-predictions" class="level2">
<h2 class="anchored" data-anchor-id="using-your-fitted-model-to-make-predictions">Using your fitted model to make predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(zfish_lm, <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span>, <span class="dv">1</span>)), <span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 3.033966 2.795162 3.272770
2 3.646573 3.420517 3.872629
3 4.871786 4.670369 5.073203
4 5.484393 5.294756 5.674030</code></pre>
</div>
</div>
</section>
</section>
<section id="residual-analysis" class="level1">
<h1>Residual Analysis</h1>
<section id="did-we-meet-our-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="did-we-meet-our-assumptions">Did we meet our assumptions?</h2>
<ul>
<li>Independent errors (residuals)</li>
<li>Equal variance of residuals in all groups</li>
<li>Normally-distributed residuals</li>
</ul>
</section>
<section id="handling-violations-of-the-assumptions-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="handling-violations-of-the-assumptions-of-linear-models">Handling violations of the assumptions of linear models</h2>
<ul>
<li><p>What if your residuals aren’t normal because of outliers?</p></li>
<li><p>Nonparametric methods exist, but these don’t provide parameter estimates with CIs.</p></li>
<li><p>Robust regression (rlm)</p></li>
<li><p>Randomization tests</p></li>
</ul>
</section>
<section id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these" class="level2">
<h2 class="anchored" data-anchor-id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these">Anscombe’s quartet again | what would residual plots look like for these?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1" class="level2">
<h2 class="anchored" data-anchor-id="anscombes-quartet-again-what-would-residual-plots-look-like-for-these-1">Anscombe’s quartet again | what would residual plots look like for these?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.018.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-plots-spotting-assumption-violations" class="level2">
<h2 class="anchored" data-anchor-id="residual-plots-spotting-assumption-violations">Residual Plots | Spotting assumption violations</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.020.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-leverage-and-influence" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="residuals-leverage-and-influence">Residuals | leverage and influence</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/images_4b.021.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>1 is an outlier for both Y and X</li>
<li>2 is not an outlier for either Y or X but has a high residual</li>
<li>3 is an outlier in just X - and thus a high residual - and therefore has high influence as measured by Cook’s D</li>
</ul>
</section>
<section id="residuals-leverage-and-influence-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="residuals-leverage-and-influence-1">Residuals | leverage and influence</h2>
<ul>
<li><p><strong>Leverage</strong> - a measure of how much of an outlier each point is in x-space (on x-axis) and thus only applies to the predictor variable. (Values &gt; 2*(2/n) for simple regression are cause for concern)</p></li>
<li><p><strong>Residuals</strong> - As the residuals are the differences between the observed and predicted values along a vertical plane, they provide a measure of how much of an outlier each point is in y-space (on y-axis). The patterns of residuals against predicted y values (residual plot) are also useful diagnostic tools for investigating linearity and homogeneity of variance assumptions</p></li>
<li><p><strong>Cook’s D</strong> statistic is a measure of the influence of each point on the fitted model (estimated slope) and incorporates both leverage and residuals. Values ≥ 1 (or even approaching 1) correspond to highly influential observations.</p></li>
</ul>
</section>
<section id="r-interlude-residual-analyses" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="r-interlude-residual-analyses">R INTERLUDE | residual analyses</h2>
<p>Let’s look at the residuals in the zebrafish data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(zfish_lm), <span class="at">breaks=</span><span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-vs.-original-x-variable" class="level2">
<h2 class="anchored" data-anchor-id="residuals-vs.-original-x-variable">residuals vs.&nbsp;original x variable</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (<span class="fu">residuals</span>(zfish_lm) <span class="sc">~</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-vs.-predicted-fitted-values" class="level2">
<h2 class="anchored" data-anchor-id="residuals-vs.-predicted-fitted-values">residuals vs.&nbsp;predicted (fitted) values</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span> (<span class="fu">residuals</span>(zfish_lm) <span class="sc">~</span> <span class="fu">fitted.values</span>(zfish_lm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residual-analyses" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="residual-analyses">Residual analyses</h2>
<p>Or apply the plot() function to the linear model object directly</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-27-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Figure out what these plots are telling you</p>
</section>
<section id="or-you-can-use-this-nifty-little-package" class="level2">
<h2 class="anchored" data-anchor-id="or-you-can-use-this-nifty-little-package">Or you can use this nifty little package</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggfortify)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(zfish_lm, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">label.size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
ℹ Please use tidy evaluation idioms with `aes()`.
ℹ See also `vignette("ggplot2-in-packages")` for more information.
ℹ The deprecated feature was likely used in the ggfortify package.
  Please report the issue at &lt;https://github.com/sinhrks/ggfortify/issues&gt;.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.
ℹ The deprecated feature was likely used in the ggfortify package.
  Please report the issue at &lt;https://github.com/sinhrks/ggfortify/issues&gt;.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Week5b_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="influence-measures" class="level2">
<h2 class="anchored" data-anchor-id="influence-measures">Influence measures</h2>
<ul>
<li>How about using the influence.measures function???</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influence.measures</span>(zfish_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Do we have any high leverage observations we need to worry about???</li>
</ul>
<hr>
</section>
</section>
<section id="the-eugenics-history-of-statistics" class="level1">
<h1>The Eugenics History of Statistics</h1>
<section id="galton-as-the-father-of-eugenics" class="level2">
<h2 class="anchored" data-anchor-id="galton-as-the-father-of-eugenics">Galton as the Father of Eugenics</h2>
<p><img src="images/week6_Galton.jpeg" class="img-fluid" data-fig.align="center"></p>
<ul>
<li>Francis Galton: Darwin’s half cousin</li>
<li>Studied human variation and genetic inheritance
<ul>
<li>Human height, fingerprints, intelligence</li>
<li>Correlation, regression toward the mean, and “nature versus nurture”</li>
<li>Pioneered twin studies</li>
</ul></li>
</ul>
</section>
<section id="galton-as-the-father-of-eugenics-1" class="level2">
<h2 class="anchored" data-anchor-id="galton-as-the-father-of-eugenics-1">Galton as the Father of Eugenics</h2>
<ul>
<li>Believed that intelligence was hereditary based on surveying prominent academics in Europe</li>
<li>Used the ideas of <strong>correlation</strong> and <strong>regression towards the mean</strong> to argue that the upper class should breed amongst themselves to keep those “good genes” pure</li>
<li>Wanted to provide monetary incentives for “good” couples to marry and reproduce as a way to avoid the upper class being genetically muddied by the lower class</li>
</ul>
</section>
<section id="a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s" class="level2">
<h2 class="anchored" data-anchor-id="a-common-sight-at-state-fairs-around-the-u.s.-in-the-1930s">A common sight at state fairs around the U.S. in the 1930s</h2>
<ul>
<li>Competitions for the “perfect family” to encourage public consciousness and support for eugenics</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.013.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="galton-charles-davenport-g.-stanley-hall" class="level2">
<h2 class="anchored" data-anchor-id="galton-charles-davenport-g.-stanley-hall">Galton, Charles Davenport &amp; G. Stanley Hall</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.014.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logo-of-the-us-eugenics-society" class="level2">
<h2 class="anchored" data-anchor-id="logo-of-the-us-eugenics-society">Logo of the US eugenics society</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>American Eugenics Record Office (ERO) founded in Cold Springs Harbor</li>
</ul>
</section>
<section id="eugenics-societies-in-america" class="level2">
<h2 class="anchored" data-anchor-id="eugenics-societies-in-america">Eugenics societies in America</h2>
<ul>
<li>Advocated for state laws to ban interracial marriages and promote sterilization of “unfit” individuals (negative eugenics) - especially black, Latinx, and Native American women</li>
<li>30 states passed laws to force mental institution patients to be sterilized</li>
<li>Between 1907 and 1963, over 64,000 individuals were forcibly sterilized under eugenic legislation in the United States</li>
</ul>
</section>
<section id="ra-fisher-and-eugenics-in-london" class="level2">
<h2 class="anchored" data-anchor-id="ra-fisher-and-eugenics-in-london">RA Fisher and Eugenics in London</h2>
<ul>
<li>Developer of Fishers exact test, analysis of variance (ANOVA), null hypothesis, p values, maximum likelihood, probability density functions</li>
<li>Founding Chairman of the University of Cambridge Eugenics Society</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/week6_fisher.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ra-fisher-and-eugenics" class="level2">
<h2 class="anchored" data-anchor-id="ra-fisher-and-eugenics">RA Fisher and Eugenics</h2>
<ul>
<li>1/3rd of his work “The Genetical Theory of Natural Selection” discussed eugenics and his theory that the fall of civilizations was due to the fertility of their upper classes being diminished</li>
<li>Used these statistical methods to test data on human variation to prove biological differences between human races</li>
<li>Eugenics and racism were the primary motivators for many of these statistical tests that we use today</li>
</ul>
</section>
<section id="a-direct-line-to-hitler-and-nazism" class="level2">
<h2 class="anchored" data-anchor-id="a-direct-line-to-hitler-and-nazism">A direct line to Hitler and Nazism</h2>
<ul>
<li>Eugenics existed in America (and England) before it became popular in Germany.</li>
<li>By 1933, California had subjected more people to forceful sterilization than all other U.S. states combined.</li>
<li>The forced sterilization program engineered by the Nazis was partly inspired by California’s.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.016.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sterilizations-continue-in-america" class="level2">
<h2 class="anchored" data-anchor-id="sterilizations-continue-in-america">Sterilizations continue in America</h2>
<ul>
<li>Our history books paint Nazi Germany as the primary evil of that time, while we try to cover up our significant role in eugenics</li>
<li>It wasn’t until 1978 that the US passed regulations on sterilization procedures</li>
<li>California only passed a bill to outlaw sterilization of inmates in 2014</li>
<li>Certain members of the genetic engineering community threaten to bring back eugenics ideas</li>
<li>Our current President repeats eugenics talking points</li>
</ul>
</section>
<section id="so-what-do-we-do-from-here" class="level2">
<h2 class="anchored" data-anchor-id="so-what-do-we-do-from-here">So, what do we do from here?</h2>
<ul>
<li>The statistical methods that Galton, Fisher, and others developed are useful science tools</li>
<li>Important to use these tools for good - improving our planet, human health, and technology</li>
<li>Important to acknowledge and not forget the history of science - educate others to avoid repeating history</li>
</ul>
</section>
<section id="interested-in-learning-more" class="level2">
<h2 class="anchored" data-anchor-id="interested-in-learning-more">Interested in learning more?</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/IMAGES2.017.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:20.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>See also
<ul>
<li>“The Gene” by Siddhartha Mukherjee</li>
<li>“Control” by Adam Rutherford</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>